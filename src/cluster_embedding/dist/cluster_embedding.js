function t(t,e){const r=function(t,e){let r,n=0,i=0,o=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(r=e-i,i+=r/++n,o+=r*(e-i));else{let u=-1;for(let a of t)null!=(a=e(a,++u,t))&&(a=+a)>=a&&(r=a-i,i+=r/++n,o+=r*(a-i))}if(n>1)return o/(n-1)}(t,e);return r?Math.sqrt(r):r}function e(t,e){let r,n;if(void 0===e)for(const e of t)null!=e&&(void 0===r?e>=e&&(r=n=e):(r>e&&(r=e),n<e&&(n=e)));else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(void 0===r?o>=o&&(r=n=o):(r>o&&(r=o),n<o&&(n=o)))}return[r,n]}class r extends Map{constructor(t,e=i){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,r]of t)this.set(e,r)}get(t){return super.get(n(this,t))}has(t){return super.has(n(this,t))}set(t,e){return super.set(function({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}(this,t),e)}delete(t){return super.delete(function({_intern:t,_key:e},r){const n=e(r);t.has(n)&&(r=t.get(n),t.delete(n));return r}(this,t))}}function n({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function i(t){return null!==t&&"object"==typeof t?t.valueOf():t}function o(t){return t}function u(t,...e){return function(t,e,n,i){return function t(o,u){if(u>=i.length)return n(o);const a=new r,s=i[u++];let f=-1;for(const t of o){const e=s(t,++f,o),r=a.get(e);r?r.push(t):a.set(e,[t])}for(const[e,r]of a)a.set(e,t(r,u));return e(a)}(t,0)}(t,Array.from,o,e)}function a(t,e){let r=0,n=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(++r,n+=e);else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(o=+o)>=o&&(++r,n+=o)}if(r)return n/r}var s=function(t){return function(e,r=0,n=e.length){let i=n-(r=+r);for(;i;){const n=t()*i--|0,o=e[i+r];e[i+r]=e[n+r],e[n+r]=o}return e}}(Math.random);var f=function t(e){function r(t,r){var n,i;return t=null==t?0:+t,r=null==r?1:+r,function(){var o;if(null!=n)o=n,n=null;else do{n=2*e()-1,o=2*e()-1,i=n*n+o*o}while(!i||i>1);return t+r*o*Math.sqrt(-2*Math.log(i)/i)}}return r.source=t,r}(Math.random);const h={mean:a,deviation:t,flatGroup:function(t,...e){return function(t,e){for(let r=1,n=e.length;r<n;++r)t=t.flatMap((t=>t.pop().map((([e,r])=>[...t,e,r]))));return t}(u(t,...e),e)}};function c(t,e){return t.map(((t,r)=>t+e[r]))}function l(t,e){return t.map(((t,r)=>t-e[r]))}function p(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])**2;return Math.sqrt(r)}function m(t,e){const r=h.flatGroup(t,((t,r)=>e[r])),n=[];for(const[t,e]of r){let r=[];for(let t=0;t<e[0].length;t++){const n=h.mean(e,(e=>e[t]));r[t]=null!=n?n:NaN}n[t]=r}return n}class d{shape;k;initialLr;lr;sigma;maxIter;distanceFunction;locations;dim=-1;weights;constructor(t,e={}){this.shape=t,this.k=this.shape[0]*this.shape[1];const r={lr:1,sigma:1,maxIter:3e3,...e};this.initialLr=r.lr,this.lr=r.lr,this.sigma=r.sigma,this.maxIter=r.maxIter,null!=e.distanceFunction?this.distanceFunction=e.distanceFunction:this.distanceFunction=p,this.locations=function(t,e){const r=[];for(let n=0;n<t;n++)for(let t=0;t<e;t++)r.push([n,t]);return r}(this.shape[0],this.shape[1])}fit(t,e=1,r=!0){const n=t.length;this.dim=t[0].length;for(const e of t)if(e.length!=this.dim)throw new Error("Vectors must be of equal length");this.#t(t);let i=0;const o=Math.min(e*n,this.maxIter);for(let u=0;u<e&&!(i>this.maxIter);u++){let e=Array.from({length:n},((t,e)=>e));r&&s(e);for(const r of e){if(i>this.maxIter)break;const e=t[r];this.#e(e),i++,this.lr=(1-i/o)*this.initialLr}}}getResult(){return{locations:this.locations,weights:this.weights}}#e(t){const e=this.#r(t),r=this.locations[e],n=this.locations.map((t=>function(t,e){let r=0;if(void 0===e)for(let e of t)(e=+e)&&(r+=e);else{let n=-1;for(let i of t)(i=+e(i,++n,t))&&(r+=i)}return r}(l(t,r).map((t=>t**2))))),i=n.map((t=>Math.exp(t/this.sigma**2/-1))).map((t=>t*this.lr)),o=this.weights.map(((e,r)=>l(t,e).map((t=>t*i[r]))));for(let t=0;t<this.weights.length;t++)this.weights[t]=c(this.weights[t],o[t])}#r(t){return function(t,e){let r,n=-1,i=-1;if(void 0===e)for(const e of t)++i,null!=e&&(r>e||void 0===r&&e>=e)&&(r=e,n=i);else for(let o of t)null!=(o=e(o,++i,t))&&(r>o||void 0===r&&o>=o)&&(r=o,n=i);return n}(this.weights.map((e=>this.distanceFunction(e,t))))}#t(e){const r=[];for(let n=0;n<this.dim;n++){const i=a(e,(t=>t[n])),o=t(e,(t=>t[n]));r.push(f(i,o))}this.weights=[];for(let t=0;t<this.k;t++)this.weights.push(Array.from({length:this.dim},((t,e)=>r[e]())))}predict(t){return t.map((t=>this.#r(t)))}}function g(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n]);return r}const w={distanceFunction:g};function D(t,e,r=w){const n=r.distanceFunction||w.distanceFunction,i=r.similarityFunction||w.similarityFunction;let o=-1;if("function"==typeof i){let r=Number.MIN_VALUE;for(let n=0;n<t.length;n++){const u=i(e,t[n]);u>r&&(r=u,o=n)}}else{if("function"!=typeof n)throw new Error("A similarity or distance function it's required");{let r=Number.MAX_VALUE;for(let i=0;i<t.length;i++){const u=n(e,t[i]);u<r&&(r=u,o=i)}}}return o}function v(t,e,r,n){for(let i=0;i<t.length;i++)r[i]=D(e,t[i],{distanceFunction:n});return r}class y{constructor(t,e,r,n,i){this.clusters=t,this.centroids=e,this.converged=r,this.iterations=n,this.distance=i}nearest(t){const e=new Array(t.length);return v(t,this.centroids,e,this.distance)}computeInformation(t){let e=this.centroids.map((t=>({centroid:t,error:0,size:0})));for(let r=0;r<t.length;r++)e[this.clusters[r]].error+=this.distance(t[r],this.centroids[this.clusters[r]]),e[this.clusters[r]].size++;for(let t=0;t<this.centroids.length;t++){let r=e[t].error;e[t].size&&-1!==r?r/=e[t].size:e[t].error=-1}return e}}const E=Object.prototype.toString;function x(t){const e=E.call(t);return e.endsWith("Array]")&&!e.includes("Big")}function b(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!x(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!x(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!x(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,i=e.toIndex,o=void 0===i?t.length:i;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=n||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var u=t[n],a=n+1;a<o;a++)t[a]<u&&(u=t[a]);return u}(t),i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!x(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,i=e.toIndex,o=void 0===i?t.length:i;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=n||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var u=t[n],a=n+1;a<o;a++)t[a]>u&&(u=t[a]);return u}(t);if(n===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=r.min,u=void 0===o?r.autoMinMax?n:0:o,a=r.max,s=void 0===a?r.autoMinMax?i:1:a;if(u>=s)throw new RangeError("min option must be smaller than max option");for(var f=(s-u)/(i-n),h=0;h<t.length;h++)e[h]=(t[h]-n)*f+u;return e}const A=" ".repeat(2),F=" ".repeat(4);function C(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:i=8,padMinus:o="auto"}=e;return`${t.constructor.name} {\n${A}[\n${F}${function(t,e,r,n,i){const{rows:o,columns:u}=t,a=Math.min(o,e),s=Math.min(u,r),f=[];if("auto"===i){i=!1;t:for(let e=0;e<a;e++)for(let r=0;r<s;r++)if(t.get(e,r)<0){i=!0;break t}}for(let e=0;e<a;e++){let r=[];for(let o=0;o<s;o++)r.push(M(t.get(e,o),n,i));f.push(`${r.join(" ")}`)}s!==u&&(f[f.length-1]+=` ... ${u-r} more columns`);a!==o&&f.push(`... ${o-e} more rows`);return f.join(`\n${F}`)}(t,r,n,i,o)}\n${A}]\n${A}rows: ${t.rows}\n${A}columns: ${t.columns}\n}`}function M(t,e,r){return(t>=0&&r?` ${S(t,e-1)}`:S(t,e)).padEnd(e)}function S(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let i=t.toExponential(e);return i.length>e&&(i=t.toExponential(Math.max(0,e-(i.length-e)))),i.slice(0)}function N(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function _(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function B(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function z(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function T(t,e,r,n,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(k("startRow",e),k("endRow",r),k("startColumn",n),k("endColumn",i),e>r||n>i||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function O(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function k(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function I(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class R{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new j(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)n.set(i,t,r[i*e+t]);return n}static rowVector(t){let e=new j(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new j(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new j(t,e)}static ones(t,e){return new j(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let i=new j(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)i.set(r,t,n());return i}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:i=1e3,random:o=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(i))throw new TypeError("max must be an integer");if(n>=i)throw new RangeError("min must be smaller than max");let u=i-n,a=new j(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(o()*u);a.set(r,t,e)}return a}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),i=this.zeros(t,e);for(let t=0;t<n;t++)i.set(t,t,r);return i}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let i=Math.min(n,e,r),o=this.zeros(e,r);for(let e=0;e<i;e++)o.set(e,e,t[e]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,i=new j(r,n);for(let o=0;o<r;o++)for(let r=0;r<n;r++)i.set(o,r,Math.min(t.get(o,r),e.get(o,r)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,i=new this(r,n);for(let o=0;o<r;o++)for(let r=0;r<n;r++)i.set(o,r,Math.max(t.get(o,r),e.get(o,r)));return i}static checkMatrix(t){return R.isMatrix(t)?t:new j(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let i=e;i<t.rows;i++)t.get(i,r)>t.get(n,r)&&(n=i);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let i=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/i);for(let n=e+1;n<t.rows;n++){let i=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let o=r+1;o<t.columns;o++)t.set(n,o,t.get(n,o)-t.get(e,o)*i)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let i=0,o=!1;for(;i<r&&!1===o;)1===t.get(n,i)?o=!0:i++;for(let r=0;r<n;r++){let o=t.get(r,i);for(let u=i;u<e;u++){let e=t.get(r,u)-o*t.get(n,u);t.set(r,u,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new j(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){N(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return j.rowVector(this.getRow(t))}setRow(t,e){N(this,t),e=B(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){N(this,t),N(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){_(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return j.columnVector(this.getColumn(t))}setColumn(t,e){_(this,t),e=z(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){_(this,t),_(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=B(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=B(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=B(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=B(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=z(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=z(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=z(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=z(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){N(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){_(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){I(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){I(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(N(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){N(this,t),I(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(N(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){N(this,t),I(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(_(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){_(this,t),I(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(_(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){_(this,t),I(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){R.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=j.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,i=new j(e,n),o=new Float64Array(r);for(let u=0;u<n;u++){for(let e=0;e<r;e++)o[e]=t.get(e,u);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*o[n];i.set(t,u,e)}}return i}strassen2x2(t){t=j.checkMatrix(t);let e=new j(2,2);const r=this.get(0,0),n=t.get(0,0),i=this.get(0,1),o=t.get(0,1),u=this.get(1,0),a=t.get(1,0),s=this.get(1,1),f=t.get(1,1),h=(r+s)*(n+f),c=(u+s)*n,l=r*(o-f),p=s*(a-n),m=(r+i)*f,d=h+p-m+(i-s)*(a+f),g=l+m,w=c+p,D=h-c+l+(u-r)*(n+o);return e.set(0,0,d),e.set(0,1,g),e.set(1,0,w),e.set(1,1,D),e}strassen3x3(t){t=j.checkMatrix(t);let e=new j(3,3);const r=this.get(0,0),n=this.get(0,1),i=this.get(0,2),o=this.get(1,0),u=this.get(1,1),a=this.get(1,2),s=this.get(2,0),f=this.get(2,1),h=this.get(2,2),c=t.get(0,0),l=t.get(0,1),p=t.get(0,2),m=t.get(1,0),d=t.get(1,1),g=t.get(1,2),w=t.get(2,0),D=t.get(2,1),v=t.get(2,2),y=(r-o)*(-l+d),E=(-r+o+u)*(c-l+d),x=(o+u)*(-c+l),b=r*c,A=(-r+s+f)*(c-p+g),F=(-r+s)*(p-g),C=(s+f)*(-c+p),M=(-i+f+h)*(d+w-D),S=(i-h)*(d-D),N=i*w,_=(f+h)*(-w+D),B=(-i+u+a)*(g+w-v),z=(i-a)*(g-v),T=(u+a)*(-w+v),O=b+N+n*m,k=(r+n+i-o-u-f-h)*d+E+x+b+M+N+_,I=b+A+C+(r+n+i-u-a-s-f)*g+N+B+T,R=y+u*(-c+l+m-d-g-w+v)+E+b+N+B+z,P=y+E+x+b+a*D,q=N+B+z+T+o*p,V=b+A+F+f*(-c+p+m-d-g-w+D)+M+S+N,U=M+S+N+_+s*l,L=b+A+F+C+h*v;return e.set(0,0,O),e.set(0,1,k),e.set(0,2,I),e.set(1,0,R),e.set(1,1,P),e.set(1,2,q),e.set(2,0,V),e.set(2,1,U),e.set(2,2,L),e}mmulStrassen(t){t=j.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,i=t.rows,o=t.columns;function u(t,e,r){let n=t.rows,i=t.columns;if(n===e&&i===r)return t;{let n=R.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==i&&console.warn(`Multiplying ${r} x ${n} and ${i} x ${o} matrix: dimensions do not match.`);let a=Math.max(r,i),s=Math.max(n,o);return e=u(e,a,s),function t(e,r,n,i){if(n<=512||i<=512)return e.mmul(r);n%2==1&&i%2==1?(e=u(e,n+1,i+1),r=u(r,n+1,i+1)):n%2==1?(e=u(e,n+1,i),r=u(r,n+1,i)):i%2==1&&(e=u(e,n,i+1),r=u(r,n,i+1));let o=parseInt(e.rows/2,10),a=parseInt(e.columns/2,10),s=e.subMatrix(0,o-1,0,a-1),f=r.subMatrix(0,o-1,0,a-1),h=e.subMatrix(0,o-1,a,e.columns-1),c=r.subMatrix(0,o-1,a,r.columns-1),l=e.subMatrix(o,e.rows-1,0,a-1),p=r.subMatrix(o,r.rows-1,0,a-1),m=e.subMatrix(o,e.rows-1,a,e.columns-1),d=r.subMatrix(o,r.rows-1,a,r.columns-1),g=t(R.add(s,m),R.add(f,d),o,a),w=t(R.add(l,m),f,o,a),D=t(s,R.sub(c,d),o,a),v=t(m,R.sub(p,f),o,a),y=t(R.add(s,h),d,o,a),E=t(R.sub(l,s),R.add(f,c),o,a),x=t(R.sub(h,m),R.add(p,d),o,a),b=R.add(g,v);b.sub(y),b.add(x);let A=R.add(D,y),F=R.add(w,v),C=R.sub(g,w);C.add(D),C.add(E);let M=R.zeros(2*b.rows,2*b.columns);return M=M.setSubMatrix(b,0,0),M=M.setSubMatrix(A,b.rows,0),M=M.setSubMatrix(F,0,b.columns),M=M.setSubMatrix(C,b.rows,b.columns),M.subMatrix(0,n-1,0,i-1)}(e,t=u(t,a,s),a,s)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new j(this.rows,this.columns);for(let t=0;t<this.rows;t++){const i=this.getRow(t);i.length>0&&b(i,{min:e,max:r,output:i}),n.setRow(t,i)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new j(this.rows,this.columns);for(let t=0;t<this.columns;t++){const i=this.getColumn(t);i.length&&b(i,{min:e,max:r,output:i}),n.setColumn(t,i)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=j.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,i=t.columns,o=new j(e*n,r*i);for(let u=0;u<e;u++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let a=0;a<i;a++)o.set(n*u+r,i*e+a,this.get(u,e)*t.get(r,a));return o}kroneckerSum(t){if(t=j.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(j.eye(r,r)),i=j.eye(e,e).kroneckerProduct(t);return n.add(i)}transpose(){let t=new j(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=P){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=P){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){T(this,t,e,r,n);let i=new j(e-t+1,n-r+1);for(let o=t;o<=e;o++)for(let e=r;e<=n;e++)i.set(o-t,e-r,this.get(o,e));return i}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new j(t.length,r-e+1);for(let i=0;i<t.length;i++)for(let o=e;o<=r;o++){if(t[i]<0||t[i]>=this.rows)throw new RangeError(`Row index out of range: ${t[i]}`);n.set(i,o-e,this.get(t[i],o))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new j(r-e+1,t.length);for(let i=0;i<t.length;i++)for(let o=e;o<=r;o++){if(t[i]<0||t[i]>=this.columns)throw new RangeError(`Column index out of range: ${t[i]}`);n.set(o-e,i,this.get(o,t[i]))}return n}setSubMatrix(t,e,r){if((t=j.checkMatrix(t)).isEmpty())return this;T(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)this.set(e+n,r+i,t.get(n,i));return this}selection(t,e){!function(t,e){if(!x(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!x(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new j(t.length,e.length);for(let n=0;n<t.length;n++){let i=t[n];for(let t=0;t<e.length;t++){let o=e[t];r.set(n,t,this.get(i,o))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new j(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=O(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=O(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=O(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=O(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!x(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,i=t.columns,o=[];for(let u=0;u<n;u++){let n=0,a=0,s=0;for(let e=0;e<i;e++)s=t.get(u,e)-r[u],n+=s,a+=s*s;e?o.push((a-n*n/i)/(i-1)):o.push((a-n*n/i)/i)}return o}(this,r,n);case"column":if(!x(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,i=t.columns,o=[];for(let u=0;u<i;u++){let i=0,a=0,s=0;for(let e=0;e<n;e++)s=t.get(e,u)-r[u],i+=s,a+=s*s;e?o.push((a-i*i/n)/(n-1)):o.push((a-i*i/n)/n)}return o}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,i=t.columns,o=n*i;let u=0,a=0,s=0;for(let e=0;e<n;e++)for(let n=0;n<i;n++)s=t.get(e,n)-r,u+=s,a+=s*s;return e?(a-u*u/o)/(o-1):(a-u*u/o)/o}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!x(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!x(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!x(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!x(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let i=0;i<t.rows;i++)r+=Math.pow(t.get(i,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return C(this,t)}}function P(t,e){return t-e}R.prototype.klass="Matrix","undefined"!=typeof Symbol&&(R.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return C(this)}),R.random=R.rand,R.randomInt=R.randInt,R.diagonal=R.diag,R.prototype.diagonal=R.prototype.diag,R.identity=R.eye,R.prototype.negate=R.prototype.neg,R.prototype.tensorProduct=R.prototype.kroneckerProduct;let j=class t extends R{constructor(e,r){if(super(),t.isMatrix(e))return e.clone();if(Number.isInteger(e)&&e>=0){if(this.data=[],!(Number.isInteger(r)&&r>=0))throw new TypeError("nColumns must be a positive integer");for(let t=0;t<e;t++)this.data.push(new Float64Array(r))}else{if(!x(e))throw new TypeError("First argument must be a positive number or an array");{const t=e;if("number"!=typeof(r=(e=t.length)?t[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<e;n++){if(t[n].length!==r)throw new RangeError("Inconsistent array dimensions");if(!t[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(t[n]))}}}this.rows=e,this.columns=r}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return N(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),N(this,t,!0),e=Float64Array.from(B(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){_(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),_(this,t,!0),e=z(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let i=0;for(;i<t;i++)n[i]=this.data[r][i];for(n[i++]=e[r];i<this.columns+1;i++)n[i]=this.data[r][i-1];this.data[r]=n}return this.columns+=1,this}};!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(R,j);class q extends R{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}class V{constructor(t){let e,r,n,i,o,u,a,s,f,h=(t=q.checkMatrix(t)).clone(),c=h.rows,l=h.columns,p=new Float64Array(c),m=1;for(e=0;e<c;e++)p[e]=e;for(s=new Float64Array(c),r=0;r<l;r++){for(e=0;e<c;e++)s[e]=h.get(e,r);for(e=0;e<c;e++){for(f=Math.min(e,r),o=0,n=0;n<f;n++)o+=h.get(e,n)*s[n];s[e]-=o,h.set(e,r,s[e])}for(i=r,e=r+1;e<c;e++)Math.abs(s[e])>Math.abs(s[i])&&(i=e);if(i!==r){for(n=0;n<l;n++)u=h.get(i,n),h.set(i,n,h.get(r,n)),h.set(r,n,u);a=p[i],p[i]=p[r],p[r]=a,m=-m}if(r<c&&0!==h.get(r,r))for(e=r+1;e<c;e++)h.set(e,r,h.get(e,r)/h.get(r,r))}this.LU=h,this.pivotVector=p,this.pivotSign=m}isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){t=j.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r,n,i,o=t.columns,u=t.subMatrixRow(this.pivotVector,0,o-1),a=e.columns;for(i=0;i<a;i++)for(r=i+1;r<a;r++)for(n=0;n<o;n++)u.set(r,n,u.get(r,n)-u.get(i,n)*e.get(r,i));for(i=a-1;i>=0;i--){for(n=0;n<o;n++)u.set(i,n,u.get(i,n)/e.get(i,i));for(r=0;r<i;r++)for(n=0;n<o;n++)u.set(r,n,u.get(r,n)-u.get(i,n)*e.get(r,i))}return u}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let n=0;n<r;n++)e*=t.get(n,n);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new j(e,r);for(let i=0;i<e;i++)for(let e=0;e<r;e++)i>e?n.set(i,e,t.get(i,e)):i===e?n.set(i,e,1):n.set(i,e,0);return n}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new j(e,r);for(let i=0;i<e;i++)for(let e=0;e<r;e++)i<=e?n.set(i,e,t.get(i,e)):n.set(i,e,0);return n}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function U(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class L{constructor(t){let e,r,n,i,o=(t=q.checkMatrix(t)).clone(),u=t.rows,a=t.columns,s=new Float64Array(a);for(n=0;n<a;n++){let t=0;for(e=n;e<u;e++)t=U(t,o.get(e,n));if(0!==t){for(o.get(n,n)<0&&(t=-t),e=n;e<u;e++)o.set(e,n,o.get(e,n)/t);for(o.set(n,n,o.get(n,n)+1),r=n+1;r<a;r++){for(i=0,e=n;e<u;e++)i+=o.get(e,n)*o.get(e,r);for(i=-i/o.get(n,n),e=n;e<u;e++)o.set(e,r,o.get(e,r)+i*o.get(e,n))}}s[n]=-t}this.QR=o,this.Rdiag=s}solve(t){t=j.checkMatrix(t);let e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let n,i,o,u,a=t.columns,s=t.clone(),f=e.columns;for(o=0;o<f;o++)for(i=0;i<a;i++){for(u=0,n=o;n<r;n++)u+=e.get(n,o)*s.get(n,i);for(u=-u/e.get(o,o),n=o;n<r;n++)s.set(n,i,s.get(n,i)+u*e.get(n,o))}for(o=f-1;o>=0;o--){for(i=0;i<a;i++)s.set(o,i,s.get(o,i)/this.Rdiag[o]);for(n=0;n<o;n++)for(i=0;i<a;i++)s.set(n,i,s.get(n,i)-s.get(o,i)*e.get(n,o))}return s.subMatrix(0,f-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,n=r.columns,i=new j(n,n);for(t=0;t<n;t++)for(e=0;e<n;e++)t<e?i.set(t,e,r.get(t,e)):t===e?i.set(t,e,this.Rdiag[t]):i.set(t,e,0);return i}get orthogonalMatrix(){let t,e,r,n,i=this.QR,o=i.rows,u=i.columns,a=new j(o,u);for(r=u-1;r>=0;r--){for(t=0;t<o;t++)a.set(t,r,0);for(a.set(r,r,1),e=r;e<u;e++)if(0!==i.get(r,r)){for(n=0,t=r;t<o;t++)n+=i.get(t,r)*a.get(t,e);for(n=-n/i.get(r,r),t=r;t<o;t++)a.set(t,e,a.get(t,e)+n*i.get(t,r))}}return a}}class Z{constructor(t,e={}){if((t=q.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:o=!0,autoTranspose:u=!1}=e;let a,s=Boolean(i),f=Boolean(o),h=!1;if(r<n)if(u){a=t.transpose(),r=a.rows,n=a.columns,h=!0;let e=s;s=f,f=e}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();let c=Math.min(r,n),l=Math.min(r+1,n),p=new Float64Array(l),m=new j(r,c),d=new j(n,n),g=new Float64Array(n),w=new Float64Array(r),D=new Float64Array(l);for(let t=0;t<l;t++)D[t]=t;let v=Math.min(r-1,n),y=Math.max(0,Math.min(n-2,r)),E=Math.max(v,y);for(let t=0;t<E;t++){if(t<v){p[t]=0;for(let e=t;e<r;e++)p[t]=U(p[t],a.get(e,t));if(0!==p[t]){a.get(t,t)<0&&(p[t]=-p[t]);for(let e=t;e<r;e++)a.set(e,t,a.get(e,t)/p[t]);a.set(t,t,a.get(t,t)+1)}p[t]=-p[t]}for(let e=t+1;e<n;e++){if(t<v&&0!==p[t]){let n=0;for(let i=t;i<r;i++)n+=a.get(i,t)*a.get(i,e);n=-n/a.get(t,t);for(let i=t;i<r;i++)a.set(i,e,a.get(i,e)+n*a.get(i,t))}g[e]=a.get(t,e)}if(s&&t<v)for(let e=t;e<r;e++)m.set(e,t,a.get(e,t));if(t<y){g[t]=0;for(let e=t+1;e<n;e++)g[t]=U(g[t],g[e]);if(0!==g[t]){g[t+1]<0&&(g[t]=0-g[t]);for(let e=t+1;e<n;e++)g[e]/=g[t];g[t+1]+=1}if(g[t]=-g[t],t+1<r&&0!==g[t]){for(let e=t+1;e<r;e++)w[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)w[e]+=g[r]*a.get(e,r);for(let e=t+1;e<n;e++){let n=-g[e]/g[t+1];for(let i=t+1;i<r;i++)a.set(i,e,a.get(i,e)+n*w[i])}}if(f)for(let e=t+1;e<n;e++)d.set(e,t,g[e])}}let x=Math.min(n,r+1);if(v<n&&(p[v]=a.get(v,v)),r<x&&(p[x-1]=0),y+1<x&&(g[y]=a.get(y,x-1)),g[x-1]=0,s){for(let t=v;t<c;t++){for(let e=0;e<r;e++)m.set(e,t,0);m.set(t,t,1)}for(let t=v-1;t>=0;t--)if(0!==p[t]){for(let e=t+1;e<c;e++){let n=0;for(let i=t;i<r;i++)n+=m.get(i,t)*m.get(i,e);n=-n/m.get(t,t);for(let i=t;i<r;i++)m.set(i,e,m.get(i,e)+n*m.get(i,t))}for(let e=t;e<r;e++)m.set(e,t,-m.get(e,t));m.set(t,t,1+m.get(t,t));for(let e=0;e<t-1;e++)m.set(e,t,0)}else{for(let e=0;e<r;e++)m.set(e,t,0);m.set(t,t,1)}}if(f)for(let t=n-1;t>=0;t--){if(t<y&&0!==g[t])for(let e=t+1;e<n;e++){let r=0;for(let i=t+1;i<n;i++)r+=d.get(i,t)*d.get(i,e);r=-r/d.get(t+1,t);for(let i=t+1;i<n;i++)d.set(i,e,d.get(i,e)+r*d.get(i,t))}for(let e=0;e<n;e++)d.set(e,t,0);d.set(t,t,1)}let b=x-1,A=Number.EPSILON;for(;x>0;){let t,e;for(t=x-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+A*Math.abs(p[t]+Math.abs(p[t+1]));if(Math.abs(g[t])<=e||Number.isNaN(g[t])){g[t]=0;break}}if(t===x-2)e=4;else{let r;for(r=x-1;r>=t&&r!==t;r--){let e=(r!==x?Math.abs(g[r]):0)+(r!==t+1?Math.abs(g[r-1]):0);if(Math.abs(p[r])<=A*e){p[r]=0;break}}r===t?e=3:r===x-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=g[x-2];g[x-2]=0;for(let r=x-2;r>=t;r--){let i=U(p[r],e),o=p[r]/i,u=e/i;if(p[r]=i,r!==t&&(e=-u*g[r-1],g[r-1]=o*g[r-1]),f)for(let t=0;t<n;t++)i=o*d.get(t,r)+u*d.get(t,x-1),d.set(t,x-1,-u*d.get(t,r)+o*d.get(t,x-1)),d.set(t,r,i)}break}case 2:{let e=g[t-1];g[t-1]=0;for(let n=t;n<x;n++){let i=U(p[n],e),o=p[n]/i,u=e/i;if(p[n]=i,e=-u*g[n],g[n]=o*g[n],s)for(let e=0;e<r;e++)i=o*m.get(e,n)+u*m.get(e,t-1),m.set(e,t-1,-u*m.get(e,n)+o*m.get(e,t-1)),m.set(e,n,i)}break}case 3:{const e=Math.max(Math.abs(p[x-1]),Math.abs(p[x-2]),Math.abs(g[x-2]),Math.abs(p[t]),Math.abs(g[t])),i=p[x-1]/e,o=p[x-2]/e,u=g[x-2]/e,a=p[t]/e,h=g[t]/e,c=((o+i)*(o-i)+u*u)/2,l=i*u*(i*u);let w=0;0===c&&0===l||(w=c<0?0-Math.sqrt(c*c+l):Math.sqrt(c*c+l),w=l/(c+w));let D=(a+i)*(a-i)+w,v=a*h;for(let e=t;e<x-1;e++){let i=U(D,v);0===i&&(i=Number.MIN_VALUE);let o=D/i,u=v/i;if(e!==t&&(g[e-1]=i),D=o*p[e]+u*g[e],g[e]=o*g[e]-u*p[e],v=u*p[e+1],p[e+1]=o*p[e+1],f)for(let t=0;t<n;t++)i=o*d.get(t,e)+u*d.get(t,e+1),d.set(t,e+1,-u*d.get(t,e)+o*d.get(t,e+1)),d.set(t,e,i);if(i=U(D,v),0===i&&(i=Number.MIN_VALUE),o=D/i,u=v/i,p[e]=i,D=o*g[e]+u*p[e+1],p[e+1]=-u*g[e]+o*p[e+1],v=u*g[e+1],g[e+1]=o*g[e+1],s&&e<r-1)for(let t=0;t<r;t++)i=o*m.get(t,e)+u*m.get(t,e+1),m.set(t,e+1,-u*m.get(t,e)+o*m.get(t,e+1)),m.set(t,e,i)}g[x-2]=D;break}case 4:if(p[t]<=0&&(p[t]=p[t]<0?-p[t]:0,f))for(let e=0;e<=b;e++)d.set(e,t,-d.get(e,t));for(;t<b&&!(p[t]>=p[t+1]);){let e=p[t];if(p[t]=p[t+1],p[t+1]=e,f&&t<n-1)for(let r=0;r<n;r++)e=d.get(r,t+1),d.set(r,t+1,d.get(r,t)),d.set(r,t,e);if(s&&t<r-1)for(let n=0;n<r;n++)e=m.get(n,t+1),m.set(n,t+1,m.get(n,t)),m.set(n,t,e);t++}x--}}if(h){let t=d;d=m,m=t}this.m=r,this.n=n,this.s=p,this.U=m,this.V=d}solve(t){let e=t,r=this.threshold,n=this.s.length,i=j.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?i.set(t,t,0):i.set(t,t,1/this.s[t]);let o=this.U,u=this.rightSingularVectors,a=u.mmul(i),s=u.rows,f=o.rows,h=j.zeros(s,f);for(let t=0;t<s;t++)for(let e=0;e<f;e++){let r=0;for(let i=0;i<n;i++)r+=a.get(t,i)*o.get(e,i);h.set(t,e,r)}return h.mmul(e)}solveForDiagonal(t){return this.solve(j.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,i=new j(r,this.s.length);for(let o=0;o<r;o++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&i.set(o,r,t.get(o,r)/this.s[r]);let o=this.U,u=o.rows,a=o.columns,s=new j(r,u);for(let t=0;t<r;t++)for(let e=0;e<u;e++){let r=0;for(let n=0;n<a;n++)r+=i.get(t,n)*o.get(e,n);s.set(t,e,r)}return s}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,i=r.length;n<i;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return j.diag(this.s)}}function X(t,e=!1){return t=q.checkMatrix(t),e?new Z(t).inverse():function(t,e,r=!1){return t=q.checkMatrix(t),e=q.checkMatrix(e),r?new Z(t).solve(e):t.isSquare()?new V(t).solve(e):new L(t).solve(e)}(t,j.eye(t.rows))}function $(t,e){const r=65535&(t>>>=0);return((t-r)*(e>>>=0)>>>0)+r*e>>>0}class Y{constructor(t=Date.now()){this.state=new Uint32Array(4),this.init(t),this.random=this.getFloat.bind(this)}getUint32(){return this.nextState(),this.state[3]+this.state[2]>>>0}getFloat(){return 5.960464477539063e-8*(this.getUint32()>>>8)}init(t){if(!Number.isInteger(t))throw new TypeError("seed must be an integer");this.state[0]=t,this.state[1]=0,this.state[2]=0,this.state[3]=0;for(let t=1;t<8;t++)this.state[3&t]^=t+$(1812433253,this.state[t-1&3]^this.state[t-1&3]>>>30>>>0)>>>0;this.periodCertification();for(let t=0;t<8;t++)this.nextState()}periodCertification(){0===this.state[0]&&0===this.state[1]&&0===this.state[2]&&0===this.state[3]&&(this.state[0]=88,this.state[1]=83,this.state[2]=65,this.state[3]=68)}nextState(){let t=this.state[0];t^=t<<15,t^=t>>>18,t^=this.state[3]<<11,this.state[0]=this.state[1],this.state[1]=this.state[2],this.state[2]=this.state[3],this.state[3]=t}}function H(t,e={},r=Math.random){const{size:n=1,replace:i=!1,probabilities:o}=e;let u,a;if(u="number"==typeof t?function(t){const e=[];for(let r=0;r<t;r++)e.push(r);return e}(t):t.slice(),o){if(!i)throw new Error("choice with probabilities and no replacement is not implemented");if(o.length!==u.length)throw new Error("the length of probabilities option should be equal to the number of choices");a=[o[0]];for(let t=1;t<o.length;t++)a[t]=a[t-1]+o[t];if(Math.abs(1-a[a.length-1])>1e-8)throw new Error(`probabilities should sum to 1, but instead sums to ${a[a.length-1]}`)}if(!1===i&&n>u.length)throw new Error("size option is too large");const s=[];for(let t=0;t<n;t++){const t=G(u.length,r,a);s.push(u[t]),i||u.splice(t,1)}return s}function G(t,e,r){const n=e();if(r){let t=0;for(;n>r[t];)t++;return t}return Math.floor(n*t)}class J{constructor(t=Math.random){if("number"==typeof t){const e=new Y(t);this.randomGenerator=e.random}else this.randomGenerator=t}choice(t,e){return H(t,e,this.randomGenerator)}random(){return this.randomGenerator()}randInt(t,e){return void 0===e&&(e=t,t=0),t+Math.floor(this.randomGenerator()*(e-t))}randomSample(t){const e=[];for(let r=0;r<t;r++)e.push(this.random());return e}}function W(t,e){const r=new j(t.rows,e.rows);for(let n=0;n<t.rows;n++)for(let i=0;i<e.rows;i++)r.set(n,i,g(t.getRow(n),e.getRow(i)));return r}function K(t){let e=[];for(let r=0;r<t;r++)e.push(r);return e}function Q(t){let e=[t[0]];for(let r=1;r<t.length;r++)e[r]=e[r-1]+t[r];return e}const tt={maxIterations:100,tolerance:1e-6,initialization:"kmeans++",distanceFunction:g};function et(t,e,r,n,i,o){let u=function(t,e,r,n){const i=e[0].length;let o=new Array(n),u=new Array(n);for(let t=0;t<n;t++){o[t]=new Array(i),u[t]=0;for(let e=0;e<i;e++)o[t][e]=0}for(let t=0;t<e.length;t++){u[r[t]]++;for(let n=0;n<i;n++)o[r[t]][n]+=e[t][n]}for(let e=0;e<n;e++)for(let r=0;r<i;r++)u[e]?o[e][r]/=u[e]:o[e][r]=t[e][r];return o}(t,e,r=v(e,t,r,i.distanceFunction),n),a=function(t,e,r,n){for(let i=0;i<t.length;i++)if(r(t[i],e[i])>n)return!1;return!0}(u,t,i.distanceFunction,i.tolerance);return new y(r,u,a,o,i.distanceFunction)}function rt(t,e,r){const n=function(t){return{...tt,...t}}(r);!function(t,e){if(e<=0||e>t.length||!Number.isInteger(e))throw new Error("K should be a positive integer smaller than the number of points")}(t,e);let i=function(t,e,r){let n;if(Array.isArray(r.initialization)){if(r.initialization.length!==e)throw new Error("The initial centers should have the same length as K");n=r.initialization}else switch(r.initialization){case"kmeans++":n=function(t,e,r={}){const n=new j(t),i=n.rows,o=new J(r.seed),u=[],a=r.localTrials||2+Math.floor(Math.log(e)),s=o.randInt(i);u.push(n.getRow(s));let f=new j(1,n.rows);for(let t=0;t<n.rows;t++)f.set(0,t,g(n.getRow(t),u[0]));let h=[Q(f.getRow(0))];const c=1/h[0][i-1];let l=j.mul(f,c);for(let t=1;t<e;t++){const e=o.choice(i,{replace:!0,size:a,probabilities:l.getRow(0)}),r=W(n.selection(e,K(n.columns)),n);let s=1/0,c=1/0,p=f;for(let t=0;t<a;t++){const n=j.min(f,[r.getRow(t)]),i=n.sum();i<c&&(s=e[t],c=i,p=n)}u[t]=n.getRow(s),f=p,h=[Q(f.getRow(0))],l=j.mul(f,1/h[0][i-1])}return u}(t,e,r);break;case"random":n=function(t,e,r){return new J(r).choice(t,{size:e})}(t,e,r.seed);break;case"mostDistant":n=function(t,e,r,n){const i=new J(n);let o=new Array(e);if(o[0]=Math.floor(i.random()*t.length),e>1){let n={dist:-1,index:-1};for(let e=0;e<t.length;++e)r[o[0]][e]>n.dist&&(n.dist=r[o[0]][e],n.index=e);if(o[1]=n.index,e>2)for(let n=2;n<e;++n){let e={dist:-1,index:-1};for(let i=0;i<t.length;++i){let t={dist:Number.MAX_VALUE,index:-1};for(let e=0;e<n;++e)r[e][i]<t.dist&&!o.includes(i)&&(t={dist:r[e][i],index:i});t.dist!==Number.MAX_VALUE&&t.dist>e.dist&&(e={...t})}o[n]=e.index}}return o.map((e=>t[e]))}(t,e,function(t,e){let r=new Array(t.length);for(let n=0;n<t.length;++n)for(let i=n;i<t.length;++i){r[n]||(r[n]=new Array(t.length)),r[i]||(r[i]=new Array(t.length));const o=e(t[n],t[i]);r[n][i]=o,r[i][n]=o}return r}(t,r.distanceFunction),r.seed);break;default:!function(t,e){throw new Error(`${e}: "${String(t)}"`)}(r.initialization,"Unknown initialization method")}return n}(t,e,n);0===n.maxIterations&&(n.maxIterations=Number.MAX_VALUE);let o,u=new Array(t.length),a=!1,s=0;for(;!a&&s<n.maxIterations;)o=et(i,t,u,e,n,++s),a=o.converged,i=o.centroids;if(!o)throw new Error("unreachable: no kmeans step executed");return o}var nt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function it(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function ot(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var r=function t(){return this instanceof t?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,n.get?n:{enumerable:!0,get:function(){return t[e]}})})),r}var ut,at,st={exports:{}};ut=st,at=function(){function t(t){return s(t,f(a(h(t.length),t),1/t.length))}function e(t){return a(c(t),t)}function r(t,e){return f(t,e?1/(t.length-1):1/t.length)}function n(t){var e=function(t){var e,r=Math.pow(2,-52),n=1e-64/r,i=50,o=0,u=0,a=0,s=0,f=0,h=l(t),c=h.length,p=h[0].length;if(c<p)throw"Need more rows than columns";var m=new Array(p),d=new Array(p);for(u=0;u<p;u++)m[u]=d[u]=0;var g=D([p,p],0);function w(t,e){return(t=Math.abs(t))>(e=Math.abs(e))?t*Math.sqrt(1+e*e/t/t):0==e?t:e*Math.sqrt(1+t*t/e/e)}function D(t,e,r){void 0===r&&(r=0);var n,i=t[r],o=Array(i);if(r===t.length-1){for(n=i-2;n>=0;n-=2)o[n+1]=e,o[n]=e;return-1===n&&(o[0]=e),o}for(n=i-1;n>=0;n--)o[n]=D(t,e,r+1);return o}var v=0,y=0,E=0,x=0,b=0,A=0,F=0;for(u=0;u<p;u++){for(m[u]=y,F=0,f=u+1,a=u;a<c;a++)F+=h[a][u]*h[a][u];if(F<=n)y=0;else for(v=h[u][u],y=Math.sqrt(F),v>=0&&(y=-y),E=v*y-F,h[u][u]=v-y,a=f;a<p;a++){for(F=0,s=u;s<c;s++)F+=h[s][u]*h[s][a];for(v=F/E,s=u;s<c;s++)h[s][a]+=v*h[s][u]}for(d[u]=y,F=0,a=f;a<p;a++)F+=h[u][a]*h[u][a];if(F<=n)y=0;else{for(v=h[u][u+1],y=Math.sqrt(F),v>=0&&(y=-y),E=v*y-F,h[u][u+1]=v-y,a=f;a<p;a++)m[a]=h[u][a]/E;for(a=f;a<c;a++){for(F=0,s=f;s<p;s++)F+=h[a][s]*h[u][s];for(s=f;s<p;s++)h[a][s]+=F*m[s]}}(b=Math.abs(d[u])+Math.abs(m[u]))>x&&(x=b)}for(u=p-1;-1!=u;u+=-1){if(0!=y){for(E=y*h[u][u+1],a=f;a<p;a++)g[a][u]=h[u][a]/E;for(a=f;a<p;a++){for(F=0,s=f;s<p;s++)F+=h[u][s]*g[s][a];for(s=f;s<p;s++)g[s][a]+=F*g[s][u]}}for(a=f;a<p;a++)g[u][a]=0,g[a][u]=0;g[u][u]=1,y=m[u],f=u}for(u=p-1;-1!=u;u+=-1){for(f=u+1,y=d[u],a=f;a<p;a++)h[u][a]=0;if(0!=y){for(E=h[u][u]*y,a=f;a<p;a++){for(F=0,s=f;s<c;s++)F+=h[s][u]*h[s][a];for(v=F/E,s=u;s<c;s++)h[s][a]+=v*h[s][u]}for(a=u;a<c;a++)h[a][u]=h[a][u]/y}else for(a=u;a<c;a++)h[a][u]=0;h[u][u]+=1}for(r*=x,s=p-1;-1!=s;s+=-1)for(var C=0;C<i;C++){var M=!1;for(f=s;-1!=f;f+=-1){if(Math.abs(m[f])<=r){M=!0;break}if(Math.abs(d[f-1])<=r)break}if(!M){o=0,F=1;var S=f-1;for(u=f;u<s+1&&(v=F*m[u],m[u]=o*m[u],!(Math.abs(v)<=r));u++)for(E=w(v,y=d[u]),d[u]=E,o=y/E,F=-v/E,a=0;a<c;a++)b=h[a][S],A=h[a][u],h[a][S]=b*o+A*F,h[a][u]=-b*F+A*o}if(A=d[s],f==s){if(A<0)for(d[s]=-A,a=0;a<p;a++)g[a][s]=-g[a][s];break}if(C>=i-1)throw"Error: no convergence.";for(x=d[f],y=w(v=(((b=d[s-1])-A)*(b+A)+((y=m[s-1])-(E=m[s]))*(y+E))/(2*E*b),1),v=v<0?((x-A)*(x+A)+E*(b/(v-y)-E))/x:((x-A)*(x+A)+E*(b/(v+y)-E))/x,o=1,F=1,u=f+1;u<s+1;u++){for(y=m[u],b=d[u],E=F*y,y*=o,A=w(v,E),m[u-1]=A,v=x*(o=v/A)+y*(F=E/A),y=-x*F+y*o,E=b*F,b*=o,a=0;a<p;a++)x=g[a][u-1],A=g[a][u],g[a][u-1]=x*o+A*F,g[a][u]=-x*F+A*o;for(A=w(v,E),d[u-1]=A,v=(o=v/A)*y+(F=E/A)*b,x=-F*y+o*b,a=0;a<c;a++)b=h[a][u-1],A=h[a][u],h[a][u-1]=b*o+A*F,h[a][u]=-b*F+A*o}m[f]=0,m[s]=v,d[s]=x}for(u=0;u<d.length;u++)d[u]<r&&(d[u]=0);for(u=0;u<p;u++)for(a=u-1;a>=0;a--)if(d[a]<d[u]){for(o=d[a],d[a]=d[u],d[u]=o,s=0;s<h.length;s++)e=h[s][u],h[s][u]=h[s][a],h[s][a]=e;for(s=0;s<g.length;s++)e=g[s][u],g[s][u]=g[s][a],g[s][a]=e;u=a}return{U:h,S:d,V:g}}(t);console.log(e);var r=e.U;return e.S.map((function(t,e){var n={};return n.eigenvalue=t,n.vector=r.map((function(t,r){return-1*t[e]})),n}))}function i(e,...r){var n=r.map((function(t){return t.vector})),i=a(n,c(t(e))),o=f(a(h(e.length),e),-1/e.length);return{adjustedData:i,formattedAdjustedData:u(i,2),avgData:o,selectedVectors:n}}function o(i){return n(r(e(t(i)),!1))}function u(t,e){var r=Math.pow(10,e||2);return t.map((function(t,e){return t.map((function(t){return Math.round(t*r)/r}))}))}function a(t,e){if(!(t[0]&&e[0]&&t.length&&e.length))throw new Error("Both A and B should be matrices");if(e.length!==t[0].length)throw new Error("Columns in A should be the same as the number of rows in B");for(var r=[],n=0;n<t.length;n++){r[n]=[];for(var i=0;i<e[0].length;i++)for(var o=0;o<t[0].length;o++)r[n][i]=r[n][i]?r[n][i]+t[n][o]*e[o][i]:t[n][o]*e[o][i]}return r}function s(t,e){if(t.length!==e.length||t[0].length!==e[0].length)throw new Error("Both A and B should have the same dimensions");for(var r=[],n=0;n<t.length;n++){r[n]=[];for(var i=0;i<e[0].length;i++)r[n][i]=t[n][i]-e[n][i]}return r}function f(t,e){for(var r=[],n=0;n<t.length;n++){r[n]=[];for(var i=0;i<t[0].length;i++)r[n][i]=t[n][i]*e}return r}function h(t){for(var e=[],r=0;r<t;r++){e[r]=[];for(var n=0;n<t;n++)e[r][n]=1}return e}function c(t){return l(t)[0].map((function(e,r){return t.map((function(t){return t[r]}))}))}function l(t){var e=JSON.stringify(t);return JSON.parse(e)}return{computeDeviationScores:e,computeDeviationMatrix:t,computeSVD:n,computePercentageExplained:function(t,...e){var r=t.map((function(t){return t.eigenvalue})).reduce((function(t,e){return t+e}));return e.map((function(t){return t.eigenvalue})).reduce((function(t,e){return t+e}))/r},computeOriginalData:function(t,e,r){var n=s(c(a(c(e),t)),r);return{originalData:n,formattedOriginalData:u(n,2)}},computeVarianceCovariance:r,computeAdjustedData:i,getEigenVectors:o,analyseTopResult:function(t){var e=o(t).sort((function(t,e){return e.eigenvalue-t.eigenvalue}));return console.log("Sorted Vectors",e),i(t,e[0].vector)},transpose:c,multiply:a,clone:l,scale:f}}(),ut.exports=at;var ft=st.exports,ht={},ct={},lt={},pt={},mt=nt&&nt.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}};function dt(t,e){return Math.floor(e()*t)}function gt(t){for(var e=[],r=0;r<t;r++)e.push(void 0);return e}function wt(t,e){return gt(t).map((function(){return e}))}function Dt(t){return wt(t,0)}function vt(t){return t.reduce((function(t,e){return t+e}))}Object.defineProperty(pt,"__esModule",{value:!0}),pt.tauRandInt=dt,pt.tauRand=function(t){return t()},pt.norm=function(t){var e,r,n=0;try{for(var i=mt(t),o=i.next();!o.done;o=i.next()){var u=o.value;n+=Math.pow(u,2)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return Math.sqrt(n)},pt.empty=gt,pt.range=function(t){return gt(t).map((function(t,e){return e}))},pt.filled=wt,pt.zeros=Dt,pt.ones=function(t){return wt(t,1)},pt.linear=function(t,e,r){return gt(r).map((function(n,i){return t+i*((e-t)/(r-1))}))},pt.sum=vt,pt.mean=function(t){return vt(t)/t.length},pt.max=function(t){for(var e=0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return e},pt.max2d=function(t){for(var e=0,r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++)e=t[r][n]>e?t[r][n]:e;return e},pt.rejectionSample=function(t,e,r){for(var n=Dt(t),i=0;i<t;i++)for(var o=!0;o;){for(var u=dt(e,r),a=!1,s=0;s<i;s++)if(u===n[s]){a=!0;break}a||(o=!1),n[i]=u}return n},pt.reshape2d=function(t,e,r){var n=[],i=0;if(t.length!==e*r)throw new Error("Array dimensions must match input length.");for(var o=0;o<e;o++){for(var u=[],a=0;a<r;a++)u.push(t[i]),i+=1;n.push(u)}return n};var yt=nt&&nt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(lt,"__esModule",{value:!0});var Et=yt(pt);function xt(t,e){var r=function(r){return Et.empty(t).map((function(){return Et.filled(e,r)}))},n=[];return n.push(r(-1)),n.push(r(1/0)),n.push(r(0)),n}function bt(t,e,r,n,i){e=Math.floor(e);var o=t[0][e],u=t[1][e];if(t[2][e],r>=u[0])return 0;for(var a=0;a<o.length;a++)if(n===o[a])return 0;return At(t,e,r,n,i)}function At(t,e,r,n,i){var o=t[0][e],u=t[1][e],a=t[2][e];if(r>=u[0])return 0;u[0]=r,o[0]=n,a[0]=i;for(var s=0,f=0;;){var h=2*s+1,c=h+1,l=t[0][0].length;if(h>=l)break;if(c>=l){if(!(u[h]>r))break;f=h}else if(u[h]>=u[c]){if(!(r<u[h]))break;f=h}else{if(!(r<u[c]))break;f=c}u[s]=u[f],o[s]=o[f],a[s]=a[f],s=f}return u[s]=r,o[s]=n,a[s]=i,1}function Ft(t,e,r,n){for(;2*n+1<r;){var i=2*n+1,o=i+1,u=n;if(t[u]<t[i]&&(u=i),o<r&&t[u]<t[o]&&(u=o),u===n)break;var a=t[n];t[n]=t[u],t[u]=a;var s=e[n];e[n]=e[u],e[u]=s,n=u}}lt.makeHeap=xt,lt.rejectionSample=function(t,e,r){for(var n=Et.zeros(t),i=0;i<t;i++){for(var o=!0,u=0;o;){u=Et.tauRandInt(e,r);for(var a=!1,s=0;s<i;s++)if(u===n[s]){a=!0;break}a||(o=!1)}n[i]=u}return n},lt.heapPush=bt,lt.uncheckedHeapPush=At,lt.buildCandidates=function(t,e,r,n,i){for(var o=xt(e,n),u=0;u<e;u++)for(var a=0;a<r;a++)if(!(t[0][u][a]<0)){var s=t[0][u][a],f=t[2][u][a],h=Et.tauRand(i);bt(o,u,h,s,f),bt(o,s,h,u,f),t[2][u][a]=0}return o},lt.deheapSort=function(t){for(var e=t[0],r=t[1],n=0;n<e.length;n++)for(var i=e[n],o=r[n],u=0;u<i.length-1;u++){var a=i.length-u-1,s=o.length-u-1,f=i[0];i[0]=i[a],i[a]=f;var h=o[0];o[0]=o[s],o[s]=h,Ft(o,i,s,0)}return{indices:e,weights:r}},lt.smallestFlagged=function(t,e){for(var r=t[0][e],n=t[1][e],i=t[2][e],o=1/0,u=-1,a=0;a>r.length;a++)1===i[a]&&n[a]<o&&(o=n[a],u=a);return u>=0?(i[u]=0,Math.floor(r[u])):-1};var Ct,Mt={},St=nt&&nt.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)u.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return u},Nt=nt&&nt.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},_t=nt&&nt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(Mt,"__esModule",{value:!0});var Bt=_t(pt),zt=function(){function t(t,e,r,n){if(this.entries=new Map,this.nRows=0,this.nCols=0,t.length!==e.length||t.length!==r.length)throw new Error("rows, cols and values arrays must all have the same length");this.nRows=n[0],this.nCols=n[1];for(var i=0;i<r.length;i++){var o=t[i],u=e[i];this.checkDims(o,u);var a=this.makeKey(o,u);this.entries.set(a,{value:r[i],row:o,col:u})}}return t.prototype.makeKey=function(t,e){return t+":"+e},t.prototype.checkDims=function(t,e){if(!(t<this.nRows&&e<this.nCols))throw new Error("row and/or col specified outside of matrix dimensions")},t.prototype.set=function(t,e,r){this.checkDims(t,e);var n=this.makeKey(t,e);this.entries.has(n)?this.entries.get(n).value=r:this.entries.set(n,{value:r,row:t,col:e})},t.prototype.get=function(t,e,r){void 0===r&&(r=0),this.checkDims(t,e);var n=this.makeKey(t,e);return this.entries.has(n)?this.entries.get(n).value:r},t.prototype.getAll=function(t){void 0===t&&(t=!0);var e=[];return this.entries.forEach((function(t){e.push(t)})),t&&e.sort((function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row})),e},t.prototype.getDims=function(){return[this.nRows,this.nCols]},t.prototype.getRows=function(){return Array.from(this.entries,(function(t){var e=St(t,2);return e[0],e[1].row}))},t.prototype.getCols=function(){return Array.from(this.entries,(function(t){var e=St(t,2);return e[0],e[1].col}))},t.prototype.getValues=function(){return Array.from(this.entries,(function(t){var e=St(t,2);return e[0],e[1].value}))},t.prototype.forEach=function(t){this.entries.forEach((function(e){return t(e.value,e.row,e.col)}))},t.prototype.map=function(e){var r=[];this.entries.forEach((function(t){r.push(e(t.value,t.row,t.col))}));var n=[this.nRows,this.nCols];return new t(this.getRows(),this.getCols(),r,n)},t.prototype.toArray=function(){var t=this,e=Bt.empty(this.nRows).map((function(){return Bt.zeros(t.nCols)}));return this.entries.forEach((function(t){e[t.row][t.col]=t.value})),e},t}();Mt.SparseMatrix=zt,Mt.transpose=function(t){var e=[],r=[],n=[];t.forEach((function(t,i,o){e.push(i),r.push(o),n.push(t)}));var i=[t.nCols,t.nRows];return new zt(r,e,n,i)},Mt.identity=function(t){for(var e=St(t,1)[0],r=new zt([],[],[],t),n=0;n<e;n++)r.set(n,n,1);return r},Mt.pairwiseMultiply=function(t,e){return Ot(t,e,(function(t,e){return t*e}))},Mt.add=function(t,e){return Ot(t,e,(function(t,e){return t+e}))},Mt.subtract=function(t,e){return Ot(t,e,(function(t,e){return t-e}))},Mt.maximum=function(t,e){return Ot(t,e,(function(t,e){return t>e?t:e}))},Mt.multiplyScalar=function(t,e){return t.map((function(t){return t*e}))},Mt.eliminateZeros=function(t){for(var e=new Set,r=t.getValues(),n=t.getRows(),i=t.getCols(),o=0;o<r.length;o++)0===r[o]&&e.add(o);var u=function(t,r){return!e.has(r)},a=r.filter(u),s=n.filter(u),f=i.filter(u);return new zt(s,f,a,t.getDims())},Mt.normalize=function(t,e){var r,n;void 0===e&&(e="l2");var i=Tt[e],o=new Map;t.forEach((function(t,e,r){var n=o.get(e)||[];n.push(r),o.set(e,n)}));var u=new zt([],[],[],t.getDims()),a=function(e){for(var r=o.get(e).sort(),n=r.map((function(r){return t.get(e,r)})),a=i(n),s=0;s<a.length;s++)u.set(e,r[s],a[s])};try{for(var s=Nt(o.keys()),f=s.next();!f.done;f=s.next()){a(f.value)}}catch(t){r={error:t}}finally{try{f&&!f.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return u};var Tt=((Ct={}).max=function(t){for(var e=-1/0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return t.map((function(t){return t/e}))},Ct.l1=function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return t.map((function(t){return t/e}))},Ct.l2=function(t){for(var e=0,r=0;r<t.length;r++)e+=Math.pow(t[r],2);return t.map((function(t){return Math.sqrt(Math.pow(t,2)/e)}))},Ct);function Ot(t,e,r){for(var n=new Set,i=[],o=[],u=[],a=function(n,a){i.push(n),o.push(a);var s=r(t.get(n,a),e.get(n,a));u.push(s)},s=t.getValues(),f=t.getRows(),h=t.getCols(),c=0;c<s.length;c++){var l=(g=f[c])+":"+(w=h[c]);n.add(l),a(g,w)}var p=e.getValues(),m=e.getRows(),d=e.getCols();for(c=0;c<p.length;c++){var g,w;l=(g=m[c])+":"+(w=d[c]);n.has(l)||a(g,w)}var D=[t.nRows,t.nCols];return new zt(i,o,u,D)}Mt.getCSR=function(t){var e=[];t.forEach((function(t,r,n){e.push({value:t,row:r,col:n})})),e.sort((function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row}));for(var r=[],n=[],i=[],o=-1,u=0;u<e.length;u++){var a=e[u],s=a.row,f=a.col,h=a.value;s!==o&&(o=s,i.push(u)),r.push(f),n.push(h)}return{indices:r,values:n,indptr:i}};var kt={},It={},Rt=nt&&nt.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)u.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return u},Pt=nt&&nt.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Rt(arguments[e]));return t},jt=nt&&nt.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},qt=nt&&nt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(It,"__esModule",{value:!0});var Vt=qt(pt),Ut=function(t,e,r,n){this.hyperplanes=t,this.offsets=e,this.children=r,this.indices=n};function Lt(t,e,r,n,i){if(void 0===r&&(r=30),e.length>r){var o=function(t,e,r){var n=t[0].length,i=Vt.tauRandInt(e.length,r),o=Vt.tauRandInt(e.length,r);o=(o+=i===o?1:0)%e.length;for(var u=e[i],a=e[o],s=0,f=Vt.zeros(n),h=0;h<f.length;h++)f[h]=t[u][h]-t[a][h],s-=f[h]*(t[u][h]+t[a][h])/2;var c=0,l=0,p=Vt.zeros(e.length);for(h=0;h<e.length;h++){for(var m=s,d=0;d<n;d++)m+=f[d]*t[e[h]][d];0===m?(p[h]=Vt.tauRandInt(2,r),0===p[h]?c+=1:l+=1):m>0?(p[h]=0,c+=1):(p[h]=1,l+=1)}var g=Vt.zeros(c),w=Vt.zeros(l);c=0,l=0;for(h=0;h<p.length;h++)0===p[h]?(g[c]=e[h],c+=1):(w[l]=e[h],l+=1);return{indicesLeft:g,indicesRight:w,hyperplane:f,offset:s}}(t,e,i),u=o.indicesLeft,a=o.indicesRight,s=o.hyperplane,f=o.offset;return{leftChild:Lt(t,u,r,n+1,i),rightChild:Lt(t,a,r,n+1,i),isLeaf:!1,hyperplane:s,offset:f}}return{indices:e,isLeaf:!0}}function Zt(t,e,r,n,i,o,u){var a;if(t.isLeaf)return n[o][0]=-u,(a=i[u]).splice.apply(a,Pt([0,t.indices.length],t.indices)),{nodeNum:o,leafNum:u+=1};e[o]=t.hyperplane,r[o]=t.offset,n[o][0]=o+1;var s=o,f=Zt(t.leftChild,e,r,n,i,o+1,u);return o=f.nodeNum,u=f.leafNum,n[s][1]=o+1,{nodeNum:(f=Zt(t.rightChild,e,r,n,i,o+1,u)).nodeNum,leafNum:f.leafNum}}function Xt(t){return t.isLeaf?1:1+Xt(t.leftChild)+Xt(t.rightChild)}function $t(t){return t.isLeaf?1:$t(t.leftChild)+$t(t.rightChild)}function Yt(t,e,r,n){for(var i=e,o=0;o<r.length;o++)i+=t[o]*r[o];return 0===i?Vt.tauRandInt(2,n):i>0?0:1}It.FlatTree=Ut,It.makeForest=function(t,e,r,n){var i=Math.max(10,e),o=Vt.range(r).map((function(e,r){return function(t,e,r,n){void 0===e&&(e=30);var i=Vt.range(t.length),o=Lt(t,i,e,r,n);return o}(t,i,r,n)})),u=o.map((function(t){return function(t,e){var r=Xt(t),n=$t(t),i=Vt.range(r).map((function(){return Vt.zeros(t.hyperplane?t.hyperplane.length:0)})),o=Vt.zeros(r),u=Vt.range(r).map((function(){return[-1,-1]})),a=Vt.range(n).map((function(){return Vt.range(e).map((function(){return-1}))}));return Zt(t,i,o,u,a,0,0),new Ut(i,o,u,a)}(t,i)}));return u},It.makeLeafArray=function(t){var e,r;if(t.length>0){var n=[];try{for(var i=jt(t),o=i.next();!o.done;o=i.next()){var u=o.value;n.push.apply(n,Pt(u.indices))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}return[[-1]]},It.searchFlatTree=function(t,e,r){for(var n=0;e.children[n][0]>0;){n=0===Yt(e.hyperplanes[n],e.offsets[n],t,r)?e.children[n][0]:e.children[n][1]}var i=-1*e.children[n][0];return e.indices[i]};var Ht=nt&&nt.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},Gt=nt&&nt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(kt,"__esModule",{value:!0});var Jt=Gt(lt),Wt=Gt(Mt),Kt=Gt(It),Qt=Gt(pt);kt.makeNNDescent=function(t,e){return function(r,n,i,o,u,a,s,f){void 0===o&&(o=10),void 0===u&&(u=50),void 0===a&&(a=.001),void 0===s&&(s=.5),void 0===f&&(f=!0);for(var h=r.length,c=Jt.makeHeap(r.length,i),l=0;l<r.length;l++)for(var p=Jt.rejectionSample(i,r.length,e),m=0;m<p.length;m++){var d=t(r[l],r[p[m]]);Jt.heapPush(c,l,d,p[m],1),Jt.heapPush(c,p[m],d,l,1)}if(f)for(var g=0;g<n.length;g++)for(l=0;l<n[g].length&&!(n[g][l]<0);l++)for(m=l+1;m<n[g].length&&!(n[g][m]<0);m++){d=t(r[n[g][l]],r[n[g][m]]);Jt.heapPush(c,n[g][l],d,n[g][m],1),Jt.heapPush(c,n[g][m],d,n[g][l],1)}for(g=0;g<o;g++){var w=Jt.buildCandidates(c,h,i,u,e),D=0;for(l=0;l<h;l++)for(m=0;m<u;m++){var v=Math.floor(w[0][l][m]);if(!(v<0||Qt.tauRand(e)<s))for(var y=0;y<u;y++){var E=Math.floor(w[0][l][y]),x=w[2][l][m],b=w[2][l][y];if(!(E<0||!x&&!b)){d=t(r[v],r[E]);D+=Jt.heapPush(c,v,d,E,1),D+=Jt.heapPush(c,E,d,v,1)}}}if(D<=a*i*r.length)break}return Jt.deheapSort(c)}},kt.makeInitializations=function(t){return{initFromRandom:function(e,r,n,i,o){for(var u=0;u<n.length;u++)for(var a=Qt.rejectionSample(e,r.length,o),s=0;s<a.length;s++)if(!(a[s]<0)){var f=t(r[a[s]],n[u]);Jt.heapPush(i,u,f,a[s],1)}},initFromTree:function(e,r,n,i,o){for(var u=0;u<n.length;u++)for(var a=Kt.searchFlatTree(n[u],e,o),s=0;s<a.length;s++){if(a[s]<0)return;var f=t(r[a[s]],n[u]);Jt.heapPush(i,u,f,a[s],1)}}}},kt.makeInitializedNNSearch=function(t){return function(e,r,n,i){for(var o,u,a=Wt.getCSR(r),s=a.indices,f=a.indptr,h=0;h<i.length;h++)for(var c=new Set(n[0][h]);;){var l=Jt.smallestFlagged(n,h);if(-1===l)break;var p=s.slice(f[l],f[l+1]);try{for(var m=Ht(p),d=m.next();!d.done;d=m.next()){var g=d.value;if(g!==l&&-1!==g&&!c.has(g)){var w=t(e[g],i[h]);Jt.uncheckedHeapPush(n,h,w,g,1),c.add(g)}}}catch(t){o={error:t}}finally{try{d&&!d.done&&(u=m.return)&&u.call(m)}finally{if(o)throw o.error}}}return n}},kt.initializeSearch=function(t,e,r,n,i,o,u){var a,s,f=Jt.makeHeap(r.length,n);if(i(n,e,r,f,u),t)try{for(var h=Ht(t),c=h.next();!c.done;c=h.next()){o(c.value,e,r,f,u)}}catch(t){a={error:t}}finally{try{c&&!c.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}return f};const te=Object.prototype.toString;function ee(t){return te.call(t).endsWith("Array]")}function re(t,e,r){let n=0;const i=r(e);for(let e=0;e<t.x.length;e++)n+=Math.abs(t.y[e]-i(t.x[e]));return n}function ne(t,e,r,n,i){let o=r*n*n,u=j.eye(e.length,e.length,o);const a=i(e);let s=new Float64Array(t.x.length);for(let e=0;e<t.x.length;e++)s[e]=a(t.x[e]);let f=function(t,e,r,n,i){const o=r.length,u=t.x.length;let a=new Array(o);for(let s=0;s<o;s++){a[s]=new Array(u);let o=r.slice();o[s]+=n;let f=i(o);for(let r=0;r<u;r++)a[s][r]=e[r]-f(t.x[r])}return new j(a)}(t,s,e,n,i),h=function(t,e){const r=t.x.length;let n=new Array(r);for(let i=0;i<r;i++)n[i]=[t.y[i]-e[i]];return new j(n)}(t,s),c=X(u.add(f.mmul(f.transpose())));return(e=(e=new j([e])).sub(c.mmul(f).mmul(h).mul(n).transpose())).to1DArray()}var ie=ot(Object.freeze({__proto__:null,default:function(t,e,r={}){let{maxIterations:n=100,gradientDifference:i=.1,damping:o=0,errorTolerance:u=.01,minValues:a,maxValues:s,initialValues:f}=r;if(o<=0)throw new Error("The damping option must be a positive number");if(!t.x||!t.y)throw new Error("The data parameter must have x and y elements");if(!ee(t.x)||t.x.length<2||!ee(t.y)||t.y.length<2)throw new Error("The data parameter elements must be an array with more than 2 points");if(t.x.length!==t.y.length)throw new Error("The data parameter elements must have the same size");let h=f||new Array(e.length).fill(1),c=h.length;if(s=s||new Array(c).fill(Number.MAX_SAFE_INTEGER),a=a||new Array(c).fill(Number.MIN_SAFE_INTEGER),s.length!==a.length)throw new Error("minValues and maxValues must be the same size");if(!ee(h))throw new Error("initialValues must be an array");let l,p=re(t,h,e),m=p<=u;for(l=0;l<n&&!m;l++){h=ne(t,h,o,i,e);for(let t=0;t<c;t++)h[t]=Math.min(Math.max(a[t],h[t]),s[t]);if(p=re(t,h,e),isNaN(p))break;m=p<=u}return{parameterValues:h,parameterError:p,iterations:l}}})),oe=nt&&nt.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function u(t){try{s(n.next(t))}catch(t){o(t)}}function a(t){try{s(n.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new r((function(e){e(t.value)})).then(u,a)}s((n=n.apply(t,e||[])).next())}))},ue=nt&&nt.__generator||function(t,e){var r,n,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,n=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=u.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=e.call(t,u)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},ae=nt&&nt.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)u.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return u},se=nt&&nt.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ae(arguments[e]));return t},fe=nt&&nt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},he=nt&&nt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ct,"__esModule",{value:!0});var ce=fe(lt),le=fe(Mt),pe=fe(kt),me=fe(It),de=fe(pt),ge=he(ie),we=1e-5,De=.001,ve=function(){function t(t){void 0===t&&(t={});var e=this;this.learningRate=1,this.localConnectivity=1,this.minDist=.1,this.nComponents=2,this.nEpochs=0,this.nNeighbors=15,this.negativeSampleRate=5,this.random=Math.random,this.repulsionStrength=1,this.setOpMixRatio=1,this.spread=1,this.transformQueueSize=4,this.targetMetric="categorical",this.targetWeight=.5,this.targetNNeighbors=this.nNeighbors,this.distanceFn=ye,this.isInitialized=!1,this.rpForest=[],this.embedding=[],this.optimizationState=new Ee;var r=function(r){void 0!==t[r]&&(e[r]=t[r])};r("distanceFn"),r("learningRate"),r("localConnectivity"),r("minDist"),r("nComponents"),r("nEpochs"),r("nNeighbors"),r("negativeSampleRate"),r("random"),r("repulsionStrength"),r("setOpMixRatio"),r("spread"),r("transformQueueSize")}return t.prototype.fit=function(t){return this.initializeFit(t),this.optimizeLayout(),this.embedding},t.prototype.fitAsync=function(t,e){return void 0===e&&(e=function(){return!0}),oe(this,void 0,void 0,(function(){return ue(this,(function(r){switch(r.label){case 0:return this.initializeFit(t),[4,this.optimizeLayoutAsync(e)];case 1:return r.sent(),[2,this.embedding]}}))}))},t.prototype.setSupervisedProjection=function(t,e){void 0===e&&(e={}),this.Y=t,this.targetMetric=e.targetMetric||this.targetMetric,this.targetWeight=e.targetWeight||this.targetWeight,this.targetNNeighbors=e.targetNNeighbors||this.targetNNeighbors},t.prototype.setPrecomputedKNN=function(t,e){this.knnIndices=t,this.knnDistances=e},t.prototype.initializeFit=function(t){if(t.length<=this.nNeighbors)throw new Error("Not enough data points ("+t.length+") to create nNeighbors: "+this.nNeighbors+".  Add more data points or adjust the configuration.");if(this.X===t&&this.isInitialized)return this.getNEpochs();if(this.X=t,!this.knnIndices&&!this.knnDistances){var e=this.nearestNeighbors(t);this.knnIndices=e.knnIndices,this.knnDistances=e.knnDistances}this.graph=this.fuzzySimplicialSet(t,this.nNeighbors,this.setOpMixRatio),this.makeSearchFns(),this.searchGraph=this.makeSearchGraph(t),this.processGraphForSupervisedProjection();var r=this.initializeSimplicialSetEmbedding(),n=r.head,i=r.tail,o=r.epochsPerSample;return this.optimizationState.head=n,this.optimizationState.tail=i,this.optimizationState.epochsPerSample=o,this.initializeOptimization(),this.prepareForOptimizationLoop(),this.isInitialized=!0,this.getNEpochs()},t.prototype.makeSearchFns=function(){var t=pe.makeInitializations(this.distanceFn),e=t.initFromTree,r=t.initFromRandom;this.initFromTree=e,this.initFromRandom=r,this.search=pe.makeInitializedNNSearch(this.distanceFn)},t.prototype.makeSearchGraph=function(t){for(var e=this.knnIndices,r=this.knnDistances,n=[t.length,t.length],i=new le.SparseMatrix([],[],[],n),o=0;o<e.length;o++)for(var u=e[o],a=r[o],s=0;s<u.length;s++){var f=u[s],h=a[s];h>0&&i.set(o,f,h)}var c=le.transpose(i);return le.maximum(i,c)},t.prototype.transform=function(t){var e=this,r=this.X;if(void 0===r||0===r.length)throw new Error("No data has been fit.");var n=Math.floor(this.nNeighbors*this.transformQueueSize);n=Math.min(r.length,n);var i=pe.initializeSearch(this.rpForest,r,t,n,this.initFromRandom,this.initFromTree,this.random),o=this.search(r,this.searchGraph,i,t),u=ce.deheapSort(o),a=u.indices,s=u.weights;a=a.map((function(t){return t.slice(0,e.nNeighbors)})),s=s.map((function(t){return t.slice(0,e.nNeighbors)}));var f=Math.max(0,this.localConnectivity-1),h=this.smoothKNNDistance(s,this.nNeighbors,f),c=h.sigmas,l=h.rhos,p=this.computeMembershipStrengths(a,s,c,l),m=p.rows,d=p.cols,g=p.vals,w=[t.length,r.length],D=new le.SparseMatrix(m,d,g,w),v=le.normalize(D,"l1"),y=le.getCSR(v),E=t.length,x=Me(de.reshape2d(y.indices,E,this.nNeighbors),de.reshape2d(y.values,E,this.nNeighbors),this.embedding),b=this.nEpochs?this.nEpochs/3:D.nRows<=1e4?100:30,A=D.getValues().reduce((function(t,e){return e>t?e:t}),0);D=D.map((function(t){return t<A/b?0:t})),D=le.eliminateZeros(D);var F=this.makeEpochsPerSample(D.getValues(),b),C=D.getRows(),M=D.getCols();return this.assignOptimizationStateParameters({headEmbedding:x,tailEmbedding:this.embedding,head:C,tail:M,currentEpoch:0,nEpochs:b,nVertices:D.getDims()[1],epochsPerSample:F}),this.prepareForOptimizationLoop(),this.optimizeLayout()},t.prototype.processGraphForSupervisedProjection=function(){var t=this.Y,e=this.X;if(t){if(t.length!==e.length)throw new Error("Length of X and y must be equal");if("categorical"===this.targetMetric){var r=this.targetWeight<1?1/(1-this.targetWeight)*2.5:1e12;this.graph=this.categoricalSimplicialSetIntersection(this.graph,t,r)}}},t.prototype.step=function(){var t=this.optimizationState.currentEpoch;return t<this.getNEpochs()&&this.optimizeLayoutStep(t),this.optimizationState.currentEpoch},t.prototype.getEmbedding=function(){return this.embedding},t.prototype.nearestNeighbors=function(t){var e,r=this.distanceFn,n=this.nNeighbors,i=pe.makeNNDescent(r,this.random),o=5+Math.floor(.5===(e=Math.pow(t.length,.5)/20)?0:Math.round(e)),u=Math.max(5,Math.floor(Math.round(function(t){return Math.log(t)/Math.log(2)}(t.length))));this.rpForest=me.makeForest(t,n,o,this.random);var a=i(t,me.makeLeafArray(this.rpForest),n,u);return{knnIndices:a.indices,knnDistances:a.weights}},t.prototype.fuzzySimplicialSet=function(t,e,r){void 0===r&&(r=1);var n=this,i=n.knnIndices,o=void 0===i?[]:i,u=n.knnDistances,a=void 0===u?[]:u,s=n.localConnectivity,f=this.smoothKNNDistance(a,e,s),h=f.sigmas,c=f.rhos,l=this.computeMembershipStrengths(o,a,h,c),p=l.rows,m=l.cols,d=l.vals,g=[t.length,t.length],w=new le.SparseMatrix(p,m,d,g),D=le.transpose(w),v=le.pairwiseMultiply(w,D),y=le.subtract(le.add(w,D),v),E=le.multiplyScalar(y,r),x=le.multiplyScalar(v,1-r);return le.add(E,x)},t.prototype.categoricalSimplicialSetIntersection=function(t,e,r,n){void 0===n&&(n=1);var i=Fe(t,e,n,r);return Ce(i=le.eliminateZeros(i))},t.prototype.smoothKNNDistance=function(t,e,r,n,i){void 0===r&&(r=1),void 0===n&&(n=64),void 0===i&&(i=1);for(var o=Math.log(e)/Math.log(2)*i,u=de.zeros(t.length),a=de.zeros(t.length),s=0;s<t.length;s++){var f=0,h=1/0,c=1,l=t[s],p=l.filter((function(t){return t>0}));if(p.length>=r){var m=Math.floor(r),d=r-m;m>0?(u[s]=p[m-1],d>we&&(u[s]+=d*(p[m]-p[m-1]))):u[s]=d*p[0]}else p.length>0&&(u[s]=de.max(p));for(var g=0;g<n;g++){for(var w=0,D=1;D<t[s].length;D++){var v=t[s][D]-u[s];w+=v>0?Math.exp(-v/c):1}if(Math.abs(w-o)<we)break;w>o?c=(f+(h=c))/2:(f=c,h===1/0?c*=2:c=(f+h)/2)}if(a[s]=c,u[s]>0){var y=de.mean(l);a[s]<De*y&&(a[s]=De*y)}else{var E=de.mean(t.map(de.mean));a[s]<De*E&&(a[s]=De*E)}}return{sigmas:a,rhos:u}},t.prototype.computeMembershipStrengths=function(t,e,r,n){for(var i=t.length,o=t[0].length,u=de.zeros(i*o),a=de.zeros(i*o),s=de.zeros(i*o),f=0;f<i;f++)for(var h=0;h<o;h++){var c=0;-1!==t[f][h]&&(c=t[f][h]===f?0:e[f][h]-n[f]<=0?1:Math.exp(-(e[f][h]-n[f])/r[f]),u[f*o+h]=f,a[f*o+h]=t[f][h],s[f*o+h]=c)}return{rows:u,cols:a,vals:s}},t.prototype.initializeSimplicialSetEmbedding=function(){for(var t=this,e=this.getNEpochs(),r=this.nComponents,n=this.graph.getValues(),i=0,o=0;o<n.length;o++){var u=n[o];i<n[o]&&(i=u)}var a=this.graph.map((function(t){return t<i/e?0:t}));this.embedding=de.zeros(a.nRows).map((function(){return de.zeros(r).map((function(){return 20*de.tauRand(t.random)-10}))}));var s=[],f=[],h=[],c=a.getAll();for(o=0;o<c.length;o++){var l=c[o];l.value&&(s.push(l.value),h.push(l.row),f.push(l.col))}return{head:f,tail:h,epochsPerSample:this.makeEpochsPerSample(s,e)}},t.prototype.makeEpochsPerSample=function(t,e){var r=de.filled(t.length,-1),n=de.max(t),i=t.map((function(t){return t/n*e}));return i.forEach((function(t,n){t>0&&(r[n]=e/i[n])})),r},t.prototype.assignOptimizationStateParameters=function(t){Object.assign(this.optimizationState,t)},t.prototype.prepareForOptimizationLoop=function(){var t=this,e=t.repulsionStrength,r=t.learningRate,n=t.negativeSampleRate,i=this.optimizationState,o=i.epochsPerSample,u=i.headEmbedding,a=i.tailEmbedding,s=u[0].length,f=u.length===a.length,h=o.map((function(t){return t/n})),c=se(h),l=se(o);this.assignOptimizationStateParameters({epochOfNextSample:l,epochOfNextNegativeSample:c,epochsPerNegativeSample:h,moveOther:f,initialAlpha:r,alpha:r,gamma:e,dim:s})},t.prototype.initializeOptimization=function(){var t=this.embedding,e=this.embedding,r=this.optimizationState,n=r.head,i=r.tail,o=r.epochsPerSample,u=this.getNEpochs(),a=this.graph.nCols,s=Ae(this.spread,this.minDist),f=s.a,h=s.b;this.assignOptimizationStateParameters({headEmbedding:t,tailEmbedding:e,head:n,tail:i,epochsPerSample:o,a:f,b:h,nEpochs:u,nVertices:a})},t.prototype.optimizeLayoutStep=function(t){for(var e=this.optimizationState,r=e.head,n=e.tail,i=e.headEmbedding,o=e.tailEmbedding,u=e.epochsPerSample,a=e.epochOfNextSample,s=e.epochOfNextNegativeSample,f=e.epochsPerNegativeSample,h=e.moveOther,c=e.initialAlpha,l=e.alpha,p=e.gamma,m=e.a,d=e.b,g=e.dim,w=e.nEpochs,D=e.nVertices,v=0;v<u.length;v++)if(!(a[v]>t)){var y=r[v],E=n[v],x=i[y],b=o[E],A=be(x,b),F=0;A>0&&(F=-2*m*d*Math.pow(A,d-1),F/=m*Math.pow(A,d)+1);for(var C=0;C<g;C++){var M=xe(F*(x[C]-b[C]),4);x[C]+=M*l,h&&(b[C]+=-M*l)}a[v]+=u[v];for(var S=Math.floor((t-s[v])/f[v]),N=0;N<S;N++){var _=de.tauRandInt(D,this.random),B=o[_],z=be(x,B),T=0;if(z>0)T=2*p*d,T/=(.001+z)*(m*Math.pow(z,d)+1);else if(y===_)continue;for(C=0;C<g;C++){M=4;T>0&&(M=xe(T*(x[C]-B[C]),4)),x[C]+=M*l}}s[v]+=S*f[v]}return e.alpha=c*(1-t/w),e.currentEpoch+=1,i},t.prototype.optimizeLayoutAsync=function(t){var e=this;return void 0===t&&(t=function(){return!0}),new Promise((function(r,n){var i=function(){return oe(e,void 0,void 0,(function(){var e,o,u,a,s,f;return ue(this,(function(h){try{if(e=this.optimizationState,o=e.nEpochs,u=e.currentEpoch,this.embedding=this.optimizeLayoutStep(u),a=this.optimizationState.currentEpoch,s=!1===t(a),f=a===o,s||f)return[2,r(f)];setTimeout((function(){return i()}),0)}catch(t){n(t)}return[2]}))}))};setTimeout((function(){return i()}),0)}))},t.prototype.optimizeLayout=function(t){void 0===t&&(t=function(){return!0});for(var e=!1,r=[];!e;){var n=this.optimizationState,i=n.nEpochs,o=n.currentEpoch;r=this.optimizeLayoutStep(o);var u=this.optimizationState.currentEpoch,a=!1===t(u);e=u===i||a}return r},t.prototype.getNEpochs=function(){var t=this.graph;if(this.nEpochs>0)return this.nEpochs;var e=t.nRows;return e<=2500?500:e<=5e3?400:e<=7500?300:200},t}();function ye(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return Math.sqrt(r)}ct.UMAP=ve,ct.euclidean=ye,ct.cosine=function(t,e){for(var r=0,n=0,i=0,o=0;o<t.length;o++)r+=t[o]*e[o],n+=Math.pow(t[o],2),i+=Math.pow(e[o],2);return 0===n&&0===i?0:0===n||0===i?1:1-r/Math.sqrt(n*i)};var Ee=function(){this.currentEpoch=0,this.headEmbedding=[],this.tailEmbedding=[],this.head=[],this.tail=[],this.epochsPerSample=[],this.epochOfNextSample=[],this.epochOfNextNegativeSample=[],this.epochsPerNegativeSample=[],this.moveOther=!0,this.initialAlpha=1,this.alpha=1,this.gamma=1,this.a=1.5769434603113077,this.b=.8950608779109733,this.dim=2,this.nEpochs=500,this.nVertices=0};function xe(t,e){return t>e?e:t<-e?-e:t}function be(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return r}function Ae(t,e){var r=de.linear(0,3*t,300).map((function(t){return t<e?1:t})),n=de.zeros(r.length).map((function(n,i){return r[i]>=e?Math.exp(-(r[i]-e)/t):n})),i={x:r,y:n},o={damping:1.5,initialValues:[.5,.5],gradientDifference:.1,maxIterations:100,errorTolerance:.01},u=ge.default(i,(function(t){var e=ae(t,2),r=e[0],n=e[1];return function(t){return 1/(1+r*Math.pow(t,2*n))}}),o).parameterValues,a=ae(u,2);return{a:a[0],b:a[1]}}function Fe(t,e,r,n){return void 0===r&&(r=1),void 0===n&&(n=5),t.map((function(t,i,o){return-1===e[i]||-1===e[o]?t*Math.exp(-r):e[i]!==e[o]?t*Math.exp(-n):t}))}function Ce(t){t=le.normalize(t,"max");var e=le.transpose(t),r=le.pairwiseMultiply(e,t);return t=le.add(t,le.subtract(e,r)),le.eliminateZeros(t)}function Me(t,e,r){for(var n=de.zeros(t.length).map((function(t){return de.zeros(r[0].length)})),i=0;i<t.length;i++)for(var o=0;o<t[0].length;o++)for(var u=0;u<r[0].length;u++){var a=t[i][o];n[i][u]+=e[i][o]*r[a][u]}return n}ct.findABParams=Ae,ct.fastIntersection=Fe,ct.resetLocalConnectivity=Ce,ct.initTransform=Me,Object.defineProperty(ht,"__esModule",{value:!0});var Se=ct,Ne=ht.UMAP=Se.UMAP;function _e(){return _e=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_e.apply(this,arguments)}var Be={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function ze(t){return"number"==typeof t}function Te(t){return!(!t||"object"!=typeof t||"function"!=typeof t.constructor)&&(!0===t.isBigNumber&&"object"==typeof t.constructor.prototype&&!0===t.constructor.prototype.isBigNumber||"function"==typeof t.constructor.isDecimal&&!0===t.constructor.isDecimal(t))}function Oe(t){return t&&"object"==typeof t&&!0===Object.getPrototypeOf(t).isComplex||!1}function ke(t){return t&&"object"==typeof t&&!0===Object.getPrototypeOf(t).isFraction||!1}function Ie(t){return t&&!0===t.constructor.prototype.isUnit||!1}function Re(t){return"string"==typeof t}var Pe=Array.isArray;function je(t){return t&&!0===t.constructor.prototype.isMatrix||!1}function qe(t){return Array.isArray(t)||je(t)}function Ve(t){return t&&t.isDenseMatrix&&!0===t.constructor.prototype.isMatrix||!1}function Ue(t){return t&&t.isSparseMatrix&&!0===t.constructor.prototype.isMatrix||!1}function Le(t){return t&&!0===t.constructor.prototype.isRange||!1}function Ze(t){return t&&!0===t.constructor.prototype.isIndex||!1}function Xe(t){return"boolean"==typeof t}function $e(t){return t&&!0===t.constructor.prototype.isResultSet||!1}function Ye(t){return t&&!0===t.constructor.prototype.isHelp||!1}function He(t){return"function"==typeof t}function Ge(t){return t instanceof Date}function Je(t){return t instanceof RegExp}function We(t){return!(!t||"object"!=typeof t||t.constructor!==Object||Oe(t)||ke(t))}function Ke(t){return null===t}function Qe(t){return void 0===t}function tr(t){return t&&!0===t.isAccessorNode&&!0===t.constructor.prototype.isNode||!1}function er(t){return t&&!0===t.isArrayNode&&!0===t.constructor.prototype.isNode||!1}function rr(t){return t&&!0===t.isAssignmentNode&&!0===t.constructor.prototype.isNode||!1}function nr(t){return t&&!0===t.isBlockNode&&!0===t.constructor.prototype.isNode||!1}function ir(t){return t&&!0===t.isConditionalNode&&!0===t.constructor.prototype.isNode||!1}function or(t){return t&&!0===t.isConstantNode&&!0===t.constructor.prototype.isNode||!1}function ur(t){return t&&!0===t.isFunctionAssignmentNode&&!0===t.constructor.prototype.isNode||!1}function ar(t){return t&&!0===t.isFunctionNode&&!0===t.constructor.prototype.isNode||!1}function sr(t){return t&&!0===t.isIndexNode&&!0===t.constructor.prototype.isNode||!1}function fr(t){return t&&!0===t.isNode&&!0===t.constructor.prototype.isNode||!1}function hr(t){return t&&!0===t.isObjectNode&&!0===t.constructor.prototype.isNode||!1}function cr(t){return t&&!0===t.isOperatorNode&&!0===t.constructor.prototype.isNode||!1}function lr(t){return t&&!0===t.isParenthesisNode&&!0===t.constructor.prototype.isNode||!1}function pr(t){return t&&!0===t.isRangeNode&&!0===t.constructor.prototype.isNode||!1}function mr(t){return t&&!0===t.isRelationalNode&&!0===t.constructor.prototype.isNode||!1}function dr(t){return t&&!0===t.isSymbolNode&&!0===t.constructor.prototype.isNode||!1}function gr(t){return t&&!0===t.constructor.prototype.isChain||!1}function wr(t){var e=typeof t;return"object"===e?null===t?"null":Te(t)?"BigNumber":t.constructor&&t.constructor.name?t.constructor.name:"Object":e}function Dr(t){var e=typeof t;if("number"===e||"string"===e||"boolean"===e||null==t)return t;if("function"==typeof t.clone)return t.clone();if(Array.isArray(t))return t.map((function(t){return Dr(t)}));if(t instanceof Date)return new Date(t.valueOf());if(Te(t))return t;if(t instanceof RegExp)throw new TypeError("Cannot clone "+t);return function(t,e){var r={};for(var n in t)yr(t,n)&&(r[n]=e(t[n]));return r}(t,Dr)}function vr(t,e){var r,n,i;if(Array.isArray(t)){if(!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(n=0,i=t.length;n<i;n++)if(!vr(t[n],e[n]))return!1;return!0}if("function"==typeof t)return t===e;if(t instanceof Object){if(Array.isArray(e)||!(e instanceof Object))return!1;for(r in t)if(!(r in e)||!vr(t[r],e[r]))return!1;for(r in e)if(!(r in t))return!1;return!0}return t===e}function yr(t,e){return t&&Object.hasOwnProperty.call(t,e)}var Er=function(t){if(t)throw new Error("The global config is readonly. \nPlease create a mathjs instance if you want to change the default configuration. \nExample:\n\n  import { create, all } from 'mathjs';\n  const mathjs = create(all);\n  mathjs.config({ number: 'BigNumber' });\n");return Object.freeze(Be)};function xr(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return br(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return br(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return u=t.done,t},e:function(t){a=!0,o=t},f:function(){try{u||null==r.return||r.return()}finally{if(a)throw o}}}}function br(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ar(t){return Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ar(t)}function Fr(){return!0}function Cr(){return!1}function Mr(){}_e(Er,Be,{MATRIX_OPTIONS:["Matrix","Array"],NUMBER_OPTIONS:["number","BigNumber","Fraction"]});var Sr="Argument is not a typed-function.";var Nr=function t(){function e(t){return"object"===Ar(t)&&null!==t&&t.constructor===Object}var r,n,i=[{name:"number",test:function(t){return"number"==typeof t}},{name:"string",test:function(t){return"string"==typeof t}},{name:"boolean",test:function(t){return"boolean"==typeof t}},{name:"Function",test:function(t){return"function"==typeof t}},{name:"Array",test:Array.isArray},{name:"Date",test:function(t){return t instanceof Date}},{name:"RegExp",test:function(t){return t instanceof RegExp}},{name:"Object",test:e},{name:"null",test:function(t){return null===t}},{name:"undefined",test:function(t){return void 0===t}}],o={name:"any",test:Fr,isAny:!0},u=0,a={createCount:0};function s(t){var e=r.get(t);if(e)return e;var i,o,u='Unknown type "'+t+'"',a=t.toLowerCase(),s=xr(n);try{for(s.s();!(o=s.n()).done;)if((i=o.value).toLowerCase()===a){u+='. Did you mean "'+i+'" ?';break}}catch(t){s.e(t)}finally{s.f()}throw new TypeError(u)}function f(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"any",i=e?s(e).index:n.length,o=[],u=0;u<t.length;++u){if(!t[u]||"string"!=typeof t[u].name||"function"!=typeof t[u].test)throw new TypeError("Object with properties {name: string, test: function} expected");var a=t[u].name;if(r.has(a))throw new TypeError('Duplicate type name "'+a+'"');o.push(a),r.set(a,{name:a,test:t[u].test,isAny:t[u].isAny,index:i+u,conversionsTo:[]})}var f=n.slice(i);n=n.slice(0,i).concat(o).concat(f);for(var h=i+o.length;h<n.length;++h)r.get(n[h]).index=h}function h(){r=new Map,n=[],u=0,f([o],!1)}function c(t){var e=n.filter((function(e){var n=r.get(e);return!n.isAny&&n.test(t)}));return e.length?e:["any"]}function l(t){return t&&"function"==typeof t&&"_typedFunctionData"in t}function p(t,e,r){if(!l(t))throw new TypeError(Sr);var n=r&&r.exact,i=D(Array.isArray(e)?e.join(","):e),o=m(i);if(!n||o in t.signatures){var u=t._typedFunctionData.signatureMap.get(o);if(u)return u}var a,s,f,h=i.length;if(n)for(s in a=[],t.signatures)a.push(t._typedFunctionData.signatureMap.get(s));else a=t._typedFunctionData.signatures;for(var c=0;c<h;++c){var p,d=i[c],g=[],v=void 0,y=xr(a);try{for(y.s();!(p=y.n()).done;){var E=x((v=p.value).params,c);if(E&&(!d.restParam||E.restParam)){if(!E.hasAny)if("continue"===function(){var t=w(E);if(d.types.some((function(e){return!t.has(e.name)})))return"continue"}())continue;g.push(v)}}}catch(t){y.e(t)}finally{y.f()}if(0===(a=g).length)break}var b,A=xr(a);try{for(A.s();!(b=A.n()).done;)if((f=b.value).params.length<=h)return f}catch(t){A.e(t)}finally{A.f()}throw new TypeError("Signature not found (signature: "+(t.name||"unnamed")+"("+m(i,", ")+"))")}function m(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return t.map((function(t){return t.name})).join(e)}function d(t){var e=0===t.indexOf("..."),r=(e?t.length>3?t.slice(3):"any":t).split("|").map((function(t){return s(t.trim())})),n=!1,i=e?"...":"";return{types:r.map((function(t){return n=t.isAny||n,i+=t.name+"|",{name:t.name,typeIndex:t.index,test:t.test,isAny:t.isAny,conversion:null,conversionIndex:-1}})),name:i.slice(0,-1),hasAny:n,hasConversion:!1,restParam:e}}function g(t){var e=function(t){if(0===t.length)return[];var e=t.map(s);t.length>1&&e.sort((function(t,e){return t.index-e.index}));var r=e[0].conversionsTo;if(1===t.length)return r;r=r.concat([]);for(var n=new Set(t),i=1;i<e.length;++i){var o,u=void 0,a=xr(e[i].conversionsTo);try{for(a.s();!(o=a.n()).done;)u=o.value,n.has(u.from)||(r.push(u),n.add(u.from))}catch(t){a.e(t)}finally{a.f()}}return r}(t.types.map((function(t){return t.name}))),r=t.hasAny,n=t.name,i=e.map((function(t){var e=s(t.from);return r=e.isAny||r,n+="|"+t.from,{name:t.from,typeIndex:e.index,test:e.test,isAny:e.isAny,conversion:t,conversionIndex:t.index}}));return{types:t.types.concat(i),name:n,hasAny:r,hasConversion:i.length>0,restParam:t.restParam}}function w(t){return t.typeSet||(t.typeSet=new Set,t.types.forEach((function(e){return t.typeSet.add(e.name)}))),t.typeSet}function D(t){var e=[];if("string"!=typeof t)throw new TypeError("Signatures must be strings");var r=t.trim();if(""===r)return e;for(var n=r.split(","),i=0;i<n.length;++i){var o=d(n[i].trim());if(o.restParam&&i!==n.length-1)throw new SyntaxError('Unexpected rest parameter "'+n[i]+'": only allowed for the last parameter');if(0===o.types.length)return null;e.push(o)}return e}function v(t){var e=j(t);return!!e&&e.restParam}function y(t){if(t&&0!==t.types.length){if(1===t.types.length)return s(t.types[0].name).test;if(2===t.types.length){var e=s(t.types[0].name).test,r=s(t.types[1].name).test;return function(t){return e(t)||r(t)}}var n=t.types.map((function(t){return s(t.name).test}));return function(t){for(var e=0;e<n.length;e++)if(n[e](t))return!0;return!1}}return Fr}function E(t){var e,r,n;if(v(t)){var i=(e=P(t).map(y)).length,o=y(j(t));return function(t){for(var r=0;r<e.length;r++)if(!e[r](t[r]))return!1;return function(t){for(var e=i;e<t.length;e++)if(!o(t[e]))return!1;return!0}(t)&&t.length>=i+1}}return 0===t.length?function(t){return 0===t.length}:1===t.length?(r=y(t[0]),function(t){return r(t[0])&&1===t.length}):2===t.length?(r=y(t[0]),n=y(t[1]),function(t){return r(t[0])&&n(t[1])&&2===t.length}):(e=t.map(y),function(t){for(var r=0;r<e.length;r++)if(!e[r](t[r]))return!1;return t.length===e.length})}function x(t,e){return e<t.length?t[e]:v(t)?j(t):null}function b(t,e){var r=x(t,e);return r?w(r):new Set}function A(t){return null===t.conversion||void 0===t.conversion}function F(t,e){var r=new Set;return t.forEach((function(t){var n,i,o=xr(b(t.params,e));try{for(o.s();!(i=o.n()).done;)n=i.value,r.add(n)}catch(t){o.e(t)}finally{o.f()}})),r.has("any")?["any"]:Array.from(r)}function C(t,e,r){var n,i,o,u=t||"unnamed",a=r,s=function(){var t=[];if(a.forEach((function(r){var n=y(x(r.params,o));(o<r.params.length||v(r.params))&&n(e[o])&&t.push(r)})),0===t.length){if((i=F(a,o)).length>0){var r=c(e[o]);return(n=new TypeError("Unexpected type of argument in function "+u+" (expected: "+i.join(" or ")+", actual: "+r.join(" | ")+", index: "+o+")")).data={category:"wrongType",fn:u,index:o,actual:r,expected:i},{v:n}}}else a=t};for(o=0;o<e.length;o++){var f=s();if("object"===Ar(f))return f.v}var h=a.map((function(t){return v(t.params)?1/0:t.params.length}));if(e.length<Math.min.apply(null,h))return i=F(a,o),(n=new TypeError("Too few arguments in function "+u+" (expected: "+i.join(" or ")+", index: "+e.length+")")).data={category:"tooFewArgs",fn:u,index:e.length,expected:i},n;var l=Math.max.apply(null,h);if(e.length>l)return(n=new TypeError("Too many arguments in function "+u+" (expected: "+l+", actual: "+e.length+")")).data={category:"tooManyArgs",fn:u,index:e.length,expectedLength:l},n;for(var p=[],m=0;m<e.length;++m)p.push(c(e[m]).join("|"));return(n=new TypeError('Arguments of type "'+p.join(", ")+'" do not match any of the defined signatures of function '+u+".")).data={category:"mismatch",actual:p},n}function M(t){for(var e=n.length+1,r=0;r<t.types.length;r++)A(t.types[r])&&(e=Math.min(e,t.types[r].typeIndex));return e}function S(t){for(var e=u+1,r=0;r<t.types.length;r++)A(t.types[r])||(e=Math.min(e,t.types[r].conversionIndex));return e}function N(t,e){if(t.hasAny){if(!e.hasAny)return 1}else if(e.hasAny)return-1;if(t.restParam){if(!e.restParam)return 1}else if(e.restParam)return-1;if(t.hasConversion){if(!e.hasConversion)return 1}else if(e.hasConversion)return-1;var r=M(t)-M(e);if(r<0)return-1;if(r>0)return 1;var n=S(t)-S(e);return n<0?-1:n>0?1:0}function _(t,e){var r=t.params,n=e.params,i=j(r),o=j(n),u=v(r),a=v(n);if(u&&i.hasAny){if(!a||!o.hasAny)return 1}else if(a&&o.hasAny)return-1;var s,f,h=0,c=0,l=xr(r);try{for(l.s();!(f=l.n()).done;)(s=f.value).hasAny&&++h,s.hasConversion&&++c}catch(t){l.e(t)}finally{l.f()}var p,m=0,d=0,g=xr(n);try{for(g.s();!(p=g.n()).done;)(s=p.value).hasAny&&++m,s.hasConversion&&++d}catch(t){g.e(t)}finally{g.f()}if(h!==m)return h-m;if(u&&i.hasConversion){if(!a||!o.hasConversion)return 1}else if(a&&o.hasConversion)return-1;if(c!==d)return c-d;if(u){if(!a)return 1}else if(a)return-1;var w=(r.length-n.length)*(u?-1:1);if(0!==w)return w;for(var D,y=[],E=0,x=0;x<r.length;++x){var b=N(r[x],n[x]);y.push(b),E+=b}if(0!==E)return E;for(var A=0,F=y;A<F.length;A++)if(0!==(D=F[A]))return D;return 0}function B(t,e){var r=e;if(t.some((function(t){return t.hasConversion}))){var n=v(t),i=t.map(z);r=function(){for(var t=[],r=n?arguments.length-1:arguments.length,o=0;o<r;o++)t[o]=i[o](arguments[o]);return n&&(t[r]=arguments[r].map(i[r])),e.apply(this,t)}}var o=r;if(v(t)){var u=t.length-1;o=function(){return r.apply(this,q(arguments,0,u).concat([q(arguments,u)]))}}return o}function z(t){var e,r,n,i,o=[],u=[];switch(t.types.forEach((function(t){t.conversion&&(o.push(s(t.conversion.from).test),u.push(t.conversion.convert))})),u.length){case 0:return function(t){return t};case 1:return e=o[0],n=u[0],function(t){return e(t)?n(t):t};case 2:return e=o[0],r=o[1],n=u[0],i=u[1],function(t){return e(t)?n(t):r(t)?i(t):t};default:return function(t){for(var e=0;e<u.length;e++)if(o[e](t))return u[e](t);return t}}}function T(t){return function t(e,r,n){if(r<e.length){var i=e[r],o=[];if(i.restParam){var u=i.types.filter(A);u.length<i.types.length&&o.push({types:u,name:"..."+u.map((function(t){return t.name})).join("|"),hasAny:u.some((function(t){return t.isAny})),hasConversion:!1,restParam:!0}),o.push(i)}else o=i.types.map((function(t){return{types:[t],name:t.name,hasAny:t.isAny,hasConversion:t.conversion,restParam:!1}}));return a=o,s=function(i){return t(e,r+1,n.concat([i]))},Array.prototype.concat.apply([],a.map(s))}return[n];var a,s}(t,0,[])}function O(t,e,r){var n,i,o=[],u=xr(t);try{for(u.s();!(i=u.n()).done;){var a=r[n=i.value];if("number"!=typeof a)throw new TypeError('No definition for referenced signature "'+n+'"');if("function"!=typeof(a=e[a]))return!1;o.push(a)}}catch(t){u.e(t)}finally{u.f()}return o}function k(t,e,r){for(var n=function(t){return t.map((function(t){return Z(t)?U(t.referToSelf.callback):L(t)?V(t.referTo.references,t.referTo.callback):t}))}(t),i=new Array(n.length).fill(!1),o=!0;o;){o=!1;for(var u=!0,a=0;a<n.length;++a)if(!i[a]){var s=n[a];if(Z(s))n[a]=s.referToSelf.callback(r),n[a].referToSelf=s.referToSelf,i[a]=!0,u=!1;else if(L(s)){var f=O(s.referTo.references,n,e);f?(n[a]=s.referTo.callback.apply(this,f),n[a].referTo=s.referTo,i[a]=!0,u=!1):o=!0}}if(u&&o)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return n}function I(t,e){if(a.createCount++,0===Object.keys(e).length)throw new SyntaxError("No signatures provided");a.warnAgainstDeprecatedThis&&function(t){var e=/\bthis(\(|\.signatures\b)/;Object.keys(t).forEach((function(r){var n=t[r];if(e.test(n.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")}))}(e);var r,n=[],i=[],o={},u=[],s=function(){if(!Object.prototype.hasOwnProperty.call(e,r))return"continue";var t=D(r);if(!t)return"continue";n.forEach((function(e){if(function(t,e){for(var r=Math.max(t.length,e.length),n=0;n<r;n++){var i,o=b(t,n),u=!1,a=void 0,s=xr(b(e,n));try{for(s.s();!(i=s.n()).done;)if(a=i.value,o.has(a)){u=!0;break}}catch(t){s.e(t)}finally{s.f()}if(!u)return!1}var f=t.length,h=e.length,c=v(t),l=v(e);return c?l?f===h:h>=f:l?f>=h:f===h}(e,t))throw new TypeError('Conflicting signatures "'+m(e)+'" and "'+m(t)+'".')})),n.push(t);var a=i.length;i.push(e[r]);var s,f=void 0,h=xr(T(t.map(g)));try{for(h.s();!(s=h.n()).done;){var c=m(f=s.value);u.push({params:f,name:c,fn:a}),f.every((function(t){return!t.hasConversion}))&&(o[c]=a)}}catch(t){h.e(t)}finally{h.f()}};for(r in e)s();u.sort(_);var f,h=k(i,o,ht);for(f in o)Object.prototype.hasOwnProperty.call(o,f)&&(o[f]=h[o[f]]);for(var c=[],l=new Map,p=0,d=u;p<d.length;p++)f=d[p],l.has(f.name)||(f.fn=h[f.fn],c.push(f),l.set(f.name,f));for(var w=c[0]&&c[0].params.length<=2&&!v(c[0].params),x=c[1]&&c[1].params.length<=2&&!v(c[1].params),A=c[2]&&c[2].params.length<=2&&!v(c[2].params),F=c[3]&&c[3].params.length<=2&&!v(c[3].params),C=c[4]&&c[4].params.length<=2&&!v(c[4].params),M=c[5]&&c[5].params.length<=2&&!v(c[5].params),S=w&&x&&A&&F&&C&&M,N=0;N<c.length;++N)c[N].test=E(c[N].params);for(var z=w?y(c[0].params[0]):Cr,O=x?y(c[1].params[0]):Cr,I=A?y(c[2].params[0]):Cr,R=F?y(c[3].params[0]):Cr,P=C?y(c[4].params[0]):Cr,j=M?y(c[5].params[0]):Cr,q=w?y(c[0].params[1]):Cr,V=x?y(c[1].params[1]):Cr,U=A?y(c[2].params[1]):Cr,L=F?y(c[3].params[1]):Cr,Z=C?y(c[4].params[1]):Cr,X=M?y(c[5].params[1]):Cr,$=0;$<c.length;++$)c[$].implementation=B(c[$].params,c[$].fn);var Y=w?c[0].implementation:Mr,H=x?c[1].implementation:Mr,G=A?c[2].implementation:Mr,J=F?c[3].implementation:Mr,W=C?c[4].implementation:Mr,K=M?c[5].implementation:Mr,Q=w?c[0].params.length:-1,tt=x?c[1].params.length:-1,et=A?c[2].params.length:-1,rt=F?c[3].params.length:-1,nt=C?c[4].params.length:-1,it=M?c[5].params.length:-1,ot=S?6:0,ut=c.length,at=c.map((function(t){return t.test})),st=c.map((function(t){return t.implementation})),ft=function(){for(var e=ot;e<ut;e++)if(at[e](arguments))return st[e].apply(this,arguments);return a.onMismatch(t,arguments,c)};function ht(t,e){return arguments.length===Q&&z(t)&&q(e)?Y.apply(this,arguments):arguments.length===tt&&O(t)&&V(e)?H.apply(this,arguments):arguments.length===et&&I(t)&&U(e)?G.apply(this,arguments):arguments.length===rt&&R(t)&&L(e)?J.apply(this,arguments):arguments.length===nt&&P(t)&&Z(e)?W.apply(this,arguments):arguments.length===it&&j(t)&&X(e)?K.apply(this,arguments):ft.apply(this,arguments)}try{Object.defineProperty(ht,"name",{value:t})}catch(t){}return ht.signatures=o,ht._typedFunctionData={signatures:c,signatureMap:l},ht}function R(t,e,r){throw C(t,e,r)}function P(t){return q(t,0,t.length-1)}function j(t){return t[t.length-1]}function q(t,e,r){return Array.prototype.slice.call(t,e,r)}function V(t,e){return{referTo:{references:t,callback:e}}}function U(t){if("function"!=typeof t)throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:t}}}function L(t){return t&&"object"===Ar(t.referTo)&&Array.isArray(t.referTo.references)&&"function"==typeof t.referTo.callback}function Z(t){return t&&"object"===Ar(t.referToSelf)&&"function"==typeof t.referToSelf.callback}function X(t,e){if(!t)return e;if(e&&e!==t){var r=new Error("Function names do not match (expected: "+t+", actual: "+e+")");throw r.data={actual:e,expected:t},r}return t}function $(t){var e;for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(l(t[r])||"string"==typeof t[r].signature)&&(e=X(e,t[r].name));return e}function Y(t,e){var r;for(r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(r in t&&e[r]!==t[r]){var n=new Error('Signature "'+r+'" is defined twice');throw n.data={signature:r,sourceFunction:e[r],destFunction:t[r]},n}t[r]=e[r]}}h(),f(i);var H=a;function G(t){if(!t||"string"!=typeof t.from||"string"!=typeof t.to||"function"!=typeof t.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(t.to===t.from)throw new SyntaxError('Illegal to define conversion from "'+t.from+'" to itself.')}return a=function(t){for(var r="string"==typeof t,n=r?t:"",i={},o=r?1:0;o<arguments.length;++o){var u=arguments[o],a={},s=void 0;if("function"==typeof u?(s=u.name,"string"==typeof u.signature?a[u.signature]=u:l(u)&&(a=u.signatures)):e(u)&&(a=u,r||(s=$(u))),0===Object.keys(a).length){var f=new TypeError("Argument to 'typed' at index "+o+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw f.data={index:o,argument:u},f}r||(n=X(n,s)),Y(i,a)}return I(n||"",i)},a.create=t,a.createCount=H.createCount,a.onMismatch=R,a.throwMismatchError=R,a.createError=C,a.clear=h,a.clearConversions=function(){var t,e,i=xr(n);try{for(i.s();!(e=i.n()).done;)t=e.value,r.get(t).conversionsTo=[]}catch(t){i.e(t)}finally{i.f()}u=0},a.addTypes=f,a._findType=s,a.referTo=function(){var t=P(arguments).map((function(t){return m(D(t))})),e=j(arguments);if("function"!=typeof e)throw new TypeError("Callback function expected as last argument");return V(t,e)},a.referToSelf=U,a.convert=function(t,e){var r=s(e);if(r.test(t))return t;var n=r.conversionsTo;if(0===n.length)throw new Error("There are no conversions to "+e+" defined.");for(var i=0;i<n.length;i++){if(s(n[i].from).test(t))return n[i].convert(t)}throw new Error("Cannot convert "+t+" to "+e)},a.findSignature=p,a.find=function(t,e,r){return p(t,e,r).implementation},a.isTypedFunction=l,a.warnAgainstDeprecatedThis=!0,a.addType=function(t,e){var n="any";!1!==e&&r.has("Object")&&(n="Object"),a.addTypes([t],n)},a.addConversion=function(t){G(t);var e=s(t.to);if(!e.conversionsTo.every((function(e){return e.from!==t.from})))throw new Error('There is already a conversion from "'+t.from+'" to "'+e.name+'"');e.conversionsTo.push({from:t.from,convert:t.convert,index:u++})},a.addConversions=function(t){t.forEach(a.addConversion)},a.removeConversion=function(t){G(t);var e=s(t.to),r=function(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return t[r]}(e.conversionsTo,(function(e){return e.from===t.from}));if(!r)throw new Error("Attempt to remove nonexistent conversion from "+t.from+" to "+t.to);if(r.convert!==t.convert)throw new Error("Conversion to remove does not match existing conversion");var n=e.conversionsTo.indexOf(r);e.conversionsTo.splice(n,1)},a.resolve=function(t,e){if(!l(t))throw new TypeError(Sr);for(var r=t._typedFunctionData.signatures,n=0;n<r.length;++n)if(r[n].test(e))return r[n];return null},a}();function _r(t){return"boolean"==typeof t||!!isFinite(t)&&t===Math.round(t)}function Br(t,e,r){var n={2:"0b",8:"0o",16:"0x"}[e],i="";if(r){if(r<1)throw new Error("size must be in greater than 0");if(!_r(r))throw new Error("size must be an integer");if(t>2**(r-1)-1||t<-(2**(r-1)))throw new Error("Value must be in range [-2^".concat(r-1,", 2^").concat(r-1,"-1]"));if(!_r(t))throw new Error("Value must be an integer");t<0&&(t+=2**r),i="i".concat(r)}var o="";return t<0&&(t=-t,o="-"),"".concat(o).concat(n).concat(t.toString(e)).concat(i)}function zr(t,e){if("function"==typeof e)return e(t);if(t===1/0)return"Infinity";if(t===-1/0)return"-Infinity";if(isNaN(t))return"NaN";var r,n,i="auto";if(e&&(e.notation&&(i=e.notation),ze(e)?r=e:ze(e.precision)&&(r=e.precision),e.wordSize&&"number"!=typeof(n=e.wordSize)))throw new Error('Option "wordSize" must be a number');switch(i){case"fixed":return function(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=Tr(t),n="number"==typeof e?kr(r,r.exponent+1+e):r,i=n.coefficients,o=n.exponent+1,u=o+(e||0);i.length<u&&(i=i.concat(Ir(u-i.length)));o<0&&(i=Ir(1-o).concat(i),o=1);o<i.length&&i.splice(o,0,0===o?"0.":".");return n.sign+i.join("")}(t,r);case"exponential":return Or(t,r);case"engineering":return function(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=Tr(t),n=kr(r,e),i=n.exponent,o=n.coefficients,u=i%3==0?i:i<0?i-3-i%3:i-i%3;if(ze(e))for(;e>o.length||i-u+1>o.length;)o.push(0);else for(var a=Math.abs(i-u)-(o.length-1),s=0;s<a;s++)o.push(0);var f=Math.abs(i-u),h=1;for(;f>0;)h++,f--;var c=o.slice(h).join(""),l=ze(e)&&c.length||c.match(/[1-9]/)?"."+c:"",p=o.slice(0,h).join("")+l+"e"+(i>=0?"+":"")+u.toString();return n.sign+p}(t,r);case"bin":return Br(t,2,n);case"oct":return Br(t,8,n);case"hex":return Br(t,16,n);case"auto":return function(t,e,r){if(isNaN(t)||!isFinite(t))return String(t);var n=r&&void 0!==r.lowerExp?r.lowerExp:-3,i=r&&void 0!==r.upperExp?r.upperExp:5,o=Tr(t),u=e?kr(o,e):o;if(u.exponent<n||u.exponent>=i)return Or(t,e);var a=u.coefficients,s=u.exponent;a.length<e&&(a=a.concat(Ir(e-a.length))),a=a.concat(Ir(s-a.length+1+(a.length<e?e-a.length:0)));var f=s>0?s:0;return f<(a=Ir(-s).concat(a)).length-1&&a.splice(f+1,0,"."),u.sign+a.join("")}(t,r,e&&e).replace(/((\.\d*?)(0+))($|e)/,(function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e}));default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function Tr(t){var e=String(t).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number "+t);var r=e[1],n=e[2],i=parseFloat(e[4]||"0"),o=n.indexOf(".");i+=-1!==o?o-1:n.length-1;var u=n.replace(".","").replace(/^0*/,(function(t){return i-=t.length,""})).replace(/0*$/,"").split("").map((function(t){return parseInt(t)}));return 0===u.length&&(u.push(0),i++),{sign:r,coefficients:u,exponent:i}}function Or(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=Tr(t),n=e?kr(r,e):r,i=n.coefficients,o=n.exponent;i.length<e&&(i=i.concat(Ir(e-i.length)));var u=i.shift();return n.sign+u+(i.length>0?"."+i.join(""):"")+"e"+(o>=0?"+":"")+o}function kr(t,e){for(var r={sign:t.sign,coefficients:t.coefficients,exponent:t.exponent},n=r.coefficients;e<=0;)n.unshift(0),r.exponent++,e++;if(n.length>e&&n.splice(e,n.length-e)[0]>=5){var i=e-1;for(n[i]++;10===n[i];)n.pop(),0===i&&(n.unshift(0),r.exponent++,i++),n[--i]++}return r}function Ir(t){for(var e=[],r=0;r<t;r++)e.push(0);return e}var Rr=Number.EPSILON||2220446049250313e-31;function Pr(t,e,r){if(null==r)return t===e;if(t===e)return!0;if(isNaN(t)||isNaN(e))return!1;if(isFinite(t)&&isFinite(e)){var n=Math.abs(t-e);return n<Rr||n<=Math.max(Math.abs(t),Math.abs(e))*r}return!1}function jr(t,e,r){var n=new(0,t.constructor)(2),i="";if(r){if(r<1)throw new Error("size must be in greater than 0");if(!_r(r))throw new Error("size must be an integer");if(t.greaterThan(n.pow(r-1).sub(1))||t.lessThan(n.pow(r-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(r-1,", 2^").concat(r-1,"-1]"));if(!t.isInteger())throw new Error("Value must be an integer");t.lessThan(0)&&(t=t.add(n.pow(r))),i="i".concat(r)}switch(e){case 2:return"".concat(t.toBinary()).concat(i);case 8:return"".concat(t.toOctal()).concat(i);case 16:return"".concat(t.toHexadecimal()).concat(i);default:throw new Error("Base ".concat(e," not supported "))}}function qr(t,e){if("function"==typeof e)return e(t);if(!t.isFinite())return t.isNaN()?"NaN":t.gt(0)?"Infinity":"-Infinity";var r,n,i="auto";if(void 0!==e&&(e.notation&&(i=e.notation),"number"==typeof e?r=e:void 0!==e.precision&&(r=e.precision),e.wordSize&&"number"!=typeof(n=e.wordSize)))throw new Error('Option "wordSize" must be a number');switch(i){case"fixed":return function(t,e){return t.toFixed(e)}(t,r);case"exponential":return Vr(t,r);case"engineering":return function(t,e){var r=t.e,n=r%3==0?r:r<0?r-3-r%3:r-r%3,i=t.mul(Math.pow(10,-n)),o=i.toPrecision(e);if(-1!==o.indexOf("e")){o=new(0,t.constructor)(o).toFixed()}return o+"e"+(r>=0?"+":"")+n.toString()}(t,r);case"bin":return jr(t,2,n);case"oct":return jr(t,8,n);case"hex":return jr(t,16,n);case"auto":var o=e&&void 0!==e.lowerExp?e.lowerExp:-3,u=e&&void 0!==e.upperExp?e.upperExp:5;if(t.isZero())return"0";var a=t.toSignificantDigits(r),s=a.e;return(s>=o&&s<u?a.toFixed():Vr(t,r)).replace(/((\.\d*?)(0+))($|e)/,(function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e}));default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function Vr(t,e){return void 0!==e?t.toExponential(e-1):t.toExponential()}function Ur(t,e){var r=function(t,e){if("number"==typeof t)return zr(t,e);if(Te(t))return qr(t,e);if(function(t){return t&&"object"==typeof t&&"number"==typeof t.s&&"number"==typeof t.n&&"number"==typeof t.d||!1}(t))return e&&"decimal"===e.fraction?t.toString():t.s*t.n+"/"+t.d;if(Array.isArray(t))return Lr(t,e);if(Re(t))return'"'+t+'"';if("function"==typeof t)return t.syntax?String(t.syntax):"function";if(t&&"object"==typeof t){return"function"==typeof t.format?t.format(e):t&&t.toString(e)!=={}.toString()?t.toString(e):"{"+Object.keys(t).map((r=>'"'+r+'": '+Ur(t[r],e))).join(", ")+"}"}return String(t)}(t,e);return e&&"object"==typeof e&&"truncate"in e&&r.length>e.truncate?r.substring(0,e.truncate-3)+"...":r}function Lr(t,e){if(Array.isArray(t)){for(var r="[",n=t.length,i=0;i<n;i++)0!==i&&(r+=", "),r+=Lr(t[i],e);return r+="]"}return Ur(t,e)}function Zr(t,e,r){if(!(this instanceof Zr))throw new SyntaxError("Constructor must be called with the new operator");this.actual=t,this.expected=e,this.relation=r,this.message="Dimension mismatch ("+(Array.isArray(t)?"["+t.join(", ")+"]":t)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=(new Error).stack}function Xr(t,e,r){if(!(this instanceof Xr))throw new SyntaxError("Constructor must be called with the new operator");this.index=t,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=r),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}function $r(t){for(var e=[];Array.isArray(t);)e.push(t.length),t=t[0];return e}function Yr(t,e,r){var n,i=t.length;if(i!==e[r])throw new Zr(i,e[r]);if(r<e.length-1){var o=r+1;for(n=0;n<i;n++){var u=t[n];if(!Array.isArray(u))throw new Zr(e.length-1,e.length,"<");Yr(t[n],e,o)}}else for(n=0;n<i;n++)if(Array.isArray(t[n]))throw new Zr(e.length+1,e.length,">")}function Hr(t,e){if(0===e.length){if(Array.isArray(t))throw new Zr(t.length,0)}else Yr(t,e,0)}function Gr(t,e){if(!ze(t)||!_r(t))throw new TypeError("Index must be an integer (value: "+t+")");if(t<0||"number"==typeof e&&t>=e)throw new Xr(t,e)}function Jr(t,e,r){if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new Error("Resizing to scalar is not supported");return e.forEach((function(t){if(!ze(t)||!_r(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Ur(e)+")")})),Wr(t,e,0,void 0!==r?r:0),t}function Wr(t,e,r,n){var i,o,u=t.length,a=e[r],s=Math.min(u,a);if(t.length=a,r<e.length-1){var f=r+1;for(i=0;i<s;i++)o=t[i],Array.isArray(o)||(o=[o],t[i]=o),Wr(o,e,f,n);for(i=s;i<a;i++)o=[],t[i]=o,Wr(o,e,f,n)}else{for(i=0;i<s;i++)for(;Array.isArray(t[i]);)t[i]=t[i][0];for(i=s;i<a;i++)t[i]=n}}function Kr(t,e){var r=nn(t),n=r.length;if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new Zr(0,n,"!=");var i=tn(e=Qr(e,n));if(n!==i)throw new Zr(i,n,"!=");try{return function(t,e){for(var r,n=t,i=e.length-1;i>0;i--){var o=e[i];r=[];for(var u=n.length/o,a=0;a<u;a++)r.push(n.slice(a*o,(a+1)*o));n=r}return n}(r,e)}catch(t){if(t instanceof Zr)throw new Zr(i,n,"!=");throw t}}function Qr(t,e){var r=tn(t),n=t.slice(),i=t.indexOf(-1);if(t.indexOf(-1,i+1)>=0)throw new Error("More than one wildcard in sizes");if(i>=0){if(!(e%r==0))throw new Error("Could not replace wildcard, since "+e+" is no multiple of "+-r);n[i]=-e/r}return n}function tn(t){return t.reduce(((t,e)=>t*e),1)}function en(t,e,r,n){var i=n||$r(t);if(r)for(var o=0;o<r;o++)t=[t],i.unshift(1);for(t=rn(t,e,0);i.length<e;)i.push(1);return t}function rn(t,e,r){var n,i;if(Array.isArray(t)){var o=r+1;for(n=0,i=t.length;n<i;n++)t[n]=rn(t[n],e,o)}else for(var u=r;u<e;u++)t=[t];return t}function nn(t){if(!Array.isArray(t))return t;var e=[];return t.forEach((function t(r){Array.isArray(r)?r.forEach(t):e.push(r)})),e}function on(t,e){for(var r,n=0,i=0;i<t.length;i++){var o=t[i],u=Array.isArray(o);if(0===i&&u&&(n=o.length),u&&o.length!==n)return;var a=u?on(o,e):e(o);if(void 0===r)r=a;else if(r!==a)return"mixed"}return r}function un(t,e,r,n){function i(n){var i=function(t,e){for(var r={},n=0;n<e.length;n++){var i=e[n],o=t[i];void 0!==o&&(r[i]=o)}return r}(n,e.map(an));return function(t,e,r){var n=e.filter((t=>!function(t){return t&&"?"===t[0]}(t))).every((t=>void 0!==r[t]));if(!n){var i=e.filter((t=>void 0===r[t]));throw new Error('Cannot create function "'.concat(t,'", ')+"some dependencies are missing: ".concat(i.map((t=>'"'.concat(t,'"'))).join(", "),"."))}}(t,e,n),r(i)}return i.isFactory=!0,i.fn=t,i.dependencies=e.slice().sort(),n&&(i.meta=n),i}function an(t){return t&&"?"===t[0]?t.slice(1):t}function sn(t,e){if(hn(t)&&fn(t,e))return t[e];if("function"==typeof t[e]&&function(t,e){if(null==t||"function"!=typeof t[e])return!1;if(yr(t,e)&&Object.getPrototypeOf&&e in Object.getPrototypeOf(t))return!1;if(yr(ln,e))return!0;if(e in Object.prototype)return!1;if(e in Function.prototype)return!1;return!0}(t,e))throw new Error('Cannot access method "'+e+'" as a property');throw new Error('No access to property "'+e+'"')}function fn(t,e){return!(!t||"object"!=typeof t)&&(!!yr(cn,e)||!(e in Object.prototype)&&!(e in Function.prototype))}function hn(t){return"object"==typeof t&&t&&t.constructor===Object}Zr.prototype=new RangeError,Zr.prototype.constructor=RangeError,Zr.prototype.name="DimensionError",Zr.prototype.isDimensionError=!0,Xr.prototype=new RangeError,Xr.prototype.constructor=RangeError,Xr.prototype.name="IndexError",Xr.prototype.isIndexError=!0;var cn={length:!0,name:!0},ln={toString:!0,valueOf:!0,toLocaleString:!0};class pn{constructor(t){this.wrappedObject=t}keys(){return Object.keys(this.wrappedObject)}get(t){return sn(this.wrappedObject,t)}set(t,e){return function(t,e,r){if(hn(t)&&fn(t,e))return t[e]=r,r;throw new Error('No access to property "'+e+'"')}(this.wrappedObject,t,e),this}has(t){return e=this.wrappedObject,t in e;var e}}function mn(t){return!!t&&(t instanceof Map||t instanceof pn||"function"==typeof t.set&&"function"==typeof t.get&&"function"==typeof t.keys&&"function"==typeof t.has)}var dn=function(){return dn=Nr.create,Nr},gn=un("typed",["?BigNumber","?Complex","?DenseMatrix","?Fraction"],(function(t){var{BigNumber:e,Complex:r,DenseMatrix:n,Fraction:i}=t,o=dn();return o.clear(),o.addTypes([{name:"number",test:ze},{name:"Complex",test:Oe},{name:"BigNumber",test:Te},{name:"Fraction",test:ke},{name:"Unit",test:Ie},{name:"identifier",test:t=>Re&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(t)},{name:"string",test:Re},{name:"Chain",test:gr},{name:"Array",test:Pe},{name:"Matrix",test:je},{name:"DenseMatrix",test:Ve},{name:"SparseMatrix",test:Ue},{name:"Range",test:Le},{name:"Index",test:Ze},{name:"boolean",test:Xe},{name:"ResultSet",test:$e},{name:"Help",test:Ye},{name:"function",test:He},{name:"Date",test:Ge},{name:"RegExp",test:Je},{name:"null",test:Ke},{name:"undefined",test:Qe},{name:"AccessorNode",test:tr},{name:"ArrayNode",test:er},{name:"AssignmentNode",test:rr},{name:"BlockNode",test:nr},{name:"ConditionalNode",test:ir},{name:"ConstantNode",test:or},{name:"FunctionNode",test:ar},{name:"FunctionAssignmentNode",test:ur},{name:"IndexNode",test:sr},{name:"Node",test:fr},{name:"ObjectNode",test:hr},{name:"OperatorNode",test:cr},{name:"ParenthesisNode",test:lr},{name:"RangeNode",test:pr},{name:"RelationalNode",test:mr},{name:"SymbolNode",test:dr},{name:"Map",test:mn},{name:"Object",test:We}]),o.addConversions([{from:"number",to:"BigNumber",convert:function(t){if(e||wn(t),t.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+t+"). Use function bignumber(x) to convert to BigNumber.");return new e(t)}},{from:"number",to:"Complex",convert:function(t){return r||Dn(t),new r(t,0)}},{from:"BigNumber",to:"Complex",convert:function(t){return r||Dn(t),new r(t.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(t){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(t){return r||Dn(t),new r(t.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(t){i||vn(t);var e=new i(t);if(e.valueOf()!==t)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+t+"). Use function fraction(x) to convert to Fraction.");return e}},{from:"string",to:"number",convert:function(t){var e=Number(t);if(isNaN(e))throw new Error('Cannot convert "'+t+'" to a number');return e}},{from:"string",to:"BigNumber",convert:function(t){e||wn(t);try{return new e(t)}catch(e){throw new Error('Cannot convert "'+t+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(t){i||vn(t);try{return new i(t)}catch(e){throw new Error('Cannot convert "'+t+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(t){r||Dn(t);try{return new r(t)}catch(e){throw new Error('Cannot convert "'+t+'" to Complex')}}},{from:"boolean",to:"number",convert:function(t){return+t}},{from:"boolean",to:"BigNumber",convert:function(t){return e||wn(t),new e(+t)}},{from:"boolean",to:"Fraction",convert:function(t){return i||vn(t),new i(+t)}},{from:"boolean",to:"string",convert:function(t){return String(t)}},{from:"Array",to:"Matrix",convert:function(t){return n||function(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}(),new n(t)}},{from:"Matrix",to:"Array",convert:function(t){return t.valueOf()}}]),o.onMismatch=(t,e,r)=>{var n=o.createError(t,e,r);if(["wrongType","mismatch"].includes(n.data.category)&&1===e.length&&qe(e[0])&&r.some((t=>!t.params.includes(",")))){var i=new TypeError("Function '".concat(t,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(t,")'."));throw i.data=n.data,i}throw n},o.onMismatch=(t,e,r)=>{var n=o.createError(t,e,r);if(["wrongType","mismatch"].includes(n.data.category)&&1===e.length&&qe(e[0])&&r.some((t=>!t.params.includes(",")))){var i=new TypeError("Function '".concat(t,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(t,")'."));throw i.data=n.data,i}throw n},o}));function wn(t){throw new Error("Cannot convert value ".concat(t," into a BigNumber: no class 'BigNumber' provided"))}function Dn(t){throw new Error("Cannot convert value ".concat(t," into a Complex number: no class 'Complex' provided"))}function vn(t){throw new Error("Cannot convert value ".concat(t," into a Fraction, no class 'Fraction' provided."))}
/*!
 *  decimal.js v10.4.3
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var yn,En,xn=9e15,bn=1e9,An="0123456789abcdef",Fn="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Cn="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Mn={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-xn,maxE:xn,crypto:!1},Sn=!0,Nn="[DecimalError] ",_n=Nn+"Invalid argument: ",Bn=Nn+"Precision limit exceeded",zn=Nn+"crypto unavailable",Tn="[object Decimal]",On=Math.floor,kn=Math.pow,In=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Rn=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Pn=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,jn=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,qn=1e7,Vn=7,Un=Fn.length-1,Ln=Cn.length-1,Zn={toStringTag:Tn};function Xn(t){var e,r,n,i=t.length-1,o="",u=t[0];if(i>0){for(o+=u,e=1;e<i;e++)n=t[e]+"",(r=Vn-n.length)&&(o+=ri(r)),o+=n;u=t[e],(r=Vn-(n=u+"").length)&&(o+=ri(r))}else if(0===u)return"0";for(;u%10==0;)u/=10;return o+u}function $n(t,e,r){if(t!==~~t||t<e||t>r)throw Error(_n+t)}function Yn(t,e,r,n){var i,o,u,a;for(o=t[0];o>=10;o/=10)--e;return--e<0?(e+=Vn,i=0):(i=Math.ceil((e+1)/Vn),e%=Vn),o=kn(10,Vn-e),a=t[i]%o|0,null==n?e<3?(0==e?a=a/100|0:1==e&&(a=a/10|0),u=r<4&&99999==a||r>3&&49999==a||5e4==a||0==a):u=(r<4&&a+1==o||r>3&&a+1==o/2)&&(t[i+1]/o/100|0)==kn(10,e-2)-1||(a==o/2||0==a)&&0==(t[i+1]/o/100|0):e<4?(0==e?a=a/1e3|0:1==e?a=a/100|0:2==e&&(a=a/10|0),u=(n||r<4)&&9999==a||!n&&r>3&&4999==a):u=((n||r<4)&&a+1==o||!n&&r>3&&a+1==o/2)&&(t[i+1]/o/1e3|0)==kn(10,e-3)-1,u}function Hn(t,e,r){for(var n,i,o=[0],u=0,a=t.length;u<a;){for(i=o.length;i--;)o[i]*=e;for(o[0]+=An.indexOf(t.charAt(u++)),n=0;n<o.length;n++)o[n]>r-1&&(void 0===o[n+1]&&(o[n+1]=0),o[n+1]+=o[n]/r|0,o[n]%=r)}return o.reverse()}Zn.absoluteValue=Zn.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),Jn(t)},Zn.ceil=function(){return Jn(new this.constructor(this),this.e+1,2)},Zn.clampedTo=Zn.clamp=function(t,e){var r=this,n=r.constructor;if(t=new n(t),e=new n(e),!t.s||!e.s)return new n(NaN);if(t.gt(e))throw Error(_n+e);return r.cmp(t)<0?t:r.cmp(e)>0?e:new n(r)},Zn.comparedTo=Zn.cmp=function(t){var e,r,n,i,o=this,u=o.d,a=(t=new o.constructor(t)).d,s=o.s,f=t.s;if(!u||!a)return s&&f?s!==f?s:u===a?0:!u^s<0?1:-1:NaN;if(!u[0]||!a[0])return u[0]?s:a[0]?-f:0;if(s!==f)return s;if(o.e!==t.e)return o.e>t.e^s<0?1:-1;for(e=0,r=(n=u.length)<(i=a.length)?n:i;e<r;++e)if(u[e]!==a[e])return u[e]>a[e]^s<0?1:-1;return n===i?0:n>i^s<0?1:-1},Zn.cosine=Zn.cos=function(){var t,e,r=this,n=r.constructor;return r.d?r.d[0]?(t=n.precision,e=n.rounding,n.precision=t+Math.max(r.e,r.sd())+Vn,n.rounding=1,r=function(t,e){var r,n,i;if(e.isZero())return e;n=e.d.length,n<32?i=(1/li(4,r=Math.ceil(n/3))).toString():(r=16,i="2.3283064365386962890625e-10");t.precision+=r,e=ci(t,1,e.times(i),new t(1));for(var o=r;o--;){var u=e.times(e);e=u.times(u).minus(u).times(8).plus(1)}return t.precision-=r,e}(n,pi(n,r)),n.precision=t,n.rounding=e,Jn(2==En||3==En?r.neg():r,t,e,!0)):new n(1):new n(NaN)},Zn.cubeRoot=Zn.cbrt=function(){var t,e,r,n,i,o,u,a,s,f,h=this,c=h.constructor;if(!h.isFinite()||h.isZero())return new c(h);for(Sn=!1,(o=h.s*kn(h.s*h,1/3))&&Math.abs(o)!=1/0?n=new c(o.toString()):(r=Xn(h.d),(o=((t=h.e)-r.length+1)%3)&&(r+=1==o||-2==o?"0":"00"),o=kn(r,1/3),t=On((t+1)/3)-(t%3==(t<0?-1:2)),(n=new c(r=o==1/0?"5e"+t:(r=o.toExponential()).slice(0,r.indexOf("e")+1)+t)).s=h.s),u=(t=c.precision)+3;;)if(f=(s=(a=n).times(a).times(a)).plus(h),n=Gn(f.plus(h).times(a),f.plus(s),u+2,1),Xn(a.d).slice(0,u)===(r=Xn(n.d)).slice(0,u)){if("9999"!=(r=r.slice(u-3,u+1))&&(i||"4999"!=r)){+r&&(+r.slice(1)||"5"!=r.charAt(0))||(Jn(n,t+1,1),e=!n.times(n).times(n).eq(h));break}if(!i&&(Jn(a,t+1,0),a.times(a).times(a).eq(h))){n=a;break}u+=4,i=1}return Sn=!0,Jn(n,t,c.rounding,e)},Zn.decimalPlaces=Zn.dp=function(){var t,e=this.d,r=NaN;if(e){if(r=((t=e.length-1)-On(this.e/Vn))*Vn,t=e[t])for(;t%10==0;t/=10)r--;r<0&&(r=0)}return r},Zn.dividedBy=Zn.div=function(t){return Gn(this,new this.constructor(t))},Zn.dividedToIntegerBy=Zn.divToInt=function(t){var e=this.constructor;return Jn(Gn(this,new e(t),0,1,1),e.precision,e.rounding)},Zn.equals=Zn.eq=function(t){return 0===this.cmp(t)},Zn.floor=function(){return Jn(new this.constructor(this),this.e+1,3)},Zn.greaterThan=Zn.gt=function(t){return this.cmp(t)>0},Zn.greaterThanOrEqualTo=Zn.gte=function(t){var e=this.cmp(t);return 1==e||0===e},Zn.hyperbolicCosine=Zn.cosh=function(){var t,e,r,n,i,o=this,u=o.constructor,a=new u(1);if(!o.isFinite())return new u(o.s?1/0:NaN);if(o.isZero())return a;r=u.precision,n=u.rounding,u.precision=r+Math.max(o.e,o.sd())+4,u.rounding=1,(i=o.d.length)<32?e=(1/li(4,t=Math.ceil(i/3))).toString():(t=16,e="2.3283064365386962890625e-10"),o=ci(u,1,o.times(e),new u(1),!0);for(var s,f=t,h=new u(8);f--;)s=o.times(o),o=a.minus(s.times(h.minus(s.times(h))));return Jn(o,u.precision=r,u.rounding=n,!0)},Zn.hyperbolicSine=Zn.sinh=function(){var t,e,r,n,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(e=o.precision,r=o.rounding,o.precision=e+Math.max(i.e,i.sd())+4,o.rounding=1,(n=i.d.length)<3)i=ci(o,2,i,i,!0);else{t=(t=1.4*Math.sqrt(n))>16?16:0|t,i=ci(o,2,i=i.times(1/li(5,t)),i,!0);for(var u,a=new o(5),s=new o(16),f=new o(20);t--;)u=i.times(i),i=i.times(a.plus(u.times(s.times(u).plus(f))))}return o.precision=e,o.rounding=r,Jn(i,e,r,!0)},Zn.hyperbolicTangent=Zn.tanh=function(){var t,e,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(t=n.precision,e=n.rounding,n.precision=t+7,n.rounding=1,Gn(r.sinh(),r.cosh(),n.precision=t,n.rounding=e)):new n(r.s)},Zn.inverseCosine=Zn.acos=function(){var t,e=this,r=e.constructor,n=e.abs().cmp(1),i=r.precision,o=r.rounding;return-1!==n?0===n?e.isNeg()?ti(r,i,o):new r(0):new r(NaN):e.isZero()?ti(r,i+4,o).times(.5):(r.precision=i+6,r.rounding=1,e=e.asin(),t=ti(r,i+4,o).times(.5),r.precision=i,r.rounding=o,t.minus(e))},Zn.inverseHyperbolicCosine=Zn.acosh=function(){var t,e,r=this,n=r.constructor;return r.lte(1)?new n(r.eq(1)?0:NaN):r.isFinite()?(t=n.precision,e=n.rounding,n.precision=t+Math.max(Math.abs(r.e),r.sd())+4,n.rounding=1,Sn=!1,r=r.times(r).minus(1).sqrt().plus(r),Sn=!0,n.precision=t,n.rounding=e,r.ln()):new n(r)},Zn.inverseHyperbolicSine=Zn.asinh=function(){var t,e,r=this,n=r.constructor;return!r.isFinite()||r.isZero()?new n(r):(t=n.precision,e=n.rounding,n.precision=t+2*Math.max(Math.abs(r.e),r.sd())+6,n.rounding=1,Sn=!1,r=r.times(r).plus(1).sqrt().plus(r),Sn=!0,n.precision=t,n.rounding=e,r.ln())},Zn.inverseHyperbolicTangent=Zn.atanh=function(){var t,e,r,n,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=o.precision,e=o.rounding,n=i.sd(),Math.max(n,t)<2*-i.e-1?Jn(new o(i),t,e,!0):(o.precision=r=n-i.e,i=Gn(i.plus(1),new o(1).minus(i),r+t,1),o.precision=t+4,o.rounding=1,i=i.ln(),o.precision=t,o.rounding=e,i.times(.5))):new o(NaN)},Zn.inverseSine=Zn.asin=function(){var t,e,r,n,i=this,o=i.constructor;return i.isZero()?new o(i):(e=i.abs().cmp(1),r=o.precision,n=o.rounding,-1!==e?0===e?((t=ti(o,r+4,n).times(.5)).s=i.s,t):new o(NaN):(o.precision=r+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=r,o.rounding=n,i.times(2)))},Zn.inverseTangent=Zn.atan=function(){var t,e,r,n,i,o,u,a,s,f=this,h=f.constructor,c=h.precision,l=h.rounding;if(f.isFinite()){if(f.isZero())return new h(f);if(f.abs().eq(1)&&c+4<=Ln)return(u=ti(h,c+4,l).times(.25)).s=f.s,u}else{if(!f.s)return new h(NaN);if(c+4<=Ln)return(u=ti(h,c+4,l).times(.5)).s=f.s,u}for(h.precision=a=c+10,h.rounding=1,t=r=Math.min(28,a/Vn+2|0);t;--t)f=f.div(f.times(f).plus(1).sqrt().plus(1));for(Sn=!1,e=Math.ceil(a/Vn),n=1,s=f.times(f),u=new h(f),i=f;-1!==t;)if(i=i.times(s),o=u.minus(i.div(n+=2)),i=i.times(s),void 0!==(u=o.plus(i.div(n+=2))).d[e])for(t=e;u.d[t]===o.d[t]&&t--;);return r&&(u=u.times(2<<r-1)),Sn=!0,Jn(u,h.precision=c,h.rounding=l,!0)},Zn.isFinite=function(){return!!this.d},Zn.isInteger=Zn.isInt=function(){return!!this.d&&On(this.e/Vn)>this.d.length-2},Zn.isNaN=function(){return!this.s},Zn.isNegative=Zn.isNeg=function(){return this.s<0},Zn.isPositive=Zn.isPos=function(){return this.s>0},Zn.isZero=function(){return!!this.d&&0===this.d[0]},Zn.lessThan=Zn.lt=function(t){return this.cmp(t)<0},Zn.lessThanOrEqualTo=Zn.lte=function(t){return this.cmp(t)<1},Zn.logarithm=Zn.log=function(t){var e,r,n,i,o,u,a,s,f=this,h=f.constructor,c=h.precision,l=h.rounding;if(null==t)t=new h(10),e=!0;else{if(r=(t=new h(t)).d,t.s<0||!r||!r[0]||t.eq(1))return new h(NaN);e=t.eq(10)}if(r=f.d,f.s<0||!r||!r[0]||f.eq(1))return new h(r&&!r[0]?-1/0:1!=f.s?NaN:r?0:1/0);if(e)if(r.length>1)o=!0;else{for(i=r[0];i%10==0;)i/=10;o=1!==i}if(Sn=!1,u=ai(f,a=c+5),n=e?Qn(h,a+10):ai(t,a),Yn((s=Gn(u,n,a,1)).d,i=c,l))do{if(u=ai(f,a+=10),n=e?Qn(h,a+10):ai(t,a),s=Gn(u,n,a,1),!o){+Xn(s.d).slice(i+1,i+15)+1==1e14&&(s=Jn(s,c+1,0));break}}while(Yn(s.d,i+=10,l));return Sn=!0,Jn(s,c,l)},Zn.minus=Zn.sub=function(t){var e,r,n,i,o,u,a,s,f,h,c,l,p=this,m=p.constructor;if(t=new m(t),!p.d||!t.d)return p.s&&t.s?p.d?t.s=-t.s:t=new m(t.d||p.s!==t.s?p:NaN):t=new m(NaN),t;if(p.s!=t.s)return t.s=-t.s,p.plus(t);if(f=p.d,l=t.d,a=m.precision,s=m.rounding,!f[0]||!l[0]){if(l[0])t.s=-t.s;else{if(!f[0])return new m(3===s?-0:0);t=new m(p)}return Sn?Jn(t,a,s):t}if(r=On(t.e/Vn),h=On(p.e/Vn),f=f.slice(),o=h-r){for((c=o<0)?(e=f,o=-o,u=l.length):(e=l,r=h,u=f.length),o>(n=Math.max(Math.ceil(a/Vn),u)+2)&&(o=n,e.length=1),e.reverse(),n=o;n--;)e.push(0);e.reverse()}else{for((c=(n=f.length)<(u=l.length))&&(u=n),n=0;n<u;n++)if(f[n]!=l[n]){c=f[n]<l[n];break}o=0}for(c&&(e=f,f=l,l=e,t.s=-t.s),u=f.length,n=l.length-u;n>0;--n)f[u++]=0;for(n=l.length;n>o;){if(f[--n]<l[n]){for(i=n;i&&0===f[--i];)f[i]=qn-1;--f[i],f[n]+=qn}f[n]-=l[n]}for(;0===f[--u];)f.pop();for(;0===f[0];f.shift())--r;return f[0]?(t.d=f,t.e=Kn(f,r),Sn?Jn(t,a,s):t):new m(3===s?-0:0)},Zn.modulo=Zn.mod=function(t){var e,r=this,n=r.constructor;return t=new n(t),!r.d||!t.s||t.d&&!t.d[0]?new n(NaN):!t.d||r.d&&!r.d[0]?Jn(new n(r),n.precision,n.rounding):(Sn=!1,9==n.modulo?(e=Gn(r,t.abs(),0,3,1)).s*=t.s:e=Gn(r,t,0,n.modulo,1),e=e.times(t),Sn=!0,r.minus(e))},Zn.naturalExponential=Zn.exp=function(){return ui(this)},Zn.naturalLogarithm=Zn.ln=function(){return ai(this)},Zn.negated=Zn.neg=function(){var t=new this.constructor(this);return t.s=-t.s,Jn(t)},Zn.plus=Zn.add=function(t){var e,r,n,i,o,u,a,s,f,h,c=this,l=c.constructor;if(t=new l(t),!c.d||!t.d)return c.s&&t.s?c.d||(t=new l(t.d||c.s===t.s?c:NaN)):t=new l(NaN),t;if(c.s!=t.s)return t.s=-t.s,c.minus(t);if(f=c.d,h=t.d,a=l.precision,s=l.rounding,!f[0]||!h[0])return h[0]||(t=new l(c)),Sn?Jn(t,a,s):t;if(o=On(c.e/Vn),n=On(t.e/Vn),f=f.slice(),i=o-n){for(i<0?(r=f,i=-i,u=h.length):(r=h,n=o,u=f.length),i>(u=(o=Math.ceil(a/Vn))>u?o+1:u+1)&&(i=u,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for((u=f.length)-(i=h.length)<0&&(i=u,r=h,h=f,f=r),e=0;i;)e=(f[--i]=f[i]+h[i]+e)/qn|0,f[i]%=qn;for(e&&(f.unshift(e),++n),u=f.length;0==f[--u];)f.pop();return t.d=f,t.e=Kn(f,n),Sn?Jn(t,a,s):t},Zn.precision=Zn.sd=function(t){var e,r=this;if(void 0!==t&&t!==!!t&&1!==t&&0!==t)throw Error(_n+t);return r.d?(e=ei(r.d),t&&r.e+1>e&&(e=r.e+1)):e=NaN,e},Zn.round=function(){var t=this,e=t.constructor;return Jn(new e(t),t.e+1,e.rounding)},Zn.sine=Zn.sin=function(){var t,e,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(t=n.precision,e=n.rounding,n.precision=t+Math.max(r.e,r.sd())+Vn,n.rounding=1,r=function(t,e){var r,n=e.d.length;if(n<3)return e.isZero()?e:ci(t,2,e,e);r=(r=1.4*Math.sqrt(n))>16?16:0|r,e=e.times(1/li(5,r)),e=ci(t,2,e,e);for(var i,o=new t(5),u=new t(16),a=new t(20);r--;)i=e.times(e),e=e.times(o.plus(i.times(u.times(i).minus(a))));return e}(n,pi(n,r)),n.precision=t,n.rounding=e,Jn(En>2?r.neg():r,t,e,!0)):new n(NaN)},Zn.squareRoot=Zn.sqrt=function(){var t,e,r,n,i,o,u=this,a=u.d,s=u.e,f=u.s,h=u.constructor;if(1!==f||!a||!a[0])return new h(!f||f<0&&(!a||a[0])?NaN:a?u:1/0);for(Sn=!1,0==(f=Math.sqrt(+u))||f==1/0?(((e=Xn(a)).length+s)%2==0&&(e+="0"),f=Math.sqrt(e),s=On((s+1)/2)-(s<0||s%2),n=new h(e=f==1/0?"5e"+s:(e=f.toExponential()).slice(0,e.indexOf("e")+1)+s)):n=new h(f.toString()),r=(s=h.precision)+3;;)if(n=(o=n).plus(Gn(u,o,r+2,1)).times(.5),Xn(o.d).slice(0,r)===(e=Xn(n.d)).slice(0,r)){if("9999"!=(e=e.slice(r-3,r+1))&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(Jn(n,s+1,1),t=!n.times(n).eq(u));break}if(!i&&(Jn(o,s+1,0),o.times(o).eq(u))){n=o;break}r+=4,i=1}return Sn=!0,Jn(n,s,h.rounding,t)},Zn.tangent=Zn.tan=function(){var t,e,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(t=n.precision,e=n.rounding,n.precision=t+10,n.rounding=1,(r=r.sin()).s=1,r=Gn(r,new n(1).minus(r.times(r)).sqrt(),t+10,0),n.precision=t,n.rounding=e,Jn(2==En||4==En?r.neg():r,t,e,!0)):new n(NaN)},Zn.times=Zn.mul=function(t){var e,r,n,i,o,u,a,s,f,h=this,c=h.constructor,l=h.d,p=(t=new c(t)).d;if(t.s*=h.s,!(l&&l[0]&&p&&p[0]))return new c(!t.s||l&&!l[0]&&!p||p&&!p[0]&&!l?NaN:l&&p?0*t.s:t.s/0);for(r=On(h.e/Vn)+On(t.e/Vn),(s=l.length)<(f=p.length)&&(o=l,l=p,p=o,u=s,s=f,f=u),o=[],n=u=s+f;n--;)o.push(0);for(n=f;--n>=0;){for(e=0,i=s+n;i>n;)a=o[i]+p[n]*l[i-n-1]+e,o[i--]=a%qn|0,e=a/qn|0;o[i]=(o[i]+e)%qn|0}for(;!o[--u];)o.pop();return e?++r:o.shift(),t.d=o,t.e=Kn(o,r),Sn?Jn(t,c.precision,c.rounding):t},Zn.toBinary=function(t,e){return mi(this,2,t,e)},Zn.toDecimalPlaces=Zn.toDP=function(t,e){var r=this,n=r.constructor;return r=new n(r),void 0===t?r:($n(t,0,bn),void 0===e?e=n.rounding:$n(e,0,8),Jn(r,t+r.e+1,e))},Zn.toExponential=function(t,e){var r,n=this,i=n.constructor;return void 0===t?r=Wn(n,!0):($n(t,0,bn),void 0===e?e=i.rounding:$n(e,0,8),r=Wn(n=Jn(new i(n),t+1,e),!0,t+1)),n.isNeg()&&!n.isZero()?"-"+r:r},Zn.toFixed=function(t,e){var r,n,i=this,o=i.constructor;return void 0===t?r=Wn(i):($n(t,0,bn),void 0===e?e=o.rounding:$n(e,0,8),r=Wn(n=Jn(new o(i),t+i.e+1,e),!1,t+n.e+1)),i.isNeg()&&!i.isZero()?"-"+r:r},Zn.toFraction=function(t){var e,r,n,i,o,u,a,s,f,h,c,l,p=this,m=p.d,d=p.constructor;if(!m)return new d(p);if(f=r=new d(1),n=s=new d(0),u=(o=(e=new d(n)).e=ei(m)-p.e-1)%Vn,e.d[0]=kn(10,u<0?Vn+u:u),null==t)t=o>0?e:f;else{if(!(a=new d(t)).isInt()||a.lt(f))throw Error(_n+a);t=a.gt(e)?o>0?e:f:a}for(Sn=!1,a=new d(Xn(m)),h=d.precision,d.precision=o=m.length*Vn*2;c=Gn(a,e,0,1,1),1!=(i=r.plus(c.times(n))).cmp(t);)r=n,n=i,i=f,f=s.plus(c.times(i)),s=i,i=e,e=a.minus(c.times(i)),a=i;return i=Gn(t.minus(r),n,0,1,1),s=s.plus(i.times(f)),r=r.plus(i.times(n)),s.s=f.s=p.s,l=Gn(f,n,o,1).minus(p).abs().cmp(Gn(s,r,o,1).minus(p).abs())<1?[f,n]:[s,r],d.precision=h,Sn=!0,l},Zn.toHexadecimal=Zn.toHex=function(t,e){return mi(this,16,t,e)},Zn.toNearest=function(t,e){var r=this,n=r.constructor;if(r=new n(r),null==t){if(!r.d)return r;t=new n(1),e=n.rounding}else{if(t=new n(t),void 0===e?e=n.rounding:$n(e,0,8),!r.d)return t.s?r:t;if(!t.d)return t.s&&(t.s=r.s),t}return t.d[0]?(Sn=!1,r=Gn(r,t,0,e,1).times(t),Sn=!0,Jn(r)):(t.s=r.s,r=t),r},Zn.toNumber=function(){return+this},Zn.toOctal=function(t,e){return mi(this,8,t,e)},Zn.toPower=Zn.pow=function(t){var e,r,n,i,o,u,a=this,s=a.constructor,f=+(t=new s(t));if(!(a.d&&t.d&&a.d[0]&&t.d[0]))return new s(kn(+a,f));if((a=new s(a)).eq(1))return a;if(n=s.precision,o=s.rounding,t.eq(1))return Jn(a,n,o);if((e=On(t.e/Vn))>=t.d.length-1&&(r=f<0?-f:f)<=9007199254740991)return i=ni(s,a,r,n),t.s<0?new s(1).div(i):Jn(i,n,o);if((u=a.s)<0){if(e<t.d.length-1)return new s(NaN);if(0==(1&t.d[e])&&(u=1),0==a.e&&1==a.d[0]&&1==a.d.length)return a.s=u,a}return(e=0!=(r=kn(+a,f))&&isFinite(r)?new s(r+"").e:On(f*(Math.log("0."+Xn(a.d))/Math.LN10+a.e+1)))>s.maxE+1||e<s.minE-1?new s(e>0?u/0:0):(Sn=!1,s.rounding=a.s=1,r=Math.min(12,(e+"").length),(i=ui(t.times(ai(a,n+r)),n)).d&&Yn((i=Jn(i,n+5,1)).d,n,o)&&(e=n+10,+Xn((i=Jn(ui(t.times(ai(a,e+r)),e),e+5,1)).d).slice(n+1,n+15)+1==1e14&&(i=Jn(i,n+1,0))),i.s=u,Sn=!0,s.rounding=o,Jn(i,n,o))},Zn.toPrecision=function(t,e){var r,n=this,i=n.constructor;return void 0===t?r=Wn(n,n.e<=i.toExpNeg||n.e>=i.toExpPos):($n(t,1,bn),void 0===e?e=i.rounding:$n(e,0,8),r=Wn(n=Jn(new i(n),t,e),t<=n.e||n.e<=i.toExpNeg,t)),n.isNeg()&&!n.isZero()?"-"+r:r},Zn.toSignificantDigits=Zn.toSD=function(t,e){var r=this.constructor;return void 0===t?(t=r.precision,e=r.rounding):($n(t,1,bn),void 0===e?e=r.rounding:$n(e,0,8)),Jn(new r(this),t,e)},Zn.toString=function(){var t=this,e=t.constructor,r=Wn(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+r:r},Zn.truncated=Zn.trunc=function(){return Jn(new this.constructor(this),this.e+1,1)},Zn.valueOf=Zn.toJSON=function(){var t=this,e=t.constructor,r=Wn(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+r:r};var Gn=function(){function t(t,e,r){var n,i=0,o=t.length;for(t=t.slice();o--;)n=t[o]*e+i,t[o]=n%r|0,i=n/r|0;return i&&t.unshift(i),t}function e(t,e,r,n){var i,o;if(r!=n)o=r>n?1:-1;else for(i=o=0;i<r;i++)if(t[i]!=e[i]){o=t[i]>e[i]?1:-1;break}return o}function r(t,e,r,n){for(var i=0;r--;)t[r]-=i,i=t[r]<e[r]?1:0,t[r]=i*n+t[r]-e[r];for(;!t[0]&&t.length>1;)t.shift()}return function(n,i,o,u,a,s){var f,h,c,l,p,m,d,g,w,D,v,y,E,x,b,A,F,C,M,S,N=n.constructor,_=n.s==i.s?1:-1,B=n.d,z=i.d;if(!(B&&B[0]&&z&&z[0]))return new N(n.s&&i.s&&(B?!z||B[0]!=z[0]:z)?B&&0==B[0]||!z?0*_:_/0:NaN);for(s?(p=1,h=n.e-i.e):(s=qn,p=Vn,h=On(n.e/p)-On(i.e/p)),M=z.length,F=B.length,D=(w=new N(_)).d=[],c=0;z[c]==(B[c]||0);c++);if(z[c]>(B[c]||0)&&h--,null==o?(x=o=N.precision,u=N.rounding):x=a?o+(n.e-i.e)+1:o,x<0)D.push(1),m=!0;else{if(x=x/p+2|0,c=0,1==M){for(l=0,z=z[0],x++;(c<F||l)&&x--;c++)b=l*s+(B[c]||0),D[c]=b/z|0,l=b%z|0;m=l||c<F}else{for((l=s/(z[0]+1)|0)>1&&(z=t(z,l,s),B=t(B,l,s),M=z.length,F=B.length),A=M,y=(v=B.slice(0,M)).length;y<M;)v[y++]=0;(S=z.slice()).unshift(0),C=z[0],z[1]>=s/2&&++C;do{l=0,(f=e(z,v,M,y))<0?(E=v[0],M!=y&&(E=E*s+(v[1]||0)),(l=E/C|0)>1?(l>=s&&(l=s-1),1==(f=e(d=t(z,l,s),v,g=d.length,y=v.length))&&(l--,r(d,M<g?S:z,g,s))):(0==l&&(f=l=1),d=z.slice()),(g=d.length)<y&&d.unshift(0),r(v,d,y,s),-1==f&&(f=e(z,v,M,y=v.length))<1&&(l++,r(v,M<y?S:z,y,s)),y=v.length):0===f&&(l++,v=[0]),D[c++]=l,f&&v[0]?v[y++]=B[A]||0:(v=[B[A]],y=1)}while((A++<F||void 0!==v[0])&&x--);m=void 0!==v[0]}D[0]||D.shift()}if(1==p)w.e=h,yn=m;else{for(c=1,l=D[0];l>=10;l/=10)c++;w.e=c+h*p-1,Jn(w,a?o+w.e+1:o,u,m)}return w}}();function Jn(t,e,r,n){var i,o,u,a,s,f,h,c,l,p=t.constructor;t:if(null!=e){if(!(c=t.d))return t;for(i=1,a=c[0];a>=10;a/=10)i++;if((o=e-i)<0)o+=Vn,u=e,s=(h=c[l=0])/kn(10,i-u-1)%10|0;else if((l=Math.ceil((o+1)/Vn))>=(a=c.length)){if(!n)break t;for(;a++<=l;)c.push(0);h=s=0,i=1,u=(o%=Vn)-Vn+1}else{for(h=a=c[l],i=1;a>=10;a/=10)i++;s=(u=(o%=Vn)-Vn+i)<0?0:h/kn(10,i-u-1)%10|0}if(n=n||e<0||void 0!==c[l+1]||(u<0?h:h%kn(10,i-u-1)),f=r<4?(s||n)&&(0==r||r==(t.s<0?3:2)):s>5||5==s&&(4==r||n||6==r&&(o>0?u>0?h/kn(10,i-u):0:c[l-1])%10&1||r==(t.s<0?8:7)),e<1||!c[0])return c.length=0,f?(e-=t.e+1,c[0]=kn(10,(Vn-e%Vn)%Vn),t.e=-e||0):c[0]=t.e=0,t;if(0==o?(c.length=l,a=1,l--):(c.length=l+1,a=kn(10,Vn-o),c[l]=u>0?(h/kn(10,i-u)%kn(10,u)|0)*a:0),f)for(;;){if(0==l){for(o=1,u=c[0];u>=10;u/=10)o++;for(u=c[0]+=a,a=1;u>=10;u/=10)a++;o!=a&&(t.e++,c[0]==qn&&(c[0]=1));break}if(c[l]+=a,c[l]!=qn)break;c[l--]=0,a=1}for(o=c.length;0===c[--o];)c.pop()}return Sn&&(t.e>p.maxE?(t.d=null,t.e=NaN):t.e<p.minE&&(t.e=0,t.d=[0])),t}function Wn(t,e,r){if(!t.isFinite())return si(t);var n,i=t.e,o=Xn(t.d),u=o.length;return e?(r&&(n=r-u)>0?o=o.charAt(0)+"."+o.slice(1)+ri(n):u>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(t.e<0?"e":"e+")+t.e):i<0?(o="0."+ri(-i-1)+o,r&&(n=r-u)>0&&(o+=ri(n))):i>=u?(o+=ri(i+1-u),r&&(n=r-i-1)>0&&(o=o+"."+ri(n))):((n=i+1)<u&&(o=o.slice(0,n)+"."+o.slice(n)),r&&(n=r-u)>0&&(i+1===u&&(o+="."),o+=ri(n))),o}function Kn(t,e){var r=t[0];for(e*=Vn;r>=10;r/=10)e++;return e}function Qn(t,e,r){if(e>Un)throw Sn=!0,r&&(t.precision=r),Error(Bn);return Jn(new t(Fn),e,1,!0)}function ti(t,e,r){if(e>Ln)throw Error(Bn);return Jn(new t(Cn),e,r,!0)}function ei(t){var e=t.length-1,r=e*Vn+1;if(e=t[e]){for(;e%10==0;e/=10)r--;for(e=t[0];e>=10;e/=10)r++}return r}function ri(t){for(var e="";t--;)e+="0";return e}function ni(t,e,r,n){var i,o=new t(1),u=Math.ceil(n/Vn+4);for(Sn=!1;;){if(r%2&&di((o=o.times(e)).d,u)&&(i=!0),0===(r=On(r/2))){r=o.d.length-1,i&&0===o.d[r]&&++o.d[r];break}di((e=e.times(e)).d,u)}return Sn=!0,o}function ii(t){return 1&t.d[t.d.length-1]}function oi(t,e,r){for(var n,i=new t(e[0]),o=0;++o<e.length;){if(!(n=new t(e[o])).s){i=n;break}i[r](n)&&(i=n)}return i}function ui(t,e){var r,n,i,o,u,a,s,f=0,h=0,c=0,l=t.constructor,p=l.rounding,m=l.precision;if(!t.d||!t.d[0]||t.e>17)return new l(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(null==e?(Sn=!1,s=m):s=e,a=new l(.03125);t.e>-2;)t=t.times(a),c+=5;for(s+=n=Math.log(kn(2,c))/Math.LN10*2+5|0,r=o=u=new l(1),l.precision=s;;){if(o=Jn(o.times(t),s,1),r=r.times(++h),Xn((a=u.plus(Gn(o,r,s,1))).d).slice(0,s)===Xn(u.d).slice(0,s)){for(i=c;i--;)u=Jn(u.times(u),s,1);if(null!=e)return l.precision=m,u;if(!(f<3&&Yn(u.d,s-n,p,f)))return Jn(u,l.precision=m,p,Sn=!0);l.precision=s+=10,r=o=a=new l(1),h=0,f++}u=a}}function ai(t,e){var r,n,i,o,u,a,s,f,h,c,l,p=1,m=t,d=m.d,g=m.constructor,w=g.rounding,D=g.precision;if(m.s<0||!d||!d[0]||!m.e&&1==d[0]&&1==d.length)return new g(d&&!d[0]?-1/0:1!=m.s?NaN:d?0:m);if(null==e?(Sn=!1,h=D):h=e,g.precision=h+=10,n=(r=Xn(d)).charAt(0),!(Math.abs(o=m.e)<15e14))return f=Qn(g,h+2,D).times(o+""),m=ai(new g(n+"."+r.slice(1)),h-10).plus(f),g.precision=D,null==e?Jn(m,D,w,Sn=!0):m;for(;n<7&&1!=n||1==n&&r.charAt(1)>3;)n=(r=Xn((m=m.times(t)).d)).charAt(0),p++;for(o=m.e,n>1?(m=new g("0."+r),o++):m=new g(n+"."+r.slice(1)),c=m,s=u=m=Gn(m.minus(1),m.plus(1),h,1),l=Jn(m.times(m),h,1),i=3;;){if(u=Jn(u.times(l),h,1),Xn((f=s.plus(Gn(u,new g(i),h,1))).d).slice(0,h)===Xn(s.d).slice(0,h)){if(s=s.times(2),0!==o&&(s=s.plus(Qn(g,h+2,D).times(o+""))),s=Gn(s,new g(p),h,1),null!=e)return g.precision=D,s;if(!Yn(s.d,h-10,w,a))return Jn(s,g.precision=D,w,Sn=!0);g.precision=h+=10,f=u=m=Gn(c.minus(1),c.plus(1),h,1),l=Jn(m.times(m),h,1),i=a=1}s=f,i+=2}}function si(t){return String(t.s*t.s/0)}function fi(t,e){var r,n,i;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;48===e.charCodeAt(n);n++);for(i=e.length;48===e.charCodeAt(i-1);--i);if(e=e.slice(n,i)){if(i-=n,t.e=r=r-n-1,t.d=[],n=(r+1)%Vn,r<0&&(n+=Vn),n<i){for(n&&t.d.push(+e.slice(0,n)),i-=Vn;n<i;)t.d.push(+e.slice(n,n+=Vn));e=e.slice(n),n=Vn-e.length}else n-=i;for(;n--;)e+="0";t.d.push(+e),Sn&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function hi(t,e){var r,n,i,o,u,a,s,f,h;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),jn.test(e))return fi(t,e)}else if("Infinity"===e||"NaN"===e)return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(Rn.test(e))r=16,e=e.toLowerCase();else if(In.test(e))r=2;else{if(!Pn.test(e))throw Error(_n+e);r=8}for((o=e.search(/p/i))>0?(s=+e.slice(o+1),e=e.substring(2,o)):e=e.slice(2),u=(o=e.indexOf("."))>=0,n=t.constructor,u&&(o=(a=(e=e.replace(".","")).length)-o,i=ni(n,new n(r),o,2*o)),o=h=(f=Hn(e,r,qn)).length-1;0===f[o];--o)f.pop();return o<0?new n(0*t.s):(t.e=Kn(f,h),t.d=f,Sn=!1,u&&(t=Gn(t,i,4*a)),s&&(t=t.times(Math.abs(s)<54?kn(2,s):ro.pow(2,s))),Sn=!0,t)}function ci(t,e,r,n,i){var o,u,a,s,f=t.precision,h=Math.ceil(f/Vn);for(Sn=!1,s=r.times(r),a=new t(n);;){if(u=Gn(a.times(s),new t(e++*e++),f,1),a=i?n.plus(u):n.minus(u),n=Gn(u.times(s),new t(e++*e++),f,1),void 0!==(u=a.plus(n)).d[h]){for(o=h;u.d[o]===a.d[o]&&o--;);if(-1==o)break}o=a,a=n,n=u,u=o}return Sn=!0,u.d.length=h+1,u}function li(t,e){for(var r=t;--e;)r*=t;return r}function pi(t,e){var r,n=e.s<0,i=ti(t,t.precision,1),o=i.times(.5);if((e=e.abs()).lte(o))return En=n?4:1,e;if((r=e.divToInt(i)).isZero())En=n?3:2;else{if((e=e.minus(r.times(i))).lte(o))return En=ii(r)?n?2:3:n?4:1,e;En=ii(r)?n?1:4:n?3:2}return e.minus(i).abs()}function mi(t,e,r,n){var i,o,u,a,s,f,h,c,l,p=t.constructor,m=void 0!==r;if(m?($n(r,1,bn),void 0===n?n=p.rounding:$n(n,0,8)):(r=p.precision,n=p.rounding),t.isFinite()){for(m?(i=2,16==e?r=4*r-3:8==e&&(r=3*r-2)):i=e,(u=(h=Wn(t)).indexOf("."))>=0&&(h=h.replace(".",""),(l=new p(1)).e=h.length-u,l.d=Hn(Wn(l),10,i),l.e=l.d.length),o=s=(c=Hn(h,10,i)).length;0==c[--s];)c.pop();if(c[0]){if(u<0?o--:((t=new p(t)).d=c,t.e=o,c=(t=Gn(t,l,r,n,0,i)).d,o=t.e,f=yn),u=c[r],a=i/2,f=f||void 0!==c[r+1],f=n<4?(void 0!==u||f)&&(0===n||n===(t.s<0?3:2)):u>a||u===a&&(4===n||f||6===n&&1&c[r-1]||n===(t.s<0?8:7)),c.length=r,f)for(;++c[--r]>i-1;)c[r]=0,r||(++o,c.unshift(1));for(s=c.length;!c[s-1];--s);for(u=0,h="";u<s;u++)h+=An.charAt(c[u]);if(m){if(s>1)if(16==e||8==e){for(u=16==e?4:3,--s;s%u;s++)h+="0";for(s=(c=Hn(h,i,e)).length;!c[s-1];--s);for(u=1,h="1.";u<s;u++)h+=An.charAt(c[u])}else h=h.charAt(0)+"."+h.slice(1);h=h+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)h="0"+h;h="0."+h}else if(++o>s)for(o-=s;o--;)h+="0";else o<s&&(h=h.slice(0,o)+"."+h.slice(o))}else h=m?"0p+0":"0";h=(16==e?"0x":2==e?"0b":8==e?"0o":"")+h}else h=si(t);return t.s<0?"-"+h:h}function di(t,e){if(t.length>e)return t.length=e,!0}function gi(t){return new this(t).abs()}function wi(t){return new this(t).acos()}function Di(t){return new this(t).acosh()}function vi(t,e){return new this(t).plus(e)}function yi(t){return new this(t).asin()}function Ei(t){return new this(t).asinh()}function xi(t){return new this(t).atan()}function bi(t){return new this(t).atanh()}function Ai(t,e){t=new this(t),e=new this(e);var r,n=this.precision,i=this.rounding,o=n+4;return t.s&&e.s?t.d||e.d?!e.d||t.isZero()?(r=e.s<0?ti(this,n,i):new this(0)).s=t.s:!t.d||e.isZero()?(r=ti(this,o,1).times(.5)).s=t.s:e.s<0?(this.precision=o,this.rounding=1,r=this.atan(Gn(t,e,o,1)),e=ti(this,o,1),this.precision=n,this.rounding=i,r=t.s<0?r.minus(e):r.plus(e)):r=this.atan(Gn(t,e,o,1)):(r=ti(this,o,1).times(e.s>0?.25:.75)).s=t.s:r=new this(NaN),r}function Fi(t){return new this(t).cbrt()}function Ci(t){return Jn(t=new this(t),t.e+1,2)}function Mi(t,e,r){return new this(t).clamp(e,r)}function Si(t){if(!t||"object"!=typeof t)throw Error(Nn+"Object expected");var e,r,n,i=!0===t.defaults,o=["precision",1,bn,"rounding",0,8,"toExpNeg",-xn,0,"toExpPos",0,xn,"maxE",0,xn,"minE",-xn,0,"modulo",0,9];for(e=0;e<o.length;e+=3)if(r=o[e],i&&(this[r]=Mn[r]),void 0!==(n=t[r])){if(!(On(n)===n&&n>=o[e+1]&&n<=o[e+2]))throw Error(_n+r+": "+n);this[r]=n}if(r="crypto",i&&(this[r]=Mn[r]),void 0!==(n=t[r])){if(!0!==n&&!1!==n&&0!==n&&1!==n)throw Error(_n+r+": "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(zn);this[r]=!0}else this[r]=!1}return this}function Ni(t){return new this(t).cos()}function _i(t){return new this(t).cosh()}function Bi(t,e){return new this(t).div(e)}function zi(t){return new this(t).exp()}function Ti(t){return Jn(t=new this(t),t.e+1,3)}function Oi(){var t,e,r=new this(0);for(Sn=!1,t=0;t<arguments.length;)if((e=new this(arguments[t++])).d)r.d&&(r=r.plus(e.times(e)));else{if(e.s)return Sn=!0,new this(1/0);r=e}return Sn=!0,r.sqrt()}function ki(t){return t instanceof ro||t&&t.toStringTag===Tn||!1}function Ii(t){return new this(t).ln()}function Ri(t,e){return new this(t).log(e)}function Pi(t){return new this(t).log(2)}function ji(t){return new this(t).log(10)}function qi(){return oi(this,arguments,"lt")}function Vi(){return oi(this,arguments,"gt")}function Ui(t,e){return new this(t).mod(e)}function Li(t,e){return new this(t).mul(e)}function Zi(t,e){return new this(t).pow(e)}function Xi(t){var e,r,n,i,o=0,u=new this(1),a=[];if(void 0===t?t=this.precision:$n(t,1,bn),n=Math.ceil(t/Vn),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(n));o<n;)(i=e[o])>=429e7?e[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=i%1e7;else{if(!crypto.randomBytes)throw Error(zn);for(e=crypto.randomBytes(n*=4);o<n;)(i=e[o]+(e[o+1]<<8)+(e[o+2]<<16)+((127&e[o+3])<<24))>=214e7?crypto.randomBytes(4).copy(e,o):(a.push(i%1e7),o+=4);o=n/4}else for(;o<n;)a[o++]=1e7*Math.random()|0;for(n=a[--o],t%=Vn,n&&t&&(i=kn(10,Vn-t),a[o]=(n/i|0)*i);0===a[o];o--)a.pop();if(o<0)r=0,a=[0];else{for(r=-1;0===a[0];r-=Vn)a.shift();for(n=1,i=a[0];i>=10;i/=10)n++;n<Vn&&(r-=Vn-n)}return u.e=r,u.d=a,u}function $i(t){return Jn(t=new this(t),t.e+1,this.rounding)}function Yi(t){return(t=new this(t)).d?t.d[0]?t.s:0*t.s:t.s||NaN}function Hi(t){return new this(t).sin()}function Gi(t){return new this(t).sinh()}function Ji(t){return new this(t).sqrt()}function Wi(t,e){return new this(t).sub(e)}function Ki(){var t=0,e=arguments,r=new this(e[t]);for(Sn=!1;r.s&&++t<e.length;)r=r.plus(e[t]);return Sn=!0,Jn(r,this.precision,this.rounding)}function Qi(t){return new this(t).tan()}function to(t){return new this(t).tanh()}function eo(t){return Jn(t=new this(t),t.e+1,1)}Zn[Symbol.for("nodejs.util.inspect.custom")]=Zn.toString,Zn[Symbol.toStringTag]="Decimal";var ro=Zn.constructor=function t(e){var r,n,i;function o(t){var e,r,n,i=this;if(!(i instanceof o))return new o(t);if(i.constructor=o,ki(t))return i.s=t.s,void(Sn?!t.d||t.e>o.maxE?(i.e=NaN,i.d=null):t.e<o.minE?(i.e=0,i.d=[0]):(i.e=t.e,i.d=t.d.slice()):(i.e=t.e,i.d=t.d?t.d.slice():t.d));if("number"===(n=typeof t)){if(0===t)return i.s=1/t<0?-1:1,i.e=0,void(i.d=[0]);if(t<0?(t=-t,i.s=-1):i.s=1,t===~~t&&t<1e7){for(e=0,r=t;r>=10;r/=10)e++;return void(Sn?e>o.maxE?(i.e=NaN,i.d=null):e<o.minE?(i.e=0,i.d=[0]):(i.e=e,i.d=[t]):(i.e=e,i.d=[t]))}return 0*t!=0?(t||(i.s=NaN),i.e=NaN,void(i.d=null)):fi(i,t.toString())}if("string"!==n)throw Error(_n+t);return 45===(r=t.charCodeAt(0))?(t=t.slice(1),i.s=-1):(43===r&&(t=t.slice(1)),i.s=1),jn.test(t)?fi(i,t):hi(i,t)}if(o.prototype=Zn,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.EUCLID=9,o.config=o.set=Si,o.clone=t,o.isDecimal=ki,o.abs=gi,o.acos=wi,o.acosh=Di,o.add=vi,o.asin=yi,o.asinh=Ei,o.atan=xi,o.atanh=bi,o.atan2=Ai,o.cbrt=Fi,o.ceil=Ci,o.clamp=Mi,o.cos=Ni,o.cosh=_i,o.div=Bi,o.exp=zi,o.floor=Ti,o.hypot=Oi,o.ln=Ii,o.log=Ri,o.log10=ji,o.log2=Pi,o.max=qi,o.min=Vi,o.mod=Ui,o.mul=Li,o.pow=Zi,o.random=Xi,o.round=$i,o.sign=Yi,o.sin=Hi,o.sinh=Gi,o.sqrt=Ji,o.sub=Wi,o.sum=Ki,o.tan=Qi,o.tanh=to,o.trunc=eo,void 0===e&&(e={}),e&&!0!==e.defaults)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],r=0;r<i.length;)e.hasOwnProperty(n=i[r++])||(e[n]=this[n]);return o.config(e),o}(Mn);Fn=new ro(Fn),Cn=new ro(Cn);var no=un("BigNumber",["?on","config"],(t=>{var{on:e,config:r}=t,n=ro.clone({precision:r.precision,modulo:ro.EUCLID});return n.prototype=Object.create(n.prototype),n.prototype.type="BigNumber",n.prototype.isBigNumber=!0,n.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},n.fromJSON=function(t){return new n(t.value)},e&&e("config",(function(t,e){t.precision!==e.precision&&n.config({precision:t.precision})})),n}),{isClass:!0}),io={exports:{}};
/**
 * @license Complex.js v2.1.1 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
!function(t,e){!function(e){var r=Math.cosh||function(t){return Math.abs(t)<1e-9?1-t:.5*(Math.exp(t)+Math.exp(-t))},n=Math.sinh||function(t){return Math.abs(t)<1e-9?t:.5*(Math.exp(t)-Math.exp(-t))},i=function(){throw SyntaxError("Invalid Param")};function o(t,e){var r=Math.abs(t),n=Math.abs(e);return 0===t?Math.log(n):0===e?Math.log(r):r<3e3&&n<3e3?.5*Math.log(t*t+e*e):(t/=2,e/=2,.5*Math.log(t*t+e*e)+Math.LN2)}function u(t,e){if(!(this instanceof u))return new u(t,e);var r=function(t,e){var r={re:0,im:0};if(null==t)r.re=r.im=0;else if(void 0!==e)r.re=t,r.im=e;else switch(typeof t){case"object":if("im"in t&&"re"in t)r.re=t.re,r.im=t.im;else if("abs"in t&&"arg"in t){if(!Number.isFinite(t.abs)&&Number.isFinite(t.arg))return u.INFINITY;r.re=t.abs*Math.cos(t.arg),r.im=t.abs*Math.sin(t.arg)}else if("r"in t&&"phi"in t){if(!Number.isFinite(t.r)&&Number.isFinite(t.phi))return u.INFINITY;r.re=t.r*Math.cos(t.phi),r.im=t.r*Math.sin(t.phi)}else 2===t.length?(r.re=t[0],r.im=t[1]):i();break;case"string":r.im=r.re=0;var n=t.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),o=1,a=0;null===n&&i();for(var s=0;s<n.length;s++){var f=n[s];" "===f||"\t"===f||"\n"===f||("+"===f?o++:"-"===f?a++:"i"===f||"I"===f?(o+a===0&&i()," "===n[s+1]||isNaN(n[s+1])?r.im+=parseFloat((a%2?"-":"")+"1"):(r.im+=parseFloat((a%2?"-":"")+n[s+1]),s++),o=a=0):((o+a===0||isNaN(f))&&i(),"i"===n[s+1]||"I"===n[s+1]?(r.im+=parseFloat((a%2?"-":"")+f),s++):r.re+=parseFloat((a%2?"-":"")+f),o=a=0))}o+a>0&&i();break;case"number":r.im=0,r.re=t;break;default:i()}return isNaN(r.re)||isNaN(r.im),r}(t,e);this.re=r.re,this.im=r.im}u.prototype={re:0,im:0,sign:function(){var t=this.abs();return new u(this.re/t,this.im/t)},add:function(t,e){var r=new u(t,e);return this.isInfinite()&&r.isInfinite()?u.NAN:this.isInfinite()||r.isInfinite()?u.INFINITY:new u(this.re+r.re,this.im+r.im)},sub:function(t,e){var r=new u(t,e);return this.isInfinite()&&r.isInfinite()?u.NAN:this.isInfinite()||r.isInfinite()?u.INFINITY:new u(this.re-r.re,this.im-r.im)},mul:function(t,e){var r=new u(t,e);return this.isInfinite()&&r.isZero()||this.isZero()&&r.isInfinite()?u.NAN:this.isInfinite()||r.isInfinite()?u.INFINITY:0===r.im&&0===this.im?new u(this.re*r.re,0):new u(this.re*r.re-this.im*r.im,this.re*r.im+this.im*r.re)},div:function(t,e){var r=new u(t,e);if(this.isZero()&&r.isZero()||this.isInfinite()&&r.isInfinite())return u.NAN;if(this.isInfinite()||r.isZero())return u.INFINITY;if(this.isZero()||r.isInfinite())return u.ZERO;t=this.re,e=this.im;var n,i,o=r.re,a=r.im;return 0===a?new u(t/o,e/o):Math.abs(o)<Math.abs(a)?new u((t*(i=o/a)+e)/(n=o*i+a),(e*i-t)/n):new u((t+e*(i=a/o))/(n=a*i+o),(e-t*i)/n)},pow:function(t,e){var r=new u(t,e);if(t=this.re,e=this.im,r.isZero())return u.ONE;if(0===r.im){if(0===e&&t>0)return new u(Math.pow(t,r.re),0);if(0===t)switch((r.re%4+4)%4){case 0:return new u(Math.pow(e,r.re),0);case 1:return new u(0,Math.pow(e,r.re));case 2:return new u(-Math.pow(e,r.re),0);case 3:return new u(0,-Math.pow(e,r.re))}}if(0===t&&0===e&&r.re>0&&r.im>=0)return u.ZERO;var n=Math.atan2(e,t),i=o(t,e);return t=Math.exp(r.re*i-r.im*n),e=r.im*i+r.re*n,new u(t*Math.cos(e),t*Math.sin(e))},sqrt:function(){var t,e,r=this.re,n=this.im,i=this.abs();if(r>=0){if(0===n)return new u(Math.sqrt(r),0);t=.5*Math.sqrt(2*(i+r))}else t=Math.abs(n)/Math.sqrt(2*(i-r));return e=r<=0?.5*Math.sqrt(2*(i-r)):Math.abs(n)/Math.sqrt(2*(i+r)),new u(t,n<0?-e:e)},exp:function(){var t=Math.exp(this.re);return this.im,new u(t*Math.cos(this.im),t*Math.sin(this.im))},expm1:function(){var t=this.re,e=this.im;return new u(Math.expm1(t)*Math.cos(e)+function(t){var e=Math.PI/4;if(-e>t||t>e)return Math.cos(t)-1;var r=t*t;return r*(r*(r*(r*(r*(r*(r*(r/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)}(e),Math.exp(t)*Math.sin(e))},log:function(){var t=this.re,e=this.im;return new u(o(t,e),Math.atan2(e,t))},abs:function(){return t=this.re,e=this.im,r=Math.abs(t),n=Math.abs(e),r<3e3&&n<3e3?Math.sqrt(r*r+n*n):(r<n?(r=n,n=t/e):n=e/t,r*Math.sqrt(1+n*n));var t,e,r,n},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var t=this.re,e=this.im;return new u(Math.sin(t)*r(e),Math.cos(t)*n(e))},cos:function(){var t=this.re,e=this.im;return new u(Math.cos(t)*r(e),-Math.sin(t)*n(e))},tan:function(){var t=2*this.re,e=2*this.im,i=Math.cos(t)+r(e);return new u(Math.sin(t)/i,n(e)/i)},cot:function(){var t=2*this.re,e=2*this.im,i=Math.cos(t)-r(e);return new u(-Math.sin(t)/i,n(e)/i)},sec:function(){var t=this.re,e=this.im,i=.5*r(2*e)+.5*Math.cos(2*t);return new u(Math.cos(t)*r(e)/i,Math.sin(t)*n(e)/i)},csc:function(){var t=this.re,e=this.im,i=.5*r(2*e)-.5*Math.cos(2*t);return new u(Math.sin(t)*r(e)/i,-Math.cos(t)*n(e)/i)},asin:function(){var t=this.re,e=this.im,r=new u(e*e-t*t+1,-2*t*e).sqrt(),n=new u(r.re-e,r.im+t).log();return new u(n.im,-n.re)},acos:function(){var t=this.re,e=this.im,r=new u(e*e-t*t+1,-2*t*e).sqrt(),n=new u(r.re-e,r.im+t).log();return new u(Math.PI/2-n.im,n.re)},atan:function(){var t=this.re,e=this.im;if(0===t){if(1===e)return new u(0,1/0);if(-1===e)return new u(0,-1/0)}var r=t*t+(1-e)*(1-e),n=new u((1-e*e-t*t)/r,-2*t/r).log();return new u(-.5*n.im,.5*n.re)},acot:function(){var t=this.re,e=this.im;if(0===e)return new u(Math.atan2(1,t),0);var r=t*t+e*e;return 0!==r?new u(t/r,-e/r).atan():new u(0!==t?t/0:0,0!==e?-e/0:0).atan()},asec:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new u(0,1/0);var r=t*t+e*e;return 0!==r?new u(t/r,-e/r).acos():new u(0!==t?t/0:0,0!==e?-e/0:0).acos()},acsc:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new u(Math.PI/2,1/0);var r=t*t+e*e;return 0!==r?new u(t/r,-e/r).asin():new u(0!==t?t/0:0,0!==e?-e/0:0).asin()},sinh:function(){var t=this.re,e=this.im;return new u(n(t)*Math.cos(e),r(t)*Math.sin(e))},cosh:function(){var t=this.re,e=this.im;return new u(r(t)*Math.cos(e),n(t)*Math.sin(e))},tanh:function(){var t=2*this.re,e=2*this.im,i=r(t)+Math.cos(e);return new u(n(t)/i,Math.sin(e)/i)},coth:function(){var t=2*this.re,e=2*this.im,i=r(t)-Math.cos(e);return new u(n(t)/i,-Math.sin(e)/i)},csch:function(){var t=this.re,e=this.im,i=Math.cos(2*e)-r(2*t);return new u(-2*n(t)*Math.cos(e)/i,2*r(t)*Math.sin(e)/i)},sech:function(){var t=this.re,e=this.im,i=Math.cos(2*e)+r(2*t);return new u(2*r(t)*Math.cos(e)/i,-2*n(t)*Math.sin(e)/i)},asinh:function(){var t=this.im;this.im=-this.re,this.re=t;var e=this.asin();return this.re=-this.im,this.im=t,t=e.re,e.re=-e.im,e.im=t,e},acosh:function(){var t=this.acos();if(t.im<=0){var e=t.re;t.re=-t.im,t.im=e}else{e=t.im;t.im=-t.re,t.re=e}return t},atanh:function(){var t=this.re,e=this.im,r=t>1&&0===e,n=1-t,i=1+t,a=n*n+e*e,s=0!==a?new u((i*n-e*e)/a,(e*n+i*e)/a):new u(-1!==t?t/0:0,0!==e?e/0:0),f=s.re;return s.re=o(s.re,s.im)/2,s.im=Math.atan2(s.im,f)/2,r&&(s.im=-s.im),s},acoth:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new u(0,Math.PI/2);var r=t*t+e*e;return 0!==r?new u(t/r,-e/r).atanh():new u(0!==t?t/0:0,0!==e?-e/0:0).atanh()},acsch:function(){var t=this.re,e=this.im;if(0===e)return new u(0!==t?Math.log(t+Math.sqrt(t*t+1)):1/0,0);var r=t*t+e*e;return 0!==r?new u(t/r,-e/r).asinh():new u(0!==t?t/0:0,0!==e?-e/0:0).asinh()},asech:function(){var t=this.re,e=this.im;if(this.isZero())return u.INFINITY;var r=t*t+e*e;return 0!==r?new u(t/r,-e/r).acosh():new u(0!==t?t/0:0,0!==e?-e/0:0).acosh()},inverse:function(){if(this.isZero())return u.INFINITY;if(this.isInfinite())return u.ZERO;var t=this.re,e=this.im,r=t*t+e*e;return new u(t/r,-e/r)},conjugate:function(){return new u(this.re,-this.im)},neg:function(){return new u(-this.re,-this.im)},ceil:function(t){return t=Math.pow(10,t||0),new u(Math.ceil(this.re*t)/t,Math.ceil(this.im*t)/t)},floor:function(t){return t=Math.pow(10,t||0),new u(Math.floor(this.re*t)/t,Math.floor(this.im*t)/t)},round:function(t){return t=Math.pow(10,t||0),new u(Math.round(this.re*t)/t,Math.round(this.im*t)/t)},equals:function(t,e){var r=new u(t,e);return Math.abs(r.re-this.re)<=u.EPSILON&&Math.abs(r.im-this.im)<=u.EPSILON},clone:function(){return new u(this.re,this.im)},toString:function(){var t=this.re,e=this.im,r="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(t)<u.EPSILON&&(t=0),Math.abs(e)<u.EPSILON&&(e=0),0===e?r+t:(0!==t?(r+=t,r+=" ",e<0?(e=-e,r+="-"):r+="+",r+=" "):e<0&&(e=-e,r+="-"),1!==e&&(r+=e),r+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return 0===this.im&&0===this.re},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},u.ZERO=new u(0,0),u.ONE=new u(1,0),u.I=new u(0,1),u.PI=new u(Math.PI,0),u.E=new u(Math.E,0),u.INFINITY=new u(1/0,1/0),u.NAN=new u(NaN,NaN),u.EPSILON=1e-15,Object.defineProperty(u,"__esModule",{value:!0}),u.default=u,u.Complex=u,t.exports=u}()}(io);var oo=it(io.exports),uo=un("Complex",[],(()=>(Object.defineProperty(oo,"name",{value:"Complex"}),oo.prototype.constructor=oo,oo.prototype.type="Complex",oo.prototype.isComplex=!0,oo.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},oo.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},oo.prototype.format=function(t){var e=this.im,r=this.re,n=zr(this.re,t),i=zr(this.im,t),o=ze(t)?t:t?t.precision:null;if(null!==o){var u=Math.pow(10,-o);Math.abs(r/e)<u&&(r=0),Math.abs(e/r)<u&&(e=0)}return 0===e?n:0===r?1===e?"i":-1===e?"-i":i+"i":e<0?-1===e?n+" - i":n+" - "+i.substring(1)+"i":1===e?n+" + i":n+" + "+i+"i"},oo.fromPolar=function(t){switch(arguments.length){case 1:var e=arguments[0];if("object"==typeof e)return oo(e);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var r=arguments[0],n=arguments[1];if(ze(r)){if(Ie(n)&&n.hasBase("ANGLE")&&(n=n.toNumber("rad")),ze(n))return new oo({r:r,phi:n});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},oo.prototype.valueOf=oo.prototype.toString,oo.fromJSON=function(t){return new oo(t)},oo.compare=function(t,e){return t.re>e.re?1:t.re<e.re?-1:t.im>e.im?1:t.im<e.im?-1:0},oo)),{isClass:!0}),ao={exports:{}};
/**
 * @license Fraction.js v4.2.0 05/03/2022
 * https://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2021, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
!function(t,e){!function(e){var r={s:1,n:0,d:1};function n(t,e){if(isNaN(t=parseInt(t,10)))throw s.InvalidParameter;return t*e}function i(t,e){if(0===e)throw s.DivisionByZero;var r=Object.create(s.prototype);r.s=t<0?-1:1;var n=a(t=t<0?-t:t,e);return r.n=t/n,r.d=e/n,r}function o(t){for(var e={},r=t,n=2,i=4;i<=r;){for(;r%n==0;)r/=n,e[n]=(e[n]||0)+1;i+=1+2*n++}return r!==t?r>1&&(e[r]=(e[r]||0)+1):e[t]=(e[t]||0)+1,e}var u=function(t,e){var i,o=0,u=1,a=1,f=0,h=0,c=0,l=1,p=1,m=0,d=1,g=1,w=1,D=1e7;if(null==t);else if(void 0!==e){if(a=(o=t)*(u=e),o%1!=0||u%1!=0)throw s.NonIntegerParameter}else switch(typeof t){case"object":if("d"in t&&"n"in t)o=t.n,u=t.d,"s"in t&&(o*=t.s);else{if(!(0 in t))throw s.InvalidParameter;o=t[0],1 in t&&(u=t[1])}a=o*u;break;case"number":if(t<0&&(a=t,t=-t),t%1==0)o=t;else if(t>0){for(t>=1&&(t/=p=Math.pow(10,Math.floor(1+Math.log(t)/Math.LN10)));d<=D&&w<=D;){if(t===(i=(m+g)/(d+w))){d+w<=D?(o=m+g,u=d+w):w>d?(o=g,u=w):(o=m,u=d);break}t>i?(m+=g,d+=w):(g+=m,w+=d),d>D?(o=g,u=w):(o=m,u=d)}o*=p}else(isNaN(t)||isNaN(e))&&(u=o=NaN);break;case"string":if(null===(d=t.match(/\d+|./g)))throw s.InvalidParameter;if("-"===d[m]?(a=-1,m++):"+"===d[m]&&m++,d.length===m+1?h=n(d[m++],a):"."===d[m+1]||"."===d[m]?("."!==d[m]&&(f=n(d[m++],a)),(++m+1===d.length||"("===d[m+1]&&")"===d[m+3]||"'"===d[m+1]&&"'"===d[m+3])&&(h=n(d[m],a),l=Math.pow(10,d[m].length),m++),("("===d[m]&&")"===d[m+2]||"'"===d[m]&&"'"===d[m+2])&&(c=n(d[m+1],a),p=Math.pow(10,d[m+1].length)-1,m+=3)):"/"===d[m+1]||":"===d[m+1]?(h=n(d[m],a),l=n(d[m+2],1),m+=3):"/"===d[m+3]&&" "===d[m+1]&&(f=n(d[m],a),h=n(d[m+2],a),l=n(d[m+4],1),m+=5),d.length<=m){a=o=c+(u=l*p)*f+p*h;break}default:throw s.InvalidParameter}if(0===u)throw s.DivisionByZero;r.s=a<0?-1:1,r.n=Math.abs(o),r.d=Math.abs(u)};function a(t,e){if(!t)return e;if(!e)return t;for(;;){if(!(t%=e))return e;if(!(e%=t))return t}}function s(t,e){if(u(t,e),!(this instanceof s))return i(r.s*r.n,r.d);t=a(r.d,r.n),this.s=r.s,this.n=r.n/t,this.d=r.d/t}s.DivisionByZero=new Error("Division by Zero"),s.InvalidParameter=new Error("Invalid argument"),s.NonIntegerParameter=new Error("Parameters must be integer"),s.prototype={s:1,n:0,d:1,abs:function(){return i(this.n,this.d)},neg:function(){return i(-this.s*this.n,this.d)},add:function(t,e){return u(t,e),i(this.s*this.n*r.d+r.s*this.d*r.n,this.d*r.d)},sub:function(t,e){return u(t,e),i(this.s*this.n*r.d-r.s*this.d*r.n,this.d*r.d)},mul:function(t,e){return u(t,e),i(this.s*r.s*this.n*r.n,this.d*r.d)},div:function(t,e){return u(t,e),i(this.s*r.s*this.n*r.d,this.d*r.n)},clone:function(){return i(this.s*this.n,this.d)},mod:function(t,e){if(isNaN(this.n)||isNaN(this.d))return new s(NaN);if(void 0===t)return i(this.s*this.n%this.d,1);if(u(t,e),0===r.n&&0===this.d)throw s.DivisionByZero;return i(this.s*(r.d*this.n)%(r.n*this.d),r.d*this.d)},gcd:function(t,e){return u(t,e),i(a(r.n,this.n)*a(r.d,this.d),r.d*this.d)},lcm:function(t,e){return u(t,e),0===r.n&&0===this.n?i(0,1):i(r.n*this.n,a(r.n,this.n)*a(r.d,this.d))},ceil:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new s(NaN):i(Math.ceil(t*this.s*this.n/this.d),t)},floor:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new s(NaN):i(Math.floor(t*this.s*this.n/this.d),t)},round:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new s(NaN):i(Math.round(t*this.s*this.n/this.d),t)},inverse:function(){return i(this.s*this.d,this.n)},pow:function(t,e){if(u(t,e),1===r.d)return r.s<0?i(Math.pow(this.s*this.d,r.n),Math.pow(this.n,r.n)):i(Math.pow(this.s*this.n,r.n),Math.pow(this.d,r.n));if(this.s<0)return null;var n=o(this.n),a=o(this.d),s=1,f=1;for(var h in n)if("1"!==h){if("0"===h){s=0;break}if(n[h]*=r.n,n[h]%r.d!=0)return null;n[h]/=r.d,s*=Math.pow(h,n[h])}for(var h in a)if("1"!==h){if(a[h]*=r.n,a[h]%r.d!=0)return null;a[h]/=r.d,f*=Math.pow(h,a[h])}return r.s<0?i(f,s):i(s,f)},equals:function(t,e){return u(t,e),this.s*this.n*r.d==r.s*r.n*this.d},compare:function(t,e){u(t,e);var n=this.s*this.n*r.d-r.s*r.n*this.d;return(0<n)-(n<0)},simplify:function(t){if(isNaN(this.n)||isNaN(this.d))return this;t=t||.001;for(var e=this.abs(),r=e.toContinued(),n=1;n<r.length;n++){for(var o=i(r[n-1],1),u=n-2;u>=0;u--)o=o.inverse().add(r[u]);if(o.sub(e).abs().valueOf()<t)return o.mul(this.s)}return this},divisible:function(t,e){return u(t,e),!(!(r.n*this.d)||this.n*r.d%(r.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(t){var e,r="",n=this.n,i=this.d;return this.s<0&&(r+="-"),1===i?r+=n:(t&&(e=Math.floor(n/i))>0&&(r+=e,r+=" ",n%=i),r+=n,r+="/",r+=i),r},toLatex:function(t){var e,r="",n=this.n,i=this.d;return this.s<0&&(r+="-"),1===i?r+=n:(t&&(e=Math.floor(n/i))>0&&(r+=e,n%=i),r+="\\frac{",r+=n,r+="}{",r+=i,r+="}"),r},toContinued:function(){var t,e=this.n,r=this.d,n=[];if(isNaN(e)||isNaN(r))return n;do{n.push(Math.floor(e/r)),t=e%r,e=r,r=t}while(1!==e);return n},toString:function(t){var e=this.n,r=this.d;if(isNaN(e)||isNaN(r))return"NaN";t=t||15;var n=function(t,e){for(;e%2==0;e/=2);for(;e%5==0;e/=5);if(1===e)return 0;for(var r=10%e,n=1;1!==r;n++)if(r=10*r%e,n>2e3)return 0;return n}(0,r),i=function(t,e,r){for(var n=1,i=function(t,e,r){for(var n=1;e>0;t=t*t%r,e>>=1)1&e&&(n=n*t%r);return n}(10,r,e),o=0;o<300;o++){if(n===i)return o;n=10*n%e,i=10*i%e}return 0}(0,r,n),o=this.s<0?"-":"";if(o+=e/r|0,e%=r,(e*=10)&&(o+="."),n){for(var u=i;u--;)o+=e/r|0,e%=r,e*=10;o+="(";for(u=n;u--;)o+=e/r|0,e%=r,e*=10;o+=")"}else for(u=t;e&&u--;)o+=e/r|0,e%=r,e*=10;return o}},Object.defineProperty(s,"__esModule",{value:!0}),s.default=s,s.Fraction=s,t.exports=s}()}(ao);var so=it(ao.exports),fo=un("Fraction",[],(()=>(Object.defineProperty(so,"name",{value:"Fraction"}),so.prototype.constructor=so,so.prototype.type="Fraction",so.prototype.isFraction=!0,so.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},so.fromJSON=function(t){return new so(t)},so)),{isClass:!0}),ho=un("Matrix",[],(()=>{function t(){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator")}return t.prototype.type="Matrix",t.prototype.isMatrix=!0,t.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},t.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},t.prototype.create=function(t,e){throw new Error("Cannot invoke create on a Matrix interface")},t.prototype.subset=function(t,e,r){throw new Error("Cannot invoke subset on a Matrix interface")},t.prototype.get=function(t){throw new Error("Cannot invoke get on a Matrix interface")},t.prototype.set=function(t,e,r){throw new Error("Cannot invoke set on a Matrix interface")},t.prototype.resize=function(t,e){throw new Error("Cannot invoke resize on a Matrix interface")},t.prototype.reshape=function(t,e){throw new Error("Cannot invoke reshape on a Matrix interface")},t.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},t.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},t.prototype.map=function(t,e){throw new Error("Cannot invoke map on a Matrix interface")},t.prototype.forEach=function(t){throw new Error("Cannot invoke forEach on a Matrix interface")},t.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},t.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},t.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},t.prototype.format=function(t){throw new Error("Cannot invoke format on a Matrix interface")},t.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},t}),{isClass:!0});function co(t){return Object.keys(t.signatures||{}).reduce((function(t,e){var r=(e.match(/,/g)||[]).length+1;return Math.max(t,r)}),-1)}var lo=un("DenseMatrix",["Matrix"],(t=>{var{Matrix:e}=t;function r(t,e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!Re(e))throw new Error("Invalid datatype: "+e);if(je(t))"DenseMatrix"===t.type?(this._data=Dr(t._data),this._size=Dr(t._size),this._datatype=e||t._datatype):(this._data=t.toArray(),this._size=t.size(),this._datatype=e||t._datatype);else if(t&&Pe(t.data)&&Pe(t.size))this._data=t.data,this._size=t.size,Hr(this._data,this._size),this._datatype=e||t.datatype;else if(Pe(t))this._data=a(t),this._size=$r(this._data),Hr(this._data,this._size),this._datatype=e;else{if(t)throw new TypeError("Unsupported type of data ("+wr(t)+")");this._data=[],this._size=[0],this._datatype=e}}function n(t,e,r,i){var o=i===r-1,u=e.dimension(i);return o?u.map((function(e){return Gr(e,t.length),t[e]})).valueOf():u.map((function(o){return Gr(o,t.length),n(t[o],e,r,i+1)})).valueOf()}function i(t,e,r,n,o){var u=o===n-1,a=e.dimension(o);u?a.forEach((function(e,n){Gr(e),t[e]=r[n[0]]})):a.forEach((function(u,a){Gr(u),i(t[u],e,r[a[0]],n,o+1)}))}function o(t,e,r){if(0===e.length){for(var n=t._data;Pe(n);)n=n[0];return n}return t._size=e.slice(0),t._data=Jr(t._data,t._size,r),t}function u(t,e,r){for(var n=t._size.slice(0),i=!1;n.length<e.length;)n.push(0),i=!0;for(var u=0,a=e.length;u<a;u++)e[u]>n[u]&&(n[u]=e[u],i=!0);i&&o(t,n,r)}function a(t){for(var e=0,r=t.length;e<r;e++){var n=t[e];Pe(n)?t[e]=a(n):n&&!0===n.isMatrix&&(t[e]=a(n.valueOf()))}return t}return r.prototype=new e,r.prototype.createDenseMatrix=function(t,e){return new r(t,e)},Object.defineProperty(r,"name",{value:"DenseMatrix"}),r.prototype.constructor=r,r.prototype.type="DenseMatrix",r.prototype.isDenseMatrix=!0,r.prototype.getDataType=function(){return on(this._data,wr)},r.prototype.storage=function(){return"dense"},r.prototype.datatype=function(){return this._datatype},r.prototype.create=function(t,e){return new r(t,e)},r.prototype.subset=function(t,e,o){switch(arguments.length){case 1:return function(t,e){if(!Ze(e))throw new TypeError("Invalid index");var i=e.isScalar();if(i)return t.get(e.min());var o=e.size();if(o.length!==t._size.length)throw new Zr(o.length,t._size.length);for(var u=e.min(),a=e.max(),s=0,f=t._size.length;s<f;s++)Gr(u[s],t._size[s]),Gr(a[s],t._size[s]);return new r(n(t._data,e,o.length,0),t._datatype)}(this,t);case 2:case 3:return function(t,e,r,n){if(!e||!0!==e.isIndex)throw new TypeError("Invalid index");var o,a=e.size(),s=e.isScalar();je(r)?(o=r.size(),r=r.valueOf()):o=$r(r);if(s){if(0!==o.length)throw new TypeError("Scalar expected");t.set(e.min(),r,n)}else{if(a.length<t._size.length)throw new Zr(a.length,t._size.length,"<");if(o.length<a.length){for(var f=0,h=0;1===a[f]&&1===o[f];)f++;for(;1===a[f];)h++,f++;r=en(r,a.length,h,o)}if(!vr(a,o))throw new Zr(a,o,">");var c=e.max().map((function(t){return t+1}));u(t,c,n);var l=a.length,p=0;i(t._data,e,r,l,p)}return t}(this,t,e,o);default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.get=function(t){if(!Pe(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new Zr(t.length,this._size.length);for(var e=0;e<t.length;e++)Gr(t[e],this._size[e]);for(var r=this._data,n=0,i=t.length;n<i;n++){var o=t[n];Gr(o,r.length),r=r[o]}return r},r.prototype.set=function(t,e,r){if(!Pe(t))throw new TypeError("Array expected");if(t.length<this._size.length)throw new Zr(t.length,this._size.length,"<");var n,i,o,a=t.map((function(t){return t+1}));u(this,a,r);var s=this._data;for(n=0,i=t.length-1;n<i;n++)Gr(o=t[n],s.length),s=s[o];return Gr(o=t[t.length-1],s.length),s[o]=e,this},r.prototype.resize=function(t,e,r){if(!qe(t))throw new TypeError("Array or Matrix expected");var n=t.valueOf().map((t=>Array.isArray(t)&&1===t.length?t[0]:t));return o(r?this.clone():this,n,e)},r.prototype.reshape=function(t,e){var r=e?this.clone():this;r._data=Kr(r._data,t);var n=r._size.reduce(((t,e)=>t*e));return r._size=Qr(t,n),r},r.prototype.clone=function(){return new r({data:Dr(this._data),size:Dr(this._size),datatype:this._datatype})},r.prototype.size=function(){return this._size.slice(0)},r.prototype.map=function(t){var e=this,n=co(t),i=function r(i,o){return Pe(i)?i.map((function(t,e){return r(t,o.concat(e))})):1===n?t(i):2===n?t(i,o):t(i,o,e)}(this._data,[]);return new r(i,void 0!==this._datatype?on(i,wr):void 0)},r.prototype.forEach=function(t){var e=this;!function r(n,i){Pe(n)?n.forEach((function(t,e){r(t,i.concat(e))})):t(n,i,e)}(this._data,[])},r.prototype[Symbol.iterator]=function*(){yield*function*t(e,r){if(Pe(e))for(var n=0;n<e.length;n++)yield*t(e[n],r.concat(n));else yield{value:e,index:r}}(this._data,[])},r.prototype.rows=function(){var t=[];if(2!==this.size().length)throw new TypeError("Rows can only be returned for a 2D matrix.");var e=this._data;for(var n of e)t.push(new r([n],this._datatype));return t},r.prototype.columns=function(){var t=this,e=[],n=this.size();if(2!==n.length)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var i=this._data,o=function(n){var o=i.map((t=>[t[n]]));e.push(new r(o,t._datatype))},u=0;u<n[1];u++)o(u);return e},r.prototype.toArray=function(){return Dr(this._data)},r.prototype.valueOf=function(){return this._data},r.prototype.format=function(t){return Ur(this._data,t)},r.prototype.toString=function(){return Ur(this._data)},r.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.prototype.diagonal=function(t){if(t){if(Te(t)&&(t=t.toNumber()),!ze(t)||!_r(t))throw new TypeError("The parameter k must be an integer number")}else t=0;for(var e=t>0?t:0,n=t<0?-t:0,i=this._size[0],o=this._size[1],u=Math.min(i-n,o-e),a=[],s=0;s<u;s++)a[s]=this._data[s+n][s+e];return new r({data:a,size:[u],datatype:this._datatype})},r.diagonal=function(t,e,n,i){if(!Pe(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map((function(t){if(Te(t)&&(t=t.toNumber()),!ze(t)||!_r(t)||t<1)throw new Error("Size values must be positive integers");return t})),n){if(Te(n)&&(n=n.toNumber()),!ze(n)||!_r(n))throw new TypeError("The parameter k must be an integer number")}else n=0;var o,u=n>0?n:0,a=n<0?-n:0,s=t[0],f=t[1],h=Math.min(s-a,f-u);if(Pe(e)){if(e.length!==h)throw new Error("Invalid value array length");o=function(t){return e[t]}}else if(je(e)){var c=e.size();if(1!==c.length||c[0]!==h)throw new Error("Invalid matrix length");o=function(t){return e.get([t])}}else o=function(){return e};i||(i=Te(o(0))?o(0).mul(0):0);var l=[];if(t.length>0){l=Jr(l,t,i);for(var p=0;p<h;p++)l[p+a][p+u]=o(p)}return new r({data:l,size:[s,f]})},r.fromJSON=function(t){return new r(t)},r.prototype.swapRows=function(t,e){if(!(ze(t)&&_r(t)&&ze(e)&&_r(e)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return Gr(t,this._size[0]),Gr(e,this._size[0]),r._swapRows(t,e,this._data),this},r._swapRows=function(t,e,r){var n=r[t];r[t]=r[e],r[e]=n},r}),{isClass:!0});function po(t,e){je(t)&&(t=t.valueOf());for(var r=0,n=t.length;r<n;r++){var i=t[r];Array.isArray(i)?po(i,e):e(i)}}function mo(t,e,r){return t&&"function"==typeof t.map?t.map((function(t){return mo(t,e)})):e(t)}function go(t,e,r){var n,i,o,u;if(e<=0){if(Array.isArray(t[0])){for(u=function(t){var e,r,n=t.length,i=t[0].length,o=[];for(r=0;r<i;r++){var u=[];for(e=0;e<n;e++)u.push(t[e][r]);o.push(u)}return o}(t),i=[],n=0;n<u.length;n++)i[n]=go(u[n],e-1,r);return i}for(o=t[0],n=1;n<t.length;n++)o=r(o,t[n]);return o}for(i=[],n=0;n<t.length;n++)i[n]=go(t[n],e-1,r);return i}var wo="isInteger",Do=un(wo,["typed"],(t=>{var{typed:e}=t;return e(wo,{number:_r,BigNumber:function(t){return t.isInt()},Fraction:function(t){return 1===t.d&&isFinite(t.n)},"Array | Matrix":e.referToSelf((t=>e=>mo(e,t)))})})),vo="number",yo="number, number";function Eo(t){return Math.abs(t)}function xo(t,e){return t+e}function bo(t,e){return t*e}function Ao(t){return-t}function Fo(t,e){return t*t<1&&e===1/0||t*t>1&&e===-1/0?0:Math.pow(t,e)}Eo.signature=vo,xo.signature=yo,bo.signature=yo,Ao.signature=vo,Fo.signature=yo;function Co(t){return 0===t}Co.signature="number";var Mo="isZero",So=un(Mo,["typed"],(t=>{var{typed:e}=t;return e(Mo,{number:Co,BigNumber:function(t){return t.isZero()},Complex:function(t){return 0===t.re&&0===t.im},Fraction:function(t){return 1===t.d&&0===t.n},Unit:e.referToSelf((t=>r=>e.find(t,r.valueType())(r.value))),"Array | Matrix":e.referToSelf((t=>e=>mo(e,t)))})}));var No=un("compareUnits",["typed"],(t=>{var{typed:e}=t;return{"Unit, Unit":e.referToSelf((t=>(r,n)=>{if(!r.equalBase(n))throw new Error("Cannot compare units with different base");return e.find(t,[r.valueType(),n.valueType()])(r.value,n.value)}))}})),_o="equalScalar",Bo=un(_o,["typed","config"],(t=>{var{typed:e,config:r}=t,n=No({typed:e});return e(_o,{"boolean, boolean":function(t,e){return t===e},"number, number":function(t,e){return Pr(t,e,r.epsilon)},"BigNumber, BigNumber":function(t,e){return t.eq(e)||function(t,e,r){if(null==r)return t.eq(e);if(t.eq(e))return!0;if(t.isNaN()||e.isNaN())return!1;if(t.isFinite()&&e.isFinite()){var n=t.minus(e).abs();if(n.isZero())return!0;var i=t.constructor.max(t.abs(),e.abs());return n.lte(i.times(r))}return!1}(t,e,r.epsilon)},"Fraction, Fraction":function(t,e){return t.equals(e)},"Complex, Complex":function(t,e){return function(t,e,r){return Pr(t.re,e.re,r)&&Pr(t.im,e.im,r)}(t,e,r.epsilon)}},n)}));un(_o,["typed","config"],(t=>{var{typed:e,config:r}=t;return e(_o,{"number, number":function(t,e){return Pr(t,e,r.epsilon)}})}));var zo=un("SparseMatrix",["typed","equalScalar","Matrix"],(t=>{var{typed:e,equalScalar:r,Matrix:n}=t;function i(t,e){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!Re(e))throw new Error("Invalid datatype: "+e);if(je(t))!function(t,e,r){"SparseMatrix"===e.type?(t._values=e._values?Dr(e._values):void 0,t._index=Dr(e._index),t._ptr=Dr(e._ptr),t._size=Dr(e._size),t._datatype=r||e._datatype):o(t,e.valueOf(),r||e._datatype)}(this,t,e);else if(t&&Pe(t.index)&&Pe(t.ptr)&&Pe(t.size))this._values=t.values,this._index=t.index,this._ptr=t.ptr,this._size=t.size,this._datatype=e||t.datatype;else if(Pe(t))o(this,t,e);else{if(t)throw new TypeError("Unsupported type of data ("+wr(t)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=e}}function o(t,n,i){t._values=[],t._index=[],t._ptr=[],t._datatype=i;var o=n.length,u=0,a=r,s=0;if(Re(i)&&(a=e.find(r,[i,i])||r,s=e.convert(0,i)),o>0){var f=0;do{t._ptr.push(t._index.length);for(var h=0;h<o;h++){var c=n[h];if(Pe(c)){if(0===f&&u<c.length&&(u=c.length),f<c.length){var l=c[f];a(l,s)||(t._values.push(l),t._index.push(h))}}else 0===f&&u<1&&(u=1),a(c,s)||(t._values.push(c),t._index.push(h))}f++}while(f<u)}t._ptr.push(t._index.length),t._size=[o,u]}function u(t,e,r,n){if(r-e==0)return r;for(var i=e;i<r;i++)if(n[i]===t)return i;return e}function a(t,e,r,n,i,o,u){i.splice(t,0,n),o.splice(t,0,e);for(var a=r+1;a<u.length;a++)u[a]++}function s(t,n,i,o){var u=o||0,a=r,s=0;Re(t._datatype)&&(a=e.find(r,[t._datatype,t._datatype])||r,s=e.convert(0,t._datatype),u=e.convert(u,t._datatype));var f,h,c,l=!a(u,s),p=t._size[0],m=t._size[1];if(i>m){for(h=m;h<i;h++)if(t._ptr[h]=t._values.length,l)for(f=0;f<p;f++)t._values.push(u),t._index.push(f);t._ptr[i]=t._values.length}else i<m&&(t._ptr.splice(i+1,m-i),t._values.splice(t._ptr[i],t._values.length),t._index.splice(t._ptr[i],t._index.length));if(m=i,n>p){if(l){var d=0;for(h=0;h<m;h++){t._ptr[h]=t._ptr[h]+d,c=t._ptr[h+1]+d;var g=0;for(f=p;f<n;f++,g++)t._values.splice(c+g,0,u),t._index.splice(c+g,0,f),d++}t._ptr[m]=t._values.length}}else if(n<p){var w=0;for(h=0;h<m;h++){t._ptr[h]=t._ptr[h]-w;var D=t._ptr[h],v=t._ptr[h+1]-w;for(c=D;c<v;c++)(f=t._index[c])>n-1&&(t._values.splice(c,1),t._index.splice(c,1),w++)}t._ptr[h]=t._values.length}return t._size[0]=n,t._size[1]=i,t}function f(t,e,r,n,i){var o,u,a=n[0],s=n[1],f=[];for(o=0;o<a;o++)for(f[o]=[],u=0;u<s;u++)f[o][u]=0;for(u=0;u<s;u++)for(var h=r[u],c=r[u+1],l=h;l<c;l++)f[o=e[l]][u]=t?i?Dr(t[l]):t[l]:1;return f}return i.prototype=new n,i.prototype.createSparseMatrix=function(t,e){return new i(t,e)},Object.defineProperty(i,"name",{value:"SparseMatrix"}),i.prototype.constructor=i,i.prototype.type="SparseMatrix",i.prototype.isSparseMatrix=!0,i.prototype.getDataType=function(){return on(this._values,wr)},i.prototype.storage=function(){return"sparse"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(t,e){return new i(t,e)},i.prototype.density=function(){var t=this._size[0],e=this._size[1];return 0!==t&&0!==e?this._index.length/(t*e):0},i.prototype.subset=function(t,e,r){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return function(t,e){if(!Ze(e))throw new TypeError("Invalid index");if(e.isScalar())return t.get(e.min());var r,n,o,u,a=e.size();if(a.length!==t._size.length)throw new Zr(a.length,t._size.length);var s=e.min(),f=e.max();for(r=0,n=t._size.length;r<n;r++)Gr(s[r],t._size[r]),Gr(f[r],t._size[r]);var h=t._values,c=t._index,l=t._ptr,p=e.dimension(0),m=e.dimension(1),d=[],g=[];p.forEach((function(t,e){g[t]=e[0],d[t]=!0}));var w=h?[]:void 0,D=[],v=[];return m.forEach((function(t){for(v.push(D.length),o=l[t],u=l[t+1];o<u;o++)r=c[o],!0===d[r]&&(D.push(g[r]),w&&w.push(h[o]))})),v.push(D.length),new i({values:w,index:D,ptr:v,size:a,datatype:t._datatype})}(this,t);case 2:case 3:return function(t,e,r,n){if(!e||!0!==e.isIndex)throw new TypeError("Invalid index");var i,o=e.size(),u=e.isScalar();je(r)?(i=r.size(),r=r.toArray()):i=$r(r);if(u){if(0!==i.length)throw new TypeError("Scalar expected");t.set(e.min(),r,n)}else{if(1!==o.length&&2!==o.length)throw new Zr(o.length,t._size.length,"<");if(i.length<o.length){for(var a=0,s=0;1===o[a]&&1===i[a];)a++;for(;1===o[a];)s++,a++;r=en(r,o.length,s,i)}if(!vr(o,i))throw new Zr(o,i,">");if(1===o.length){e.dimension(0).forEach((function(e,i){Gr(e),t.set([e,0],r[i[0]],n)}))}else{var f=e.dimension(0),h=e.dimension(1);f.forEach((function(e,i){Gr(e),h.forEach((function(o,u){Gr(o),t.set([e,o],r[i[0]][u[0]],n)}))}))}}return t}(this,t,e,r);default:throw new SyntaxError("Wrong number of arguments")}},i.prototype.get=function(t){if(!Pe(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new Zr(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var e=t[0],r=t[1];Gr(e,this._size[0]),Gr(r,this._size[1]);var n=u(e,this._ptr[r],this._ptr[r+1],this._index);return n<this._ptr[r+1]&&this._index[n]===e?this._values[n]:0},i.prototype.set=function(t,n,i){if(!Pe(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new Zr(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var o=t[0],f=t[1],h=this._size[0],c=this._size[1],l=r,p=0;Re(this._datatype)&&(l=e.find(r,[this._datatype,this._datatype])||r,p=e.convert(0,this._datatype)),(o>h-1||f>c-1)&&(s(this,Math.max(o+1,h),Math.max(f+1,c),i),h=this._size[0],c=this._size[1]),Gr(o,h),Gr(f,c);var m=u(o,this._ptr[f],this._ptr[f+1],this._index);return m<this._ptr[f+1]&&this._index[m]===o?l(n,p)?function(t,e,r,n,i){r.splice(t,1),n.splice(t,1);for(var o=e+1;o<i.length;o++)i[o]--}(m,f,this._values,this._index,this._ptr):this._values[m]=n:l(n,p)||a(m,o,f,n,this._values,this._index,this._ptr),this},i.prototype.resize=function(t,e,r){if(!qe(t))throw new TypeError("Array or Matrix expected");var n=t.valueOf().map((t=>Array.isArray(t)&&1===t.length?t[0]:t));if(2!==n.length)throw new Error("Only two dimensions matrix are supported");return n.forEach((function(t){if(!ze(t)||!_r(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Ur(n)+")")})),s(r?this.clone():this,n[0],n[1],e)},i.prototype.reshape=function(t,e){if(!Pe(t))throw new TypeError("Array expected");if(2!==t.length)throw new Error("Sparse matrices can only be reshaped in two dimensions");t.forEach((function(e){if(!ze(e)||!_r(e)||e<=-2||0===e)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+Ur(t)+")")}));var r=this._size[0]*this._size[1];if(r!==(t=Qr(t,r))[0]*t[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var n=e?this.clone():this;if(this._size[0]===t[0]&&this._size[1]===t[1])return n;for(var i=[],o=0;o<n._ptr.length;o++)for(var s=0;s<n._ptr[o+1]-n._ptr[o];s++)i.push(o);for(var f=n._values.slice(),h=n._index.slice(),c=0;c<n._index.length;c++){var l=h[c],p=i[c],m=l*n._size[1]+p;i[c]=m%t[1],h[c]=Math.floor(m/t[1])}n._values.length=0,n._index.length=0,n._ptr.length=t[1]+1,n._size=t.slice();for(var d=0;d<n._ptr.length;d++)n._ptr[d]=0;for(var g=0;g<f.length;g++){var w=h[g],D=i[g],v=f[g];a(u(w,n._ptr[D],n._ptr[D+1],n._index),w,D,v,n._values,n._index,n._ptr)}return n},i.prototype.clone=function(){return new i({values:this._values?Dr(this._values):void 0,index:Dr(this._index),ptr:Dr(this._ptr),size:Dr(this._size),datatype:this._datatype})},i.prototype.size=function(){return this._size.slice(0)},i.prototype.map=function(t,n){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var o=this,u=this._size[0],a=this._size[1],s=co(t);return function(t,n,o,u,a,s,f){var h=[],c=[],l=[],p=r,m=0;Re(t._datatype)&&(p=e.find(r,[t._datatype,t._datatype])||r,m=e.convert(0,t._datatype));for(var d=function(t,e,r){t=s(t,e,r),p(t,m)||(h.push(t),c.push(e))},g=u;g<=a;g++){l.push(h.length);var w=t._ptr[g],D=t._ptr[g+1];if(f)for(var v=w;v<D;v++){var y=t._index[v];y>=n&&y<=o&&d(t._values[v],y-n,g-u)}else{for(var E={},x=w;x<D;x++){E[t._index[x]]=t._values[x]}for(var b=n;b<=o;b++){d(b in E?E[b]:0,b-n,g-u)}}}return l.push(h.length),new i({values:h,index:c,ptr:l,size:[o-n+1,a-u+1]})}(this,0,u-1,0,a-1,(function(e,r,n){return 1===s?t(e):2===s?t(e,[r,n]):t(e,[r,n],o)}),n)},i.prototype.forEach=function(t,e){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var r=this._size[0],n=this._size[1],i=0;i<n;i++){var o=this._ptr[i],u=this._ptr[i+1];if(e)for(var a=o;a<u;a++){var s=this._index[a];t(this._values[a],[s,i],this)}else{for(var f={},h=o;h<u;h++){f[this._index[h]]=this._values[h]}for(var c=0;c<r;c++){t(c in f?f[c]:0,[c,i],this)}}}},i.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var t=this._size[1],e=0;e<t;e++)for(var r=this._ptr[e],n=this._ptr[e+1],i=r;i<n;i++){var o=this._index[i];yield{value:this._values[i],index:[o,e]}}},i.prototype.toArray=function(){return f(this._values,this._index,this._ptr,this._size,!0)},i.prototype.valueOf=function(){return f(this._values,this._index,this._ptr,this._size,!1)},i.prototype.format=function(t){for(var e=this._size[0],r=this._size[1],n=this.density(),i="Sparse Matrix ["+Ur(e,t)+" x "+Ur(r,t)+"] density: "+Ur(n,t)+"\n",o=0;o<r;o++)for(var u=this._ptr[o],a=this._ptr[o+1],s=u;s<a;s++){i+="\n    ("+Ur(this._index[s],t)+", "+Ur(o,t)+") ==> "+(this._values?Ur(this._values[s],t):"X")}return i},i.prototype.toString=function(){return Ur(this.toArray())},i.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(t){if(t){if(Te(t)&&(t=t.toNumber()),!ze(t)||!_r(t))throw new TypeError("The parameter k must be an integer number")}else t=0;var e=t>0?t:0,r=t<0?-t:0,n=this._size[0],o=this._size[1],u=Math.min(n-r,o-e),a=[],s=[],f=[];f[0]=0;for(var h=e;h<o&&a.length<u;h++)for(var c=this._ptr[h],l=this._ptr[h+1],p=c;p<l;p++){var m=this._index[p];if(m===h-e+r){a.push(this._values[p]),s[a.length-1]=m-r;break}}return f.push(a.length),new i({values:a,index:s,ptr:f,size:[u,1]})},i.fromJSON=function(t){return new i(t)},i.diagonal=function(t,n,o,u,a){if(!Pe(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map((function(t){if(Te(t)&&(t=t.toNumber()),!ze(t)||!_r(t)||t<1)throw new Error("Size values must be positive integers");return t})),o){if(Te(o)&&(o=o.toNumber()),!ze(o)||!_r(o))throw new TypeError("The parameter k must be an integer number")}else o=0;var s=r,f=0;Re(a)&&(s=e.find(r,[a,a])||r,f=e.convert(0,a));var h,c=o>0?o:0,l=o<0?-o:0,p=t[0],m=t[1],d=Math.min(p-l,m-c);if(Pe(n)){if(n.length!==d)throw new Error("Invalid value array length");h=function(t){return n[t]}}else if(je(n)){var g=n.size();if(1!==g.length||g[0]!==d)throw new Error("Invalid matrix length");h=function(t){return n.get([t])}}else h=function(){return n};for(var w=[],D=[],v=[],y=0;y<m;y++){v.push(w.length);var E=y-c;if(E>=0&&E<d){var x=h(E);s(x,f)||(D.push(E+l),w.push(x))}}return v.push(w.length),new i({values:w,index:D,ptr:v,size:[p,m]})},i.prototype.swapRows=function(t,e){if(!(ze(t)&&_r(t)&&ze(e)&&_r(e)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return Gr(t,this._size[0]),Gr(e,this._size[0]),i._swapRows(t,e,this._size[1],this._values,this._index,this._ptr),this},i._forEachRow=function(t,e,r,n,i){for(var o=n[t],u=n[t+1],a=o;a<u;a++)i(r[a],e[a])},i._swapRows=function(t,e,r,n,i,o){for(var a=0;a<r;a++){var s=o[a],f=o[a+1],h=u(t,s,f,i),c=u(e,s,f,i);if(h<f&&c<f&&i[h]===t&&i[c]===e){if(n){var l=n[h];n[h]=n[c],n[c]=l}}else if(h<f&&i[h]===t&&(c>=f||i[c]!==e)){var p=n?n[h]:void 0;i.splice(c,0,e),n&&n.splice(c,0,p),i.splice(c<=h?h+1:h,1),n&&n.splice(c<=h?h+1:h,1)}else if(c<f&&i[c]===e&&(h>=f||i[h]!==t)){var m=n?n[c]:void 0;i.splice(h,0,t),n&&n.splice(h,0,m),i.splice(h<=c?c+1:c,1),n&&n.splice(h<=c?c+1:c,1)}}},i}),{isClass:!0});var To=un("number",["typed"],(t=>{var{typed:e}=t,r=e("number",{"":function(){return 0},number:function(t){return t},string:function(t){if("NaN"===t)return NaN;var e,r,n=(r=(e=t).match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/))?{input:e,radix:{"0b":2,"0o":8,"0x":16}[r[1]],integerPart:r[2],fractionalPart:r[3]}:null;if(n)return function(t){for(var e=parseInt(t.integerPart,t.radix),r=0,n=0;n<t.fractionalPart.length;n++)r+=parseInt(t.fractionalPart[n],t.radix)/Math.pow(t.radix,n+1);var i=e+r;if(isNaN(i))throw new SyntaxError('String "'+t.input+'" is no valid number');return i}(n);var i=0,o=t.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);o&&(i=Number(o[2]),t=o[1]);var u=Number(t);if(isNaN(u))throw new SyntaxError('String "'+t+'" is no valid number');if(o){if(u>2**i-1)throw new SyntaxError('String "'.concat(t,'" is out of range'));u>=2**(i-1)&&(u-=2**i)}return u},BigNumber:function(t){return t.toNumber()},Fraction:function(t){return t.valueOf()},Unit:e.referToSelf((t=>e=>{var r=e.clone();return r.value=t(e.value),r})),null:function(t){return 0},"Unit, string | Unit":function(t,e){return t.toNumber(e)},"Array | Matrix":e.referToSelf((t=>e=>mo(e,t)))});return r.fromJSON=function(t){return parseFloat(t.value)},r})),Oo=un("bignumber",["typed","BigNumber"],(t=>{var{typed:e,BigNumber:r}=t;return e("bignumber",{"":function(){return new r(0)},number:function(t){return new r(t+"")},string:function(t){var e=t.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(e){var n=e[2],i=r(e[1]),o=new r(2).pow(Number(n));if(i.gt(o.sub(1)))throw new SyntaxError('String "'.concat(t,'" is out of range'));var u=new r(2).pow(Number(n)-1);return i.gte(u)?i.sub(o):i}return new r(t)},BigNumber:function(t){return t},Unit:e.referToSelf((t=>e=>{var r=e.clone();return r.value=t(e.value),r})),Fraction:function(t){return new r(t.n).div(t.d).times(t.s)},null:function(t){return new r(0)},"Array | Matrix":e.referToSelf((t=>e=>mo(e,t)))})})),ko=un("fraction",["typed","Fraction"],(t=>{var{typed:e,Fraction:r}=t;return e("fraction",{number:function(t){if(!isFinite(t)||isNaN(t))throw new Error(t+" cannot be represented as a fraction");return new r(t)},string:function(t){return new r(t)},"number, number":function(t,e){return new r(t,e)},null:function(t){return new r(0)},BigNumber:function(t){return new r(t.toString())},Fraction:function(t){return t},Unit:e.referToSelf((t=>e=>{var r=e.clone();return r.value=t(e.value),r})),Object:function(t){return new r(t)},"Array | Matrix":e.referToSelf((t=>e=>mo(e,t)))})})),Io="matrix",Ro=un(Io,["typed","Matrix","DenseMatrix","SparseMatrix"],(t=>{var{typed:e,Matrix:r,DenseMatrix:n,SparseMatrix:i}=t;return e(Io,{"":function(){return o([])},string:function(t){return o([],t)},"string, string":function(t,e){return o([],t,e)},Array:function(t){return o(t)},Matrix:function(t){return o(t,t.storage())},"Array | Matrix, string":o,"Array | Matrix, string, string":o});function o(t,e,r){if("dense"===e||"default"===e||void 0===e)return new n(t,r);if("sparse"===e)return new i(t,r);throw new TypeError("Unknown matrix type "+JSON.stringify(e)+".")}})),Po="unaryMinus",jo=un(Po,["typed"],(t=>{var{typed:e}=t;return e(Po,{number:Ao,"Complex | BigNumber | Fraction":t=>t.neg(),Unit:e.referToSelf((t=>r=>{var n=r.clone();return n.value=e.find(t,n.valueType())(r.value),n})),"Array | Matrix":e.referToSelf((t=>e=>mo(e,t)))})})),qo=un("abs",["typed"],(t=>{var{typed:e}=t;return e("abs",{number:Eo,"Complex | BigNumber | Fraction | Unit":t=>t.abs(),"Array | Matrix":e.referToSelf((t=>e=>mo(e,t)))})})),Vo="addScalar",Uo=un(Vo,["typed"],(t=>{var{typed:e}=t;return e(Vo,{"number, number":xo,"Complex, Complex":function(t,e){return t.add(e)},"BigNumber, BigNumber":function(t,e){return t.plus(e)},"Fraction, Fraction":function(t,e){return t.add(e)},"Unit, Unit":e.referToSelf((t=>(r,n)=>{if(null===r.value||void 0===r.value)throw new Error("Parameter x contains a unit with undefined value");if(null===n.value||void 0===n.value)throw new Error("Parameter y contains a unit with undefined value");if(!r.equalBase(n))throw new Error("Units do not match");var i=r.clone();return i.value=e.find(t,[i.valueType(),n.valueType()])(i.value,n.value),i.fixPrefix=!1,i}))})})),Lo=un("matAlgo11xS0s",["typed","equalScalar"],(t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i,o){var u=t._values,a=t._index,s=t._ptr,f=t._size,h=t._datatype;if(!u)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var c,l=f[0],p=f[1],m=r,d=0,g=i;"string"==typeof h&&(c=h,m=e.find(r,[c,c]),d=e.convert(0,c),n=e.convert(n,c),g=e.find(i,[c,c]));for(var w=[],D=[],v=[],y=0;y<p;y++){v[y]=D.length;for(var E=s[y],x=s[y+1],b=E;b<x;b++){var A=a[b],F=o?g(n,u[b]):g(u[b],n);m(F,d)||(D.push(A),w.push(F))}}return v[p]=D.length,t.createSparseMatrix({values:w,index:D,ptr:v,size:[l,p],datatype:c})}})),Zo=un("matAlgo12xSfs",["typed","DenseMatrix"],(t=>{var{typed:e,DenseMatrix:r}=t;return function(t,n,i,o){var u=t._values,a=t._index,s=t._ptr,f=t._size,h=t._datatype;if(!u)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var c,l=f[0],p=f[1],m=i;"string"==typeof h&&(c=h,n=e.convert(n,c),m=e.find(i,[c,c]));for(var d=[],g=[],w=[],D=0;D<p;D++){for(var v=D+1,y=s[D],E=s[D+1],x=y;x<E;x++){var b=a[x];g[b]=u[x],w[b]=v}for(var A=0;A<l;A++)0===D&&(d[A]=[]),w[A]===v?d[A][D]=o?m(n,g[A]):m(g[A],n):d[A][D]=o?m(n,0):m(0,n)}return new r({data:d,size:[l,p],datatype:c})}})),Xo=un("matAlgo14xDs",["typed"],(t=>{var{typed:e}=t;return function(t,n,i,o){var u,a=t._data,s=t._size,f=t._datatype,h=i;"string"==typeof f&&(u=f,n=e.convert(n,u),h=e.find(i,[u,u]));var c=s.length>0?r(h,0,s,s[0],a,n,o):[];return t.createDenseMatrix({data:c,size:Dr(s),datatype:u})};function r(t,e,n,i,o,u,a){var s=[];if(e===n.length-1)for(var f=0;f<i;f++)s[f]=a?t(u,o[f]):t(o[f],u);else for(var h=0;h<i;h++)s[h]=r(t,e+1,n,n[e+1],o[h],u,a);return s}})),$o=un("matAlgo01xDSid",["typed"],(t=>{var{typed:e}=t;return function(t,r,n,i){var o=t._data,u=t._size,a=t._datatype,s=r._values,f=r._index,h=r._ptr,c=r._size,l=r._datatype;if(u.length!==c.length)throw new Zr(u.length,c.length);if(u[0]!==c[0]||u[1]!==c[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+c+")");if(!s)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var p,m,d=u[0],g=u[1],w="string"==typeof a&&a===l?a:void 0,D=w?e.find(n,[w,w]):n,v=[];for(p=0;p<d;p++)v[p]=[];var y=[],E=[];for(m=0;m<g;m++){for(var x=m+1,b=h[m],A=h[m+1],F=b;F<A;F++)y[p=f[F]]=i?D(s[F],o[p][m]):D(o[p][m],s[F]),E[p]=x;for(p=0;p<d;p++)E[p]===x?v[p][m]=y[p]:v[p][m]=o[p][m]}return t.createDenseMatrix({data:v,size:[d,g],datatype:w})}})),Yo=un("matAlgo04xSidSid",["typed","equalScalar"],(t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i){var o=t._values,u=t._index,a=t._ptr,s=t._size,f=t._datatype,h=n._values,c=n._index,l=n._ptr,p=n._size,m=n._datatype;if(s.length!==p.length)throw new Zr(s.length,p.length);if(s[0]!==p[0]||s[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+p+")");var d,g=s[0],w=s[1],D=r,v=0,y=i;"string"==typeof f&&f===m&&(d=f,D=e.find(r,[d,d]),v=e.convert(0,d),y=e.find(i,[d,d]));var E,x,b,A,F,C=o&&h?[]:void 0,M=[],S=[],N=o&&h?[]:void 0,_=o&&h?[]:void 0,B=[],z=[];for(x=0;x<w;x++){S[x]=M.length;var T=x+1;for(A=a[x],F=a[x+1],b=A;b<F;b++)E=u[b],M.push(E),B[E]=T,N&&(N[E]=o[b]);for(A=l[x],F=l[x+1],b=A;b<F;b++)if(B[E=c[b]]===T){if(N){var O=y(N[E],h[b]);D(O,v)?B[E]=null:N[E]=O}}else M.push(E),z[E]=T,_&&(_[E]=h[b]);if(N&&_)for(b=S[x];b<M.length;)B[E=M[b]]===T?(C[b]=N[E],b++):z[E]===T?(C[b]=_[E],b++):M.splice(b,1)}return S[w]=M.length,t.createSparseMatrix({values:C,index:M,ptr:S,size:[g,w],datatype:d})}})),Ho=un("matAlgo10xSids",["typed","DenseMatrix"],(t=>{var{typed:e,DenseMatrix:r}=t;return function(t,n,i,o){var u=t._values,a=t._index,s=t._ptr,f=t._size,h=t._datatype;if(!u)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var c,l=f[0],p=f[1],m=i;"string"==typeof h&&(c=h,n=e.convert(n,c),m=e.find(i,[c,c]));for(var d=[],g=[],w=[],D=0;D<p;D++){for(var v=D+1,y=s[D],E=s[D+1],x=y;x<E;x++){var b=a[x];g[b]=u[x],w[b]=v}for(var A=0;A<l;A++)0===D&&(d[A]=[]),w[A]===v?d[A][D]=o?m(n,g[A]):m(g[A],n):d[A][D]=n}return new r({data:d,size:[l,p],datatype:c})}})),Go=un("matAlgo13xDD",["typed"],(t=>{var{typed:e}=t;return function(t,n,i){var o,u=t._data,a=t._size,s=t._datatype,f=n._data,h=n._size,c=n._datatype,l=[];if(a.length!==h.length)throw new Zr(a.length,h.length);for(var p=0;p<a.length;p++){if(a[p]!==h[p])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+h+")");l[p]=a[p]}var m=i;"string"==typeof s&&s===c&&(o=s,m=e.find(i,[o,o]));var d=l.length>0?r(m,0,l,l[0],u,f):[];return t.createDenseMatrix({data:d,size:l,datatype:o})};function r(t,e,n,i,o,u){var a=[];if(e===n.length-1)for(var s=0;s<i;s++)a[s]=t(o[s],u[s]);else for(var f=0;f<i;f++)a[f]=r(t,e+1,n,n[e+1],o[f],u[f]);return a}})),Jo=un("broadcast",["concat"],(t=>{var{concat:e}=t;return function(t,e){var o=Math.max(t._size.length,e._size.length);if(t._size.length===e._size.length&&t._size.every(((t,r)=>t===e._size[r])))return[t,e];for(var u=r(t._size,o,0),a=r(e._size,o,0),s=[],f=0;f<o;f++)s[f]=Math.max(u[f],a[f]);for(var h=0;h<o;h++)i(u,s,h),i(a,s,h);var c=t.clone(),l=e.clone();c._size.length<o?c.reshape(r(c._size,o,1)):l._size.length<o&&l.reshape(r(l._size,o,1));for(var p=0;p<o;p++)c._size[p]<s[p]&&(c=n(c,s[p],p)),l._size[p]<s[p]&&(l=n(l,s[p],p));return[c,l]};function r(t,e,r){return[...Array(e-t.length).fill(r),...t]}function n(t,r,n){return e(...Array(r).fill(t),n)}function i(t,e,r){if(t[r]<e[r]&t[r]>1)throw new Error("shape missmatch: missmatch is found in arg with shape (".concat(t,") not possible to broadcast dimension ").concat(r," with size ").concat(t[r]," to size ").concat(e[r]))}})),Wo=un("matrixAlgorithmSuite",["typed","matrix","concat"],(t=>{var{typed:e,matrix:r,concat:n}=t,i=Go({typed:e}),o=Xo({typed:e}),u=Jo({concat:n});return function(t){var n,a=t.elop,s=t.SD||t.DS;a?(n={"DenseMatrix, DenseMatrix":(t,e)=>i(...u(t,e),a),"Array, Array":(t,e)=>i(...u(r(t),r(e)),a).valueOf(),"Array, DenseMatrix":(t,e)=>i(...u(r(t),e),a),"DenseMatrix, Array":(t,e)=>i(...u(t,r(e)),a)},t.SS&&(n["SparseMatrix, SparseMatrix"]=(e,r)=>t.SS(...u(e,r),a,!1)),t.DS&&(n["DenseMatrix, SparseMatrix"]=(e,r)=>t.DS(...u(e,r),a,!1),n["Array, SparseMatrix"]=(e,n)=>t.DS(...u(r(e),n),a,!1)),s&&(n["SparseMatrix, DenseMatrix"]=(t,e)=>s(...u(e,t),a,!0),n["SparseMatrix, Array"]=(t,e)=>s(...u(r(e),t),a,!0))):(n={"DenseMatrix, DenseMatrix":e.referToSelf((t=>(e,r)=>i(...u(e,r),t))),"Array, Array":e.referToSelf((t=>(e,n)=>i(...u(r(e),r(n)),t).valueOf())),"Array, DenseMatrix":e.referToSelf((t=>(e,n)=>i(...u(r(e),n),t))),"DenseMatrix, Array":e.referToSelf((t=>(e,n)=>i(...u(e,r(n)),t)))},t.SS&&(n["SparseMatrix, SparseMatrix"]=e.referToSelf((e=>(r,n)=>t.SS(...u(r,n),e,!1)))),t.DS&&(n["DenseMatrix, SparseMatrix"]=e.referToSelf((e=>(r,n)=>t.DS(...u(r,n),e,!1))),n["Array, SparseMatrix"]=e.referToSelf((e=>(n,i)=>t.DS(...u(r(n),i),e,!1)))),s&&(n["SparseMatrix, DenseMatrix"]=e.referToSelf((t=>(e,r)=>s(...u(r,e),t,!0))),n["SparseMatrix, Array"]=e.referToSelf((t=>(e,n)=>s(...u(r(n),e),t,!0)))));var f=t.scalar||"any";(t.Ds||t.Ss)&&(a?(n["DenseMatrix,"+f]=(t,e)=>o(t,e,a,!1),n[f+", DenseMatrix"]=(t,e)=>o(e,t,a,!0),n["Array,"+f]=(t,e)=>o(r(t),e,a,!1).valueOf(),n[f+", Array"]=(t,e)=>o(r(e),t,a,!0).valueOf()):(n["DenseMatrix,"+f]=e.referToSelf((t=>(e,r)=>o(e,r,t,!1))),n[f+", DenseMatrix"]=e.referToSelf((t=>(e,r)=>o(r,e,t,!0))),n["Array,"+f]=e.referToSelf((t=>(e,n)=>o(r(e),n,t,!1).valueOf())),n[f+", Array"]=e.referToSelf((t=>(e,n)=>o(r(n),e,t,!0).valueOf()))));var h=void 0!==t.sS?t.sS:t.Ss;return a?(t.Ss&&(n["SparseMatrix,"+f]=(e,r)=>t.Ss(e,r,a,!1)),h&&(n[f+", SparseMatrix"]=(t,e)=>h(e,t,a,!0))):(t.Ss&&(n["SparseMatrix,"+f]=e.referToSelf((e=>(r,n)=>t.Ss(r,n,e,!1)))),h&&(n[f+", SparseMatrix"]=e.referToSelf((t=>(e,r)=>h(r,e,t,!0))))),a&&a.signatures&&function(t,e){for(var r in e)yr(e,r)&&(t[r]=e[r])}(n,a.signatures),n}})),Ko=un("matAlgo02xDS0",["typed","equalScalar"],(t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i,o){var u=t._data,a=t._size,s=t._datatype,f=n._values,h=n._index,c=n._ptr,l=n._size,p=n._datatype;if(a.length!==l.length)throw new Zr(a.length,l.length);if(a[0]!==l[0]||a[1]!==l[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+l+")");if(!f)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var m,d=a[0],g=a[1],w=r,D=0,v=i;"string"==typeof s&&s===p&&(m=s,w=e.find(r,[m,m]),D=e.convert(0,m),v=e.find(i,[m,m]));for(var y=[],E=[],x=[],b=0;b<g;b++){x[b]=E.length;for(var A=c[b],F=c[b+1],C=A;C<F;C++){var M=h[C],S=o?v(f[C],u[M][b]):v(u[M][b],f[C]);w(S,D)||(E.push(M),y.push(S))}}return x[g]=E.length,n.createSparseMatrix({values:y,index:E,ptr:x,size:[d,g],datatype:m})}})),Qo=un("matAlgo03xDSf",["typed"],(t=>{var{typed:e}=t;return function(t,r,n,i){var o=t._data,u=t._size,a=t._datatype,s=r._values,f=r._index,h=r._ptr,c=r._size,l=r._datatype;if(u.length!==c.length)throw new Zr(u.length,c.length);if(u[0]!==c[0]||u[1]!==c[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+c+")");if(!s)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var p,m=u[0],d=u[1],g=0,w=n;"string"==typeof a&&a===l&&(p=a,g=e.convert(0,p),w=e.find(n,[p,p]));for(var D=[],v=0;v<m;v++)D[v]=[];for(var y=[],E=[],x=0;x<d;x++){for(var b=x+1,A=h[x],F=h[x+1],C=A;C<F;C++){var M=f[C];y[M]=i?w(s[C],o[M][x]):w(o[M][x],s[C]),E[M]=b}for(var S=0;S<m;S++)E[S]===b?D[S][x]=y[S]:D[S][x]=i?w(g,o[S][x]):w(o[S][x],g)}return t.createDenseMatrix({data:D,size:[m,d],datatype:p})}})),tu=un("matAlgo05xSfSf",["typed","equalScalar"],(t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i){var o=t._values,u=t._index,a=t._ptr,s=t._size,f=t._datatype,h=n._values,c=n._index,l=n._ptr,p=n._size,m=n._datatype;if(s.length!==p.length)throw new Zr(s.length,p.length);if(s[0]!==p[0]||s[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+p+")");var d,g=s[0],w=s[1],D=r,v=0,y=i;"string"==typeof f&&f===m&&(d=f,D=e.find(r,[d,d]),v=e.convert(0,d),y=e.find(i,[d,d]));var E,x,b,A,F=o&&h?[]:void 0,C=[],M=[],S=F?[]:void 0,N=F?[]:void 0,_=[],B=[];for(x=0;x<w;x++){M[x]=C.length;var z=x+1;for(b=a[x],A=a[x+1];b<A;b++)E=u[b],C.push(E),_[E]=z,S&&(S[E]=o[b]);for(b=l[x],A=l[x+1];b<A;b++)_[E=c[b]]!==z&&C.push(E),B[E]=z,N&&(N[E]=h[b]);if(F)for(b=M[x];b<C.length;){var T=_[E=C[b]],O=B[E];if(T===z||O===z){var k=y(T===z?S[E]:v,O===z?N[E]:v);D(k,v)?C.splice(b,1):(F.push(k),b++)}}}return M[w]=C.length,t.createSparseMatrix({values:F,index:C,ptr:M,size:[g,w],datatype:d})}})),eu=un("multiplyScalar",["typed"],(t=>{var{typed:e}=t;return e("multiplyScalar",{"number, number":bo,"Complex, Complex":function(t,e){return t.mul(e)},"BigNumber, BigNumber":function(t,e){return t.times(e)},"Fraction, Fraction":function(t,e){return t.mul(e)},"number | Fraction | BigNumber | Complex, Unit":(t,e)=>e.multiply(t),"Unit, number | Fraction | BigNumber | Complex | Unit":(t,e)=>t.multiply(e)})})),ru="multiply",nu=un(ru,["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],(t=>{var{typed:e,matrix:r,addScalar:n,multiplyScalar:i,equalScalar:o,dot:u}=t,a=Lo({typed:e,equalScalar:o}),s=Xo({typed:e});function f(t,e){switch(t.length){case 1:switch(e.length){case 1:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+t[0]+") must match Matrix rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;case 2:switch(e.length){case 1:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+t[1]+") must match Vector length ("+e[0]+")");break;case 2:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+t[1]+") must match Matrix B rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+t.length+" dimensions)")}}function h(t,r){if("dense"!==r.storage())throw new Error("Support for SparseMatrix not implemented");return function(t,r){var o,u=t._data,a=t._size,s=t._datatype,f=r._data,h=r._size,c=r._datatype,l=a[0],p=h[1],m=n,d=i;s&&c&&s===c&&"string"==typeof s&&(o=s,m=e.find(n,[o,o]),d=e.find(i,[o,o]));for(var g=[],w=0;w<p;w++){for(var D=d(u[0],f[0][w]),v=1;v<l;v++)D=m(D,d(u[v],f[v][w]));g[w]=D}return t.createDenseMatrix({data:g,size:[p],datatype:o})}(t,r)}var c=e("_multiplyMatrixVector",{"DenseMatrix, any":function(t,r){var o,u=t._data,a=t._size,s=t._datatype,f=r._data,h=r._datatype,c=a[0],l=a[1],p=n,m=i;s&&h&&s===h&&"string"==typeof s&&(o=s,p=e.find(n,[o,o]),m=e.find(i,[o,o]));for(var d=[],g=0;g<c;g++){for(var w=u[g],D=m(w[0],f[0]),v=1;v<l;v++)D=p(D,m(w[v],f[v]));d[g]=D}return t.createDenseMatrix({data:d,size:[c],datatype:o})},"SparseMatrix, any":function(t,r){var u=t._values,a=t._index,s=t._ptr,f=t._datatype;if(!u)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var h,c=r._data,l=r._datatype,p=t._size[0],m=r._size[0],d=[],g=[],w=[],D=n,v=i,y=o,E=0;f&&l&&f===l&&"string"==typeof f&&(h=f,D=e.find(n,[h,h]),v=e.find(i,[h,h]),y=e.find(o,[h,h]),E=e.convert(0,h));var x=[],b=[];w[0]=0;for(var A=0;A<m;A++){var F=c[A];if(!y(F,E))for(var C=s[A],M=s[A+1],S=C;S<M;S++){var N=a[S];b[N]?x[N]=D(x[N],v(F,u[S])):(b[N]=!0,g.push(N),x[N]=v(F,u[S]))}}for(var _=g.length,B=0;B<_;B++){var z=g[B];d[B]=x[z]}return w[1]=g.length,t.createSparseMatrix({values:d,index:g,ptr:w,size:[p,1],datatype:h})}}),l=e("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":function(t,r){var o,u=t._data,a=t._size,s=t._datatype,f=r._data,h=r._size,c=r._datatype,l=a[0],p=a[1],m=h[1],d=n,g=i;s&&c&&s===c&&"string"==typeof s&&(o=s,d=e.find(n,[o,o]),g=e.find(i,[o,o]));for(var w=[],D=0;D<l;D++){var v=u[D];w[D]=[];for(var y=0;y<m;y++){for(var E=g(v[0],f[0][y]),x=1;x<p;x++)E=d(E,g(v[x],f[x][y]));w[D][y]=E}}return t.createDenseMatrix({data:w,size:[l,m],datatype:o})},"DenseMatrix, SparseMatrix":function(t,r){var u=t._data,a=t._size,s=t._datatype,f=r._values,h=r._index,c=r._ptr,l=r._size,p=r._datatype;if(!f)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var m,d=a[0],g=l[1],w=n,D=i,v=o,y=0;s&&p&&s===p&&"string"==typeof s&&(m=s,w=e.find(n,[m,m]),D=e.find(i,[m,m]),v=e.find(o,[m,m]),y=e.convert(0,m));for(var E=[],x=[],b=[],A=r.createSparseMatrix({values:E,index:x,ptr:b,size:[d,g],datatype:m}),F=0;F<g;F++){b[F]=x.length;var C=c[F],M=c[F+1];if(M>C)for(var S=0,N=0;N<d;N++){for(var _=N+1,B=void 0,z=C;z<M;z++){var T=h[z];S!==_?(B=D(u[N][T],f[z]),S=_):B=w(B,D(u[N][T],f[z]))}S!==_||v(B,y)||(x.push(N),E.push(B))}}return b[g]=x.length,A},"SparseMatrix, DenseMatrix":function(t,r){var u=t._values,a=t._index,s=t._ptr,f=t._datatype;if(!u)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var h,c=r._data,l=r._datatype,p=t._size[0],m=r._size[0],d=r._size[1],g=n,w=i,D=o,v=0;f&&l&&f===l&&"string"==typeof f&&(h=f,g=e.find(n,[h,h]),w=e.find(i,[h,h]),D=e.find(o,[h,h]),v=e.convert(0,h));for(var y=[],E=[],x=[],b=t.createSparseMatrix({values:y,index:E,ptr:x,size:[p,d],datatype:h}),A=[],F=[],C=0;C<d;C++){x[C]=E.length;for(var M=C+1,S=0;S<m;S++){var N=c[S][C];if(!D(N,v))for(var _=s[S],B=s[S+1],z=_;z<B;z++){var T=a[z];F[T]!==M?(F[T]=M,E.push(T),A[T]=w(N,u[z])):A[T]=g(A[T],w(N,u[z]))}}for(var O=x[C],k=E.length,I=O;I<k;I++){var R=E[I];y[I]=A[R]}}return x[d]=E.length,b},"SparseMatrix, SparseMatrix":function(t,r){var o,u=t._values,a=t._index,s=t._ptr,f=t._datatype,h=r._values,c=r._index,l=r._ptr,p=r._datatype,m=t._size[0],d=r._size[1],g=u&&h,w=n,D=i;f&&p&&f===p&&"string"==typeof f&&(o=f,w=e.find(n,[o,o]),D=e.find(i,[o,o]));for(var v,y,E,x,b,A,F,C,M=g?[]:void 0,S=[],N=[],_=t.createSparseMatrix({values:M,index:S,ptr:N,size:[m,d],datatype:o}),B=g?[]:void 0,z=[],T=0;T<d;T++){N[T]=S.length;var O=T+1;for(b=l[T],A=l[T+1],x=b;x<A;x++)if(C=c[x],g)for(y=s[C],E=s[C+1],v=y;v<E;v++)z[F=a[v]]!==O?(z[F]=O,S.push(F),B[F]=D(h[x],u[v])):B[F]=w(B[F],D(h[x],u[v]));else for(y=s[C],E=s[C+1],v=y;v<E;v++)z[F=a[v]]!==O&&(z[F]=O,S.push(F));if(g)for(var k=N[T],I=S.length,R=k;R<I;R++){var P=S[R];M[R]=B[P]}}return N[d]=S.length,_}});return e(ru,i,{"Array, Array":e.referTo("Matrix, Matrix",(t=>(e,n)=>{f($r(e),$r(n));var i=t(r(e),r(n));return je(i)?i.valueOf():i})),"Matrix, Matrix":function(t,e){var r=t.size(),n=e.size();return f(r,n),1===r.length?1===n.length?function(t,e,r){if(0===r)throw new Error("Cannot multiply two empty vectors");return u(t,e)}(t,e,r[0]):h(t,e):1===n.length?c(t,e):l(t,e)},"Matrix, Array":e.referTo("Matrix,Matrix",(t=>(e,n)=>t(e,r(n)))),"Array, Matrix":e.referToSelf((t=>(e,n)=>t(r(e,n.storage()),n))),"SparseMatrix, any":function(t,e){return a(t,e,i,!1)},"DenseMatrix, any":function(t,e){return s(t,e,i,!1)},"any, SparseMatrix":function(t,e){return a(e,t,i,!0)},"any, DenseMatrix":function(t,e){return s(e,t,i,!0)},"Array, any":function(t,e){return s(r(t),e,i,!1).valueOf()},"any, Array":function(t,e){return s(r(e),t,i,!0).valueOf()},"any, any":i,"any, any, ...any":e.referToSelf((t=>(e,r,n)=>{for(var i=t(e,r),o=0;o<n.length;o++)i=t(i,n[o]);return i}))})})),iu=un("sqrt",["config","typed","Complex"],(t=>{var{config:e,typed:r,Complex:n}=t;return r("sqrt",{number:i,Complex:function(t){return t.sqrt()},BigNumber:function(t){return!t.isNegative()||e.predictable?t.sqrt():i(t.toNumber())},Unit:function(t){return t.pow(.5)}});function i(t){return isNaN(t)?NaN:t>=0||e.predictable?Math.sqrt(t):new n(t,0).sqrt()}})),ou="subtract",uu=un(ou,["typed","matrix","equalScalar","addScalar","unaryMinus","DenseMatrix","concat"],(t=>{var{typed:e,matrix:r,equalScalar:n,addScalar:i,unaryMinus:o,DenseMatrix:u,concat:a}=t,s=$o({typed:e}),f=Qo({typed:e}),h=tu({typed:e,equalScalar:n}),c=Ho({typed:e,DenseMatrix:u}),l=Zo({typed:e,DenseMatrix:u}),p=Wo({typed:e,matrix:r,concat:a});return e(ou,{"number, number":(t,e)=>t-e,"Complex, Complex":(t,e)=>t.sub(e),"BigNumber, BigNumber":(t,e)=>t.minus(e),"Fraction, Fraction":(t,e)=>t.sub(e),"Unit, Unit":e.referToSelf((t=>(r,n)=>{if(null===r.value)throw new Error("Parameter x contains a unit with undefined value");if(null===n.value)throw new Error("Parameter y contains a unit with undefined value");if(!r.equalBase(n))throw new Error("Units do not match");var i=r.clone();return i.value=e.find(t,[i.valueType(),n.valueType()])(i.value,n.value),i.fixPrefix=!1,i}))},p({SS:h,DS:s,SD:f,Ss:l,sS:c}))})),au=un("matAlgo09xS0Sf",["typed","equalScalar"],(t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i){var o=t._values,u=t._index,a=t._ptr,s=t._size,f=t._datatype,h=n._values,c=n._index,l=n._ptr,p=n._size,m=n._datatype;if(s.length!==p.length)throw new Zr(s.length,p.length);if(s[0]!==p[0]||s[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+p+")");var d,g=s[0],w=s[1],D=r,v=0,y=i;"string"==typeof f&&f===m&&(d=f,D=e.find(r,[d,d]),v=e.convert(0,d),y=e.find(i,[d,d]));var E,x,b,A,F,C=o&&h?[]:void 0,M=[],S=[],N=C?[]:void 0,_=[];for(x=0;x<w;x++){S[x]=M.length;var B=x+1;if(N)for(A=l[x],F=l[x+1],b=A;b<F;b++)_[E=c[b]]=B,N[E]=h[b];for(A=a[x],F=a[x+1],b=A;b<F;b++)if(E=u[b],N){var z=_[E]===B?N[E]:v,T=y(o[b],z);D(T,v)||(M.push(E),C.push(T))}else M.push(E)}return S[w]=M.length,t.createSparseMatrix({values:C,index:M,ptr:S,size:[g,w],datatype:d})}})),su="dotMultiply",fu=un(su,["typed","matrix","equalScalar","multiplyScalar","concat"],(t=>{var{typed:e,matrix:r,equalScalar:n,multiplyScalar:i,concat:o}=t,u=Ko({typed:e,equalScalar:n}),a=au({typed:e,equalScalar:n}),s=Lo({typed:e,equalScalar:n}),f=Wo({typed:e,matrix:r,concat:o});return e(su,f({elop:i,SS:a,DS:u,Ss:s}))})),hu=un("matAlgo07xSSf",["typed","DenseMatrix"],(t=>{var{typed:e,DenseMatrix:r}=t;return function(t,i,o){var u=t._size,a=t._datatype,s=i._size,f=i._datatype;if(u.length!==s.length)throw new Zr(u.length,s.length);if(u[0]!==s[0]||u[1]!==s[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+s+")");var h,c,l,p=u[0],m=u[1],d=0,g=o;"string"==typeof a&&a===f&&(h=a,d=e.convert(0,h),g=e.find(o,[h,h]));var w=[];for(c=0;c<p;c++)w[c]=[];var D=[],v=[],y=[],E=[];for(l=0;l<m;l++){var x=l+1;for(n(t,l,y,D,x),n(i,l,E,v,x),c=0;c<p;c++){var b=y[c]===x?D[c]:d,A=E[c]===x?v[c]:d;w[c][l]=g(b,A)}}return new r({data:w,size:[p,m],datatype:h})};function n(t,e,r,n,i){for(var o=t._values,u=t._index,a=t._ptr,s=a[e],f=a[e+1];s<f;s++){var h=u[s];r[h]=i,n[h]=o[s]}}})),cu="conj",lu=un(cu,["typed"],(t=>{var{typed:e}=t;return e(cu,{"number | BigNumber | Fraction":t=>t,Complex:t=>t.conjugate(),"Array | Matrix":e.referToSelf((t=>e=>mo(e,t)))})})),pu="concat",mu=un(pu,["typed","matrix","isInteger"],(t=>{var{typed:e,matrix:r,isInteger:n}=t;return e(pu,{"...Array | Matrix | number | BigNumber":function(t){var e,i,o=t.length,u=-1,a=!1,s=[];for(e=0;e<o;e++){var f=t[e];if(je(f)&&(a=!0),ze(f)||Te(f)){if(e!==o-1)throw new Error("Dimension must be specified as last argument");if(i=u,u=f.valueOf(),!n(u))throw new TypeError("Integer number expected for dimension");if(u<0||e>0&&u>i)throw new Xr(u,i+1)}else{var h=Dr(f).valueOf(),c=$r(h);if(s[e]=h,i=u,u=c.length-1,e>0&&u!==i)throw new Zr(i+1,u+1)}}if(0===s.length)throw new SyntaxError("At least one matrix expected");for(var l=s.shift();s.length;)l=du(l,s.shift(),u,0);return a?r(l):l},"...string":function(t){return t.join("")}})}));function du(t,e,r,n){if(n<r){if(t.length!==e.length)throw new Zr(t.length,e.length);for(var i=[],o=0;o<t.length;o++)i[o]=du(t[o],e[o],r,n+1);return i}return t.concat(e)}var gu="diag",wu=un(gu,["typed","matrix","DenseMatrix","SparseMatrix"],(t=>{var{typed:e,matrix:r,DenseMatrix:n,SparseMatrix:i}=t;return e(gu,{Array:function(t){return o(t,0,$r(t),null)},"Array, number":function(t,e){return o(t,e,$r(t),null)},"Array, BigNumber":function(t,e){return o(t,e.toNumber(),$r(t),null)},"Array, string":function(t,e){return o(t,0,$r(t),e)},"Array, number, string":function(t,e,r){return o(t,e,$r(t),r)},"Array, BigNumber, string":function(t,e,r){return o(t,e.toNumber(),$r(t),r)},Matrix:function(t){return o(t,0,t.size(),t.storage())},"Matrix, number":function(t,e){return o(t,e,t.size(),t.storage())},"Matrix, BigNumber":function(t,e){return o(t,e.toNumber(),t.size(),t.storage())},"Matrix, string":function(t,e){return o(t,0,t.size(),e)},"Matrix, number, string":function(t,e,r){return o(t,e,t.size(),r)},"Matrix, BigNumber, string":function(t,e,r){return o(t,e.toNumber(),t.size(),r)}});function o(t,e,o,u){if(!_r(e))throw new TypeError("Second parameter in function diag must be an integer");var a=e>0?e:0,s=e<0?-e:0;switch(o.length){case 1:return function(t,e,r,o,u,a){var s=[o+u,o+a];if(r&&"sparse"!==r&&"dense"!==r)throw new TypeError("Unknown matrix type ".concat(r,'"'));var f="sparse"===r?i.diagonal(s,t,e):n.diagonal(s,t,e);return null!==r?f:f.valueOf()}(t,e,u,o[0],s,a);case 2:return function(t,e,n,i,o,u){if(je(t)){var a=t.diagonal(e);return null!==n?n!==a.storage()?r(a,n):a:a.valueOf()}for(var s=Math.min(i[0]-o,i[1]-u),f=[],h=0;h<s;h++)f[h]=t[h+o][h+u];return null!==n?r(f):f}(t,e,u,o,s,a)}throw new RangeError("Matrix for function diag must be 2 dimensional")}})),Du="flatten",vu=un(Du,["typed","matrix"],(t=>{var{typed:e,matrix:r}=t;return e(Du,{Array:function(t){return nn(t)},Matrix:function(t){var e=nn(t.toArray());return r(e)}})})),yu="identity",Eu=un(yu,["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],(t=>{var{typed:e,config:r,matrix:n,BigNumber:i,DenseMatrix:o,SparseMatrix:u}=t;return e(yu,{"":function(){return"Matrix"===r.matrix?n([]):[]},string:function(t){return n(t)},"number | BigNumber":function(t){return s(t,t,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber, string":function(t,e){return s(t,t,e)},"number | BigNumber, number | BigNumber":function(t,e){return s(t,e,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(t,e,r){return s(t,e,r)},Array:function(t){return a(t)},"Array, string":function(t,e){return a(t,e)},Matrix:function(t){return a(t.valueOf(),t.storage())},"Matrix, string":function(t,e){return a(t.valueOf(),e)}});function a(t,e){switch(t.length){case 0:return e?n(e):[];case 1:return s(t[0],t[0],e);case 2:return s(t[0],t[1],e);default:throw new Error("Vector containing two values expected")}}function s(t,e,r){var n=Te(t)||Te(e)?i:null;if(Te(t)&&(t=t.toNumber()),Te(e)&&(e=e.toNumber()),!_r(t)||t<1)throw new Error("Parameters in function identity must be positive integers");if(!_r(e)||e<1)throw new Error("Parameters in function identity must be positive integers");var a=n?new i(1):1,s=n?new n(0):0,f=[t,e];if(r){if("sparse"===r)return u.diagonal(f,a,0,s);if("dense"===r)return o.diagonal(f,a,0,s);throw new TypeError('Unknown matrix type "'.concat(r,'"'))}for(var h=Jr([],f,s),c=t<e?t:e,l=0;l<c;l++)h[l][l]=a;return h}})),xu=un("ones",["typed","config","matrix","BigNumber"],(t=>{var{typed:e,config:r,matrix:n,BigNumber:i}=t;return e("ones",{"":function(){return"Array"===r.matrix?o([]):o([],"default")},"...number | BigNumber | string":function(t){if("string"==typeof t[t.length-1]){var e=t.pop();return o(t,e)}return"Array"===r.matrix?o(t):o(t,"default")},Array:o,Matrix:function(t){var e=t.storage();return o(t.valueOf(),e)},"Array | Matrix, string":function(t,e){return o(t.valueOf(),e)}});function o(t,e){var r=function(t){var e=!1;return t.forEach((function(t,r,n){Te(t)&&(e=!0,n[r]=t.toNumber())})),e}(t),o=r?new i(1):1;if(function(t){t.forEach((function(t){if("number"!=typeof t||!_r(t)||t<0)throw new Error("Parameters in function ones must be positive integers")}))}(t),e){var u=n(e);return t.length>0?u.resize(t,o):u}var a=[];return t.length>0?Jr(a,t,o):a}}));function bu(){throw new Error('No "bignumber" implementation available')}function Au(){throw new Error('No "fraction" implementation available')}var Fu="reshape",Cu=un(Fu,["typed","isInteger","matrix"],(t=>{var{typed:e,isInteger:r}=t;return e(Fu,{"Matrix, Array":function(t,e){return t.reshape(e,!0)},"Array, Array":function(t,e){return e.forEach((function(t){if(!r(t))throw new TypeError("Invalid size for dimension: "+t)})),Kr(t,e)}})})),Mu="size",Su=un(Mu,["typed","config","?matrix"],(t=>{var{typed:e,config:r,matrix:n}=t;return e(Mu,{Matrix:function(t){return t.create(t.size())},Array:$r,string:function(t){return"Array"===r.matrix?[t.length]:n([t.length])},"number | Complex | BigNumber | Unit | boolean | null":function(t){return"Array"===r.matrix?[]:n?n([]):function(){throw new Error('No "matrix" implementation available')}()}})})),Nu="transpose",_u=un(Nu,["typed","matrix"],(t=>{var{typed:e,matrix:r}=t;return e(Nu,{Array:t=>n(r(t)).valueOf(),Matrix:n,any:Dr});function n(t){var e,r=t.size();switch(r.length){case 1:e=t.clone();break;case 2:var n=r[0],i=r[1];if(0===i)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+Ur(r)+")");switch(t.storage()){case"dense":e=function(t,e,r){for(var n,i=t._data,o=[],u=0;u<r;u++){n=o[u]=[];for(var a=0;a<e;a++)n[a]=Dr(i[a][u])}return t.createDenseMatrix({data:o,size:[r,e],datatype:t._datatype})}(t,n,i);break;case"sparse":e=function(t,e,r){for(var n,i,o,u=t._values,a=t._index,s=t._ptr,f=u?[]:void 0,h=[],c=[],l=[],p=0;p<e;p++)l[p]=0;for(n=0,i=a.length;n<i;n++)l[a[n]]++;for(var m=0,d=0;d<e;d++)c.push(m),m+=l[d],l[d]=c[d];for(c.push(m),o=0;o<r;o++)for(var g=s[o],w=s[o+1],D=g;D<w;D++){var v=l[a[D]]++;h[v]=o,u&&(f[v]=Dr(u[D]))}return t.createSparseMatrix({values:f,index:h,ptr:c,size:[r,e],datatype:t._datatype})}(t,n,i)}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+Ur(r)+")")}return e}}));function Bu(t,e,r){var n;return-1!==String(t).indexOf("Unexpected type")?(n=arguments.length>2?" (type: "+wr(r)+", value: "+JSON.stringify(r)+")":" (type: "+t.data.actual+")",new TypeError("Cannot calculate "+e+", unexpected type of argument"+n)):-1!==String(t).indexOf("complex numbers")?(n=arguments.length>2?" (type: "+wr(r)+", value: "+JSON.stringify(r)+")":"",new TypeError("Cannot calculate "+e+", no ordering relation is defined for complex numbers"+n)):t}var zu=un("numeric",["number","?bignumber","?fraction"],(t=>{var{number:e,bignumber:r,fraction:n}=t,i={string:!0,number:!0,BigNumber:!0,Fraction:!0},o={number:t=>e(t),BigNumber:r?t=>r(t):bu,Fraction:n?t=>n(t):Au};return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number";if(void 0!==(arguments.length>2?arguments[2]:void 0))throw new SyntaxError("numeric() takes one or two arguments");var r=wr(t);if(!(r in i))throw new TypeError("Cannot convert "+t+' of type "'+r+'"; valid input types are '+Object.keys(i).join(", "));if(!(e in o))throw new TypeError("Cannot convert "+t+' to type "'+e+'"; valid output types are '+Object.keys(o).join(", "));return e===r?t:o[e](t)}})),Tu="divideScalar",Ou=un(Tu,["typed","numeric"],(t=>{var{typed:e,numeric:r}=t;return e(Tu,{"number, number":function(t,e){return t/e},"Complex, Complex":function(t,e){return t.div(e)},"BigNumber, BigNumber":function(t,e){return t.div(e)},"Fraction, Fraction":function(t,e){return t.div(e)},"Unit, number | Complex | Fraction | BigNumber | Unit":(t,e)=>t.divide(e),"number | Fraction | Complex | BigNumber, Unit":(t,e)=>e.divideInto(t)})})),ku=un("pow",["typed","config","identity","multiply","matrix","inv","fraction","number","Complex"],(t=>{var{typed:e,config:r,identity:n,multiply:i,matrix:o,inv:u,number:a,fraction:s,Complex:f}=t;return e("pow",{"number, number":h,"Complex, Complex":function(t,e){return t.pow(e)},"BigNumber, BigNumber":function(t,e){return e.isInteger()||t>=0||r.predictable?t.pow(e):new f(t.toNumber(),0).pow(e.toNumber(),0)},"Fraction, Fraction":function(t,e){var n=t.pow(e);if(null!=n)return n;if(r.predictable)throw new Error("Result of pow is non-rational and cannot be expressed as a fraction");return h(t.valueOf(),e.valueOf())},"Array, number":c,"Array, BigNumber":function(t,e){return c(t,e.toNumber())},"Matrix, number":l,"Matrix, BigNumber":function(t,e){return l(t,e.toNumber())},"Unit, number | BigNumber":function(t,e){return t.pow(e)}});function h(t,e){if(r.predictable&&!_r(e)&&t<0)try{var n=s(e),i=a(n);if((e===i||Math.abs((e-i)/e)<1e-14)&&n.d%2==1)return(n.n%2==0?1:-1)*Math.pow(-t,e)}catch(t){}return r.predictable&&(t<-1&&e===1/0||t>-1&&t<0&&e===-1/0)?NaN:_r(e)||t>=0||r.predictable?Fo(t,e):t*t<1&&e===1/0||t*t>1&&e===-1/0?0:new f(t,0).pow(e,0)}function c(t,e){if(!_r(e))throw new TypeError("For A^b, b must be an integer (value is "+e+")");var r=$r(t);if(2!==r.length)throw new Error("For A^b, A must be 2 dimensional (A has "+r.length+" dimensions)");if(r[0]!==r[1])throw new Error("For A^b, A must be square (size is "+r[0]+"x"+r[1]+")");if(e<0)try{return c(u(t),-e)}catch(t){if("Cannot calculate inverse, determinant is zero"===t.message)throw new TypeError("For A^b, when A is not invertible, b must be a positive integer (value is "+e+")");throw t}for(var o=n(r[0]).valueOf(),a=t;e>=1;)1==(1&e)&&(o=i(a,o)),e>>=1,a=i(a,a);return o}function l(t,e){return o(c(t.valueOf(),e))}})),Iu="dotPow",Ru=un(Iu,["typed","equalScalar","matrix","pow","DenseMatrix","concat"],(t=>{var{typed:e,equalScalar:r,matrix:n,pow:i,DenseMatrix:o,concat:u}=t,a=Qo({typed:e}),s=hu({typed:e,DenseMatrix:o}),f=Lo({typed:e,equalScalar:r}),h=Zo({typed:e,DenseMatrix:o}),c=Wo({typed:e,matrix:n,concat:u}),l={};for(var p in i.signatures)Object.prototype.hasOwnProperty.call(i.signatures,p)&&(p.includes("Matrix")||p.includes("Array")||(l[p]=i.signatures[p]));var m=e(l);return e(Iu,c({elop:m,SS:s,DS:a,Ss:f,sS:h}))})),Pu="dotDivide",ju=un(Pu,["typed","matrix","equalScalar","divideScalar","DenseMatrix","concat"],(t=>{var{typed:e,matrix:r,equalScalar:n,divideScalar:i,DenseMatrix:o,concat:u}=t,a=Ko({typed:e,equalScalar:n}),s=Qo({typed:e}),f=hu({typed:e,DenseMatrix:o}),h=Lo({typed:e,equalScalar:n}),c=Zo({typed:e,DenseMatrix:o}),l=Wo({typed:e,matrix:r,concat:u});return e(Pu,l({elop:i,SS:f,DS:s,SD:a,Ss:h,sS:c}))})),qu="equal",Vu=un(qu,["typed","matrix","equalScalar","DenseMatrix","concat"],(t=>{var{typed:e,matrix:r,equalScalar:n,DenseMatrix:i,concat:o}=t,u=Qo({typed:e}),a=hu({typed:e,DenseMatrix:i}),s=Zo({typed:e,DenseMatrix:i}),f=Wo({typed:e,matrix:r,concat:o});return e(qu,Uu({typed:e,equalScalar:n}),f({elop:n,SS:a,DS:u,Ss:s}))})),Uu=un(qu,["typed","equalScalar"],(t=>{var{typed:e,equalScalar:r}=t;return e(qu,{"any, any":function(t,e){return null===t?null===e:null===e?null===t:void 0===t?void 0===e:void 0===e?void 0===t:r(t,e)}})})),Lu="deepEqual",Zu=un(Lu,["typed","equal"],(t=>{var{typed:e,equal:r}=t;return e(Lu,{"any, any":function(t,e){return n(t.valueOf(),e.valueOf())}});function n(t,e){if(Array.isArray(t)){if(Array.isArray(e)){var i=t.length;if(i!==e.length)return!1;for(var o=0;o<i;o++)if(!n(t[o],e[o]))return!1;return!0}return!1}return!Array.isArray(e)&&r(t,e)}})),Xu=un("add",["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],(t=>{var{typed:e,matrix:r,addScalar:n,equalScalar:i,DenseMatrix:o,SparseMatrix:u,concat:a}=t,s=$o({typed:e}),f=Yo({typed:e,equalScalar:i}),h=Ho({typed:e,DenseMatrix:o}),c=Wo({typed:e,matrix:r,concat:a});return e("add",{"any, any":n,"any, any, ...any":e.referToSelf((t=>(e,r,n)=>{for(var i=t(e,r),o=0;o<n.length;o++)i=t(i,n[o]);return i}))},c({elop:n,DS:s,SS:f,Ss:h}))})),$u=un("dot",["typed","addScalar","multiplyScalar","conj","size"],(t=>{var{typed:e,addScalar:r,multiplyScalar:n,conj:i,size:o}=t;return e("dot",{"Array | DenseMatrix, Array | DenseMatrix":function(t,o){var s=u(t,o),f=je(t)?t._data:t,h=je(t)?t._datatype:void 0,c=je(o)?o._data:o,l=je(o)?o._datatype:void 0,p=2===a(t).length,m=2===a(o).length,d=r,g=n;if(h&&l&&h===l&&"string"==typeof h){var w=h;d=e.find(r,[w,w]),g=e.find(n,[w,w])}if(!p&&!m){for(var D=g(i(f[0]),c[0]),v=1;v<s;v++)D=d(D,g(i(f[v]),c[v]));return D}if(!p&&m){for(var y=g(i(f[0]),c[0][0]),E=1;E<s;E++)y=d(y,g(i(f[E]),c[E][0]));return y}if(p&&!m){for(var x=g(i(f[0][0]),c[0]),b=1;b<s;b++)x=d(x,g(i(f[b][0]),c[b]));return x}if(p&&m){for(var A=g(i(f[0][0]),c[0][0]),F=1;F<s;F++)A=d(A,g(i(f[F][0]),c[F][0]));return A}},"SparseMatrix, SparseMatrix":function(t,e){u(t,e);var i=t._index,o=t._values,a=e._index,s=e._values,f=0,h=r,c=n,l=0,p=0;for(;l<i.length&&p<a.length;){var m=i[l],d=a[p];m<d?l++:m>d?p++:m===d&&(f=h(f,c(o[l],s[p])),l++,p++)}return f}});function u(t,e){var r,n,i=a(t),o=a(e);if(1===i.length)r=i[0];else{if(2!==i.length||1!==i[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+i.join(", ")+")");r=i[0]}if(1===o.length)n=o[0];else{if(2!==o.length||1!==o[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+o.join(", ")+")");n=o[0]}if(r!==n)throw new RangeError("Vectors must have equal length ("+r+" != "+n+")");if(0===r)throw new RangeError("Cannot calculate the dot product of empty vectors");return r}function a(t){return je(t)?t.size():o(t)}})),Yu=un("det",["typed","matrix","subtract","multiply","divideScalar","isZero","unaryMinus"],(t=>{var{typed:e,matrix:r,subtract:n,multiply:i,divideScalar:o,isZero:u,unaryMinus:a}=t;return e("det",{any:function(t){return Dr(t)},"Array | Matrix":function(t){var e;switch((e=je(t)?t.size():Array.isArray(t)?(t=r(t)).size():[]).length){case 0:return Dr(t);case 1:if(1===e[0])return Dr(t.valueOf()[0]);if(0===e[0])return 1;throw new RangeError("Matrix must be square (size: "+Ur(e)+")");case 2:var s=e[0],f=e[1];if(s===f)return function(t,e,r){if(1===e)return Dr(t[0][0]);if(2===e)return n(i(t[0][0],t[1][1]),i(t[1][0],t[0][1]));for(var s=!1,f=new Array(e).fill(0).map(((t,e)=>e)),h=0;h<e;h++){var c=f[h];if(u(t[c][h])){var l=void 0;for(l=h+1;l<e;l++)if(!u(t[f[l]][h])){c=f[l],f[l]=f[h],f[h]=c,s=!s;break}if(l===e)return t[c][h]}for(var p=t[c][h],m=0===h?1:t[f[h-1]][h-1],d=h+1;d<e;d++)for(var g=f[d],w=h+1;w<e;w++)t[g][w]=o(n(i(t[g][w],p),i(t[g][h],t[c][w])),m)}var D=t[f[e-1]][e-1];return s?a(D):D}(t.clone().valueOf(),s);if(0===f)return 1;throw new RangeError("Matrix must be square (size: "+Ur(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+Ur(e)+")")}}})})),Hu=un("inv",["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],(t=>{var{typed:e,matrix:r,divideScalar:n,addScalar:i,multiply:o,unaryMinus:u,det:a,identity:s,abs:f}=t;return e("inv",{"Array | Matrix":function(t){var e=je(t)?t.size():$r(t);switch(e.length){case 1:if(1===e[0])return je(t)?r([n(1,t.valueOf()[0])]):[n(1,t[0])];throw new RangeError("Matrix must be square (size: "+Ur(e)+")");case 2:var i=e[0],o=e[1];if(i===o)return je(t)?r(h(t.valueOf(),i,o),t.storage()):h(t,i,o);throw new RangeError("Matrix must be square (size: "+Ur(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+Ur(e)+")")}},any:function(t){return n(1,t)}});function h(t,e,r){var h,c,l,p,m;if(1===e){if(0===(p=t[0][0]))throw Error("Cannot calculate inverse, determinant is zero");return[[n(1,p)]]}if(2===e){var d=a(t);if(0===d)throw Error("Cannot calculate inverse, determinant is zero");return[[n(t[1][1],d),n(u(t[0][1]),d)],[n(u(t[1][0]),d),n(t[0][0],d)]]}var g=t.concat();for(h=0;h<e;h++)g[h]=g[h].concat();for(var w=s(e).valueOf(),D=0;D<r;D++){var v=f(g[D][D]),y=D;for(h=D+1;h<e;)f(g[h][D])>v&&(v=f(g[h][D]),y=h),h++;if(0===v)throw Error("Cannot calculate inverse, determinant is zero");(h=y)!==D&&(m=g[D],g[D]=g[h],g[h]=m,m=w[D],w[D]=w[h],w[h]=m);var E=g[D],x=w[D];for(h=0;h<e;h++){var b=g[h],A=w[h];if(h!==D){if(0!==b[D]){for(l=n(u(b[D]),E[D]),c=D;c<r;c++)b[c]=i(b[c],o(l,E[c]));for(c=0;c<r;c++)A[c]=i(A[c],o(l,x[c]))}}else{for(l=E[D],c=D;c<r;c++)b[c]=n(b[c],l);for(c=0;c<r;c++)A[c]=n(A[c],l)}}}return w}})),Gu="distance",Ju=un(Gu,["typed","addScalar","subtract","divideScalar","multiplyScalar","deepEqual","sqrt","abs"],(t=>{var{typed:e,addScalar:r,subtract:n,multiplyScalar:i,divideScalar:o,deepEqual:u,sqrt:a,abs:s}=t;return e(Gu,{"Array, Array, Array":function(t,e,r){if(2===t.length&&2===e.length&&2===r.length){if(!h(t))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!h(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!h(r))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(u(e,r))throw new TypeError("LinePoint1 should not be same with LinePoint2");var o=n(r[1],e[1]),a=n(e[0],r[0]),s=n(i(r[0],e[1]),i(e[0],r[1]));return d(t[0],t[1],o,a,s)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object, Object":function(t,e,r){if(2===Object.keys(t).length&&2===Object.keys(e).length&&2===Object.keys(r).length){if(!h(t))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!h(e))throw new TypeError("Values of lineOnePtX and lineOnePtY should be numbers or BigNumbers");if(!h(r))throw new TypeError("Values of lineTwoPtX and lineTwoPtY should be numbers or BigNumbers");if(u(m(e),m(r)))throw new TypeError("LinePoint1 should not be same with LinePoint2");if("pointX"in t&&"pointY"in t&&"lineOnePtX"in e&&"lineOnePtY"in e&&"lineTwoPtX"in r&&"lineTwoPtY"in r){var o=n(r.lineTwoPtY,e.lineOnePtY),a=n(e.lineOnePtX,r.lineTwoPtX),s=n(i(r.lineTwoPtX,e.lineOnePtY),i(e.lineOnePtX,r.lineTwoPtY));return d(t.pointX,t.pointY,o,a,s)}throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},"Array, Array":function(t,e){if(2===t.length&&3===e.length){if(!h(t))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!c(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");return d(t[0],t[1],e[0],e[1],e[2])}if(3===t.length&&6===e.length){if(!c(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!p(e))throw new TypeError("Array with 6 numbers or BigNumbers expected for second argument");return g(t[0],t[1],t[2],e[0],e[1],e[2],e[3],e[4],e[5])}if(t.length===e.length&&t.length>0){if(!l(t))throw new TypeError("All values of an array should be numbers or BigNumbers");if(!l(e))throw new TypeError("All values of an array should be numbers or BigNumbers");return w(t,e)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object":function(t,e){if(2===Object.keys(t).length&&3===Object.keys(e).length){if(!h(t))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!c(e))throw new TypeError("Values of xCoeffLine, yCoeffLine and constant should be numbers or BigNumbers");if("pointX"in t&&"pointY"in t&&"xCoeffLine"in e&&"yCoeffLine"in e&&"constant"in e)return d(t.pointX,t.pointY,e.xCoeffLine,e.yCoeffLine,e.constant);throw new TypeError("Key names do not match")}if(3===Object.keys(t).length&&6===Object.keys(e).length){if(!c(t))throw new TypeError("Values of pointX, pointY and pointZ should be numbers or BigNumbers");if(!p(e))throw new TypeError("Values of x0, y0, z0, a, b and c should be numbers or BigNumbers");if("pointX"in t&&"pointY"in t&&"x0"in e&&"y0"in e&&"z0"in e&&"a"in e&&"b"in e&&"c"in e)return g(t.pointX,t.pointY,t.pointZ,e.x0,e.y0,e.z0,e.a,e.b,e.c);throw new TypeError("Key names do not match")}if(2===Object.keys(t).length&&2===Object.keys(e).length){if(!h(t))throw new TypeError("Values of pointOneX and pointOneY should be numbers or BigNumbers");if(!h(e))throw new TypeError("Values of pointTwoX and pointTwoY should be numbers or BigNumbers");if("pointOneX"in t&&"pointOneY"in t&&"pointTwoX"in e&&"pointTwoY"in e)return w([t.pointOneX,t.pointOneY],[e.pointTwoX,e.pointTwoY]);throw new TypeError("Key names do not match")}if(3===Object.keys(t).length&&3===Object.keys(e).length){if(!c(t))throw new TypeError("Values of pointOneX, pointOneY and pointOneZ should be numbers or BigNumbers");if(!c(e))throw new TypeError("Values of pointTwoX, pointTwoY and pointTwoZ should be numbers or BigNumbers");if("pointOneX"in t&&"pointOneY"in t&&"pointOneZ"in t&&"pointTwoX"in e&&"pointTwoY"in e&&"pointTwoZ"in e)return w([t.pointOneX,t.pointOneY,t.pointOneZ],[e.pointTwoX,e.pointTwoY,e.pointTwoZ]);throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},Array:function(t){if(!function(t){if(2===t[0].length&&f(t[0][0])&&f(t[0][1])){if(t.some((t=>2!==t.length||!f(t[0])||!f(t[1]))))return!1}else{if(!(3===t[0].length&&f(t[0][0])&&f(t[0][1])&&f(t[0][2])))return!1;if(t.some((t=>3!==t.length||!f(t[0])||!f(t[1])||!f(t[2]))))return!1}return!0}(t))throw new TypeError("Incorrect array format entered for pairwise distance calculation");return function(t){for(var e=[],r=[],n=[],i=0;i<t.length-1;i++)for(var o=i+1;o<t.length;o++)2===t[0].length?(r=[t[i][0],t[i][1]],n=[t[o][0],t[o][1]]):3===t[0].length&&(r=[t[i][0],t[i][1],t[i][2]],n=[t[o][0],t[o][1],t[o][2]]),e.push(w(r,n));return e}(t)}});function f(t){return"number"==typeof t||Te(t)}function h(t){return t.constructor!==Array&&(t=m(t)),f(t[0])&&f(t[1])}function c(t){return t.constructor!==Array&&(t=m(t)),f(t[0])&&f(t[1])&&f(t[2])}function l(t){return Array.isArray(t)||(t=m(t)),t.every(f)}function p(t){return t.constructor!==Array&&(t=m(t)),f(t[0])&&f(t[1])&&f(t[2])&&f(t[3])&&f(t[4])&&f(t[5])}function m(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;n++)r.push(t[e[n]]);return r}function d(t,e,n,u,f){var h=s(r(r(i(n,t),i(u,e)),f)),c=a(r(i(n,n),i(u,u)));return o(h,c)}function g(t,e,u,s,f,h,c,l,p){var m=[n(i(n(f,e),p),i(n(h,u),l)),n(i(n(h,u),c),i(n(s,t),p)),n(i(n(s,t),l),i(n(f,e),c))];m=a(r(r(i(m[0],m[0]),i(m[1],m[1])),i(m[2],m[2])));var d=a(r(r(i(c,c),i(l,l)),i(p,p)));return o(m,d)}function w(t,e){for(var o=t.length,u=0,s=0,f=0;f<o;f++)s=n(t[f],e[f]),u=r(i(s,s),u);return a(u)}})),Wu=un("sum",["typed","config","add","numeric"],(t=>{var{typed:e,config:r,add:n,numeric:i}=t;return e("sum",{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(t,e){try{var r=function(t,e,r){var n=Array.isArray(t)?$r(t):t.size();if(e<0||e>=n.length)throw new Xr(e,n.length);return je(t)?t.create(go(t.valueOf(),e,r)):go(t,e,r)}(t,e,n);return r}catch(t){throw Bu(t,"sum")}},"...":function(t){if(function(t){for(var e=0;e<t.length;e++)if(qe(t[e]))return!0;return!1}(t))throw new TypeError("Scalar values expected in function sum");return o(t)}});function o(t){var e;return po(t,(function(t){try{e=void 0===e?t:n(e,t)}catch(e){throw Bu(e,"sum",t)}})),void 0===e&&(e=i(0,r.number)),"string"==typeof e&&(e=i(e,r.number)),e}})),Ku={exports:{}};!function(t,e,r){function n(t){var e=this,r=function(){var t=4022871197,e=function(e){e=String(e);for(var r=0;r<e.length;r++){var n=.02519603282416938*(t+=e.charCodeAt(r));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)};return e}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=r(" "),e.s1=r(" "),e.s2=r(" "),e.s0-=r(t),e.s0<0&&(e.s0+=1),e.s1-=r(t),e.s1<0&&(e.s1+=1),e.s2-=r(t),e.s2<0&&(e.s2+=1),r=null}function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function o(t,e){var r=new n(t),o=e&&e.state,u=r.next;return u.int32=function(){return 4294967296*r.next()|0},u.double=function(){return u()+11102230246251565e-32*(2097152*u()|0)},u.quick=u,o&&("object"==typeof o&&i(o,r),u.state=function(){return i(r,{})}),u}e&&e.exports?e.exports=o:r&&r.amd?r((function(){return o})):this.alea=o}(0,Ku,!1);var Qu=Ku.exports,ta={exports:{}};!function(t,e,r){function n(t){var e=this,r="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function o(t,e){var r=new n(t),o=e&&e.state,u=function(){return(r.next()>>>0)/4294967296};return u.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},u.int32=r.next,u.quick=u,o&&("object"==typeof o&&i(o,r),u.state=function(){return i(r,{})}),u}e&&e.exports?e.exports=o:r&&r.amd?r((function(){return o})):this.xor128=o}(0,ta,!1);var ea=ta.exports,ra={exports:{}};!function(t,e,r){function n(t){var e=this,r="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),n==r.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function o(t,e){var r=new n(t),o=e&&e.state,u=function(){return(r.next()>>>0)/4294967296};return u.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},u.int32=r.next,u.quick=u,o&&("object"==typeof o&&i(o,r),u.state=function(){return i(r,{})}),u}e&&e.exports?e.exports=o:r&&r.amd?r((function(){return o})):this.xorwow=o}(0,ra,!1);var na=ra.exports,ia={exports:{}};!function(t,e,r){function n(t){var e=this;e.next=function(){var t,r,n=e.x,i=e.i;return t=n[i],r=(t^=t>>>7)^t<<24,r^=(t=n[i+1&7])^t>>>10,r^=(t=n[i+3&7])^t>>>3,r^=(t=n[i+4&7])^t<<7,t=n[i+7&7],r^=(t^=t<<13)^t<<9,n[i]=r,e.i=i+1&7,r},function(t,e){var r,n=[];if(e===(0|e))n[0]=e;else for(e=""+e,r=0;r<e.length;++r)n[7&r]=n[7&r]<<15^e.charCodeAt(r)+n[r+1&7]<<13;for(;n.length<8;)n.push(0);for(r=0;r<8&&0===n[r];++r);for(8==r?n[7]=-1:n[r],t.x=n,t.i=0,r=256;r>0;--r)t.next()}(e,t)}function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function o(t,e){null==t&&(t=+new Date);var r=new n(t),o=e&&e.state,u=function(){return(r.next()>>>0)/4294967296};return u.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},u.int32=r.next,u.quick=u,o&&(o.x&&i(o,r),u.state=function(){return i(r,{})}),u}e&&e.exports?e.exports=o:r&&r.amd?r((function(){return o})):this.xorshift7=o}(0,ia,!1);var oa=ia.exports,ua={exports:{}};!function(t,e,r){function n(t){var e=this;e.next=function(){var t,r,n=e.w,i=e.X,o=e.i;return e.w=n=n+1640531527|0,r=i[o+34&127],t=i[o=o+1&127],r^=r<<13,t^=t<<17,r^=r>>>15,t^=t>>>12,r=i[o]=r^t,e.i=o,r+(n^n>>>16)|0},function(t,e){var r,n,i,o,u,a=[],s=128;for(e===(0|e)?(n=e,e=null):(e+="\0",n=0,s=Math.max(s,e.length)),i=0,o=-32;o<s;++o)e&&(n^=e.charCodeAt((o+32)%e.length)),0===o&&(u=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,o>=0&&(u=u+1640531527|0,i=0==(r=a[127&o]^=n+u)?i+1:0);for(i>=128&&(a[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)n=a[i+34&127],r=a[i=i+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,a[i]=n^r;t.w=u,t.X=a,t.i=i}(e,t)}function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function o(t,e){null==t&&(t=+new Date);var r=new n(t),o=e&&e.state,u=function(){return(r.next()>>>0)/4294967296};return u.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},u.int32=r.next,u.quick=u,o&&(o.X&&i(o,r),u.state=function(){return i(r,{})}),u}e&&e.exports?e.exports=o:r&&r.amd?r((function(){return o})):this.xor4096=o}(0,ua,!1);var aa=ua.exports,sa={exports:{}};!function(t,e,r){function n(t){var e=this,r="";e.next=function(){var t=e.b,r=e.c,n=e.d,i=e.a;return t=t<<25^t>>>7^r,r=r-n|0,n=n<<24^n>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^r,e.c=r=r-n|0,e.d=n<<16^r>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):r+=t;for(var n=0;n<r.length+20;n++)e.b^=0|r.charCodeAt(n),e.next()}function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function o(t,e){var r=new n(t),o=e&&e.state,u=function(){return(r.next()>>>0)/4294967296};return u.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},u.int32=r.next,u.quick=u,o&&("object"==typeof o&&i(o,r),u.state=function(){return i(r,{})}),u}e&&e.exports?e.exports=o:r&&r.amd?r((function(){return o})):this.tychei=o}(0,sa,!1);var fa=sa.exports,ha={exports:{}};!function(t){!function(e,r,n){var i,o=256,u="random",a=n.pow(o,6),s=n.pow(2,52),f=2*s,h=o-1;function c(t,h,c){var w=[],D=d(m((h=1==h?{entropy:!0}:h||{}).entropy?[t,g(r)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(o):(t=new Uint8Array(o),(e.crypto||e.msCrypto).getRandomValues(t)),g(t)}catch(t){var n=e.navigator,u=n&&n.plugins;return[+new Date,e,u,e.screen,g(r)]}}():t,3),w),v=new l(w),y=function(){for(var t=v.g(6),e=a,r=0;t<s;)t=(t+r)*o,e*=o,r=v.g(1);for(;t>=f;)t/=2,e/=2,r>>>=1;return(t+r)/e};return y.int32=function(){return 0|v.g(4)},y.quick=function(){return v.g(4)/4294967296},y.double=y,d(g(v.S),r),(h.pass||c||function(t,e,r,i){return i&&(i.S&&p(i,v),t.state=function(){return p(v,{})}),r?(n[u]=t,e):t})(y,D,"global"in h?h.global:this==n,h.state)}function l(t){var e,r=t.length,n=this,i=0,u=n.i=n.j=0,a=n.S=[];for(r||(t=[r++]);i<o;)a[i]=i++;for(i=0;i<o;i++)a[i]=a[u=h&u+t[i%r]+(e=a[i])],a[u]=e;(n.g=function(t){for(var e,r=0,i=n.i,u=n.j,a=n.S;t--;)e=a[i=h&i+1],r=r*o+a[h&(a[i]=a[u=h&u+e])+(a[u]=e)];return n.i=i,n.j=u,r})(o)}function p(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){var r,n=[],i=typeof t;if(e&&"object"==i)for(r in t)try{n.push(m(t[r],e-1))}catch(t){}return n.length?n:"string"==i?t:t+"\0"}function d(t,e){for(var r,n=t+"",i=0;i<n.length;)e[h&i]=h&(r^=19*e[h&i])+n.charCodeAt(i++);return g(e)}function g(t){return String.fromCharCode.apply(0,t)}if(d(n.random(),r),t.exports){t.exports=c;try{i=require("crypto")}catch(t){}}else n["seed"+u]=c}("undefined"!=typeof self?self:nt,[],Math)}(ha);var ca=Qu,la=ea,pa=na,ma=oa,da=aa,ga=fa,wa=ha.exports;wa.alea=ca,wa.xor128=la,wa.xorwow=pa,wa.xorshift7=ma,wa.xor4096=da,wa.tychei=ga;var Da=it(wa),va=Da(Date.now());function ya(t){var e,r;return e=null===(r=t)?va:Da(String(r)),function(){return e()}}function Ea(t,e){var r=[];if((t=t.slice(0)).length>1)for(var n=0,i=t.shift();n<i;n++)r.push(Ea(t,e));else for(var o=0,u=t.shift();o<u;o++)r.push(e());return r}var xa="random",ba=un(xa,["typed","config","?on"],(t=>{var{typed:e,config:r,on:n}=t,i=ya(r.randomSeed);return n&&n("config",(function(t,e){t.randomSeed!==e.randomSeed&&(i=ya(t.randomSeed))})),e(xa,{"":()=>u(0,1),number:t=>u(0,t),"number, number":(t,e)=>u(t,e),"Array | Matrix":t=>o(t,0,1),"Array | Matrix, number":(t,e)=>o(t,0,e),"Array | Matrix, number, number":(t,e,r)=>o(t,e,r)});function o(t,e,r){var n=Ea(t.valueOf(),(()=>u(e,r)));return je(t)?t.create(n):n}function u(t,e){return t+i()*(e-t)}})),Aa=no({config:Er}),Fa=uo({}),Ca=fo({}),Ma=ho({}),Sa=lo({Matrix:Ma}),Na=gn({BigNumber:Aa,Complex:Fa,DenseMatrix:Sa,Fraction:Ca}),_a=qo({typed:Na}),Ba=Uo({typed:Na}),za=Oo({BigNumber:Aa,typed:Na}),Ta=lu({typed:Na}),Oa=Bo({config:Er,typed:Na}),ka=Do({typed:Na}),Ia=So({typed:Na}),Ra=eu({typed:Na}),Pa=To({typed:Na}),ja=ba({config:Er,typed:Na}),qa=zo({Matrix:Ma,equalScalar:Oa,typed:Na}),Va=iu({Complex:Fa,config:Er,typed:Na}),Ua=jo({typed:Na}),La=ko({Fraction:Ca,typed:Na}),Za=Ro({DenseMatrix:Sa,Matrix:Ma,SparseMatrix:qa,typed:Na}),Xa=zu({bignumber:za,fraction:La,number:Pa}),$a=Cu({isInteger:ka,matrix:Za,typed:Na}),Ya=Su({matrix:Za,config:Er,typed:Na}),Ha=_u({matrix:Za,typed:Na}),Ga=mu({isInteger:ka,matrix:Za,typed:Na}),Ja=wu({DenseMatrix:Sa,SparseMatrix:qa,matrix:Za,typed:Na}),Wa=Ou({numeric:Xa,typed:Na}),Ka=ju({DenseMatrix:Sa,concat:Ga,divideScalar:Wa,equalScalar:Oa,matrix:Za,typed:Na}),Qa=Vu({DenseMatrix:Sa,concat:Ga,equalScalar:Oa,matrix:Za,typed:Na}),ts=vu({matrix:Za,typed:Na}),es=Eu({BigNumber:Aa,DenseMatrix:Sa,SparseMatrix:qa,config:Er,matrix:Za,typed:Na}),rs=xu({BigNumber:Aa,config:Er,matrix:Za,typed:Na}),ns=Xu({DenseMatrix:Sa,SparseMatrix:qa,addScalar:Ba,concat:Ga,equalScalar:Oa,matrix:Za,typed:Na}),is=Zu({equal:Qa,typed:Na}),os=nu({addScalar:Ba,dot:$u({addScalar:Ba,conj:Ta,multiplyScalar:Ra,size:Ya,typed:Na}),equalScalar:Oa,matrix:Za,multiplyScalar:Ra,typed:Na}),us=uu({DenseMatrix:Sa,addScalar:Ba,concat:Ga,equalScalar:Oa,matrix:Za,typed:Na,unaryMinus:Ua}),as=Yu({divideScalar:Wa,isZero:Ia,matrix:Za,multiply:os,subtract:us,typed:Na,unaryMinus:Ua}),ss=Ju({abs:_a,addScalar:Ba,deepEqual:is,divideScalar:Wa,multiplyScalar:Ra,sqrt:Va,subtract:us,typed:Na}),fs=fu({concat:Ga,equalScalar:Oa,matrix:Za,multiplyScalar:Ra,typed:Na});const hs={add:ns,subtract:us,sum:Wu({add:ns,config:Er,numeric:Xa,typed:Na}),multiply:os,reshape:$a,transpose:Ha,flatten:ts,abs:_a,distance:ss,dotMultiply:fs,dotDivide:Ka,dotPow:Ru({DenseMatrix:Sa,concat:Ga,equalScalar:Oa,matrix:Za,pow:ku({Complex:Fa,config:Er,fraction:La,identity:es,inv:Hu({abs:_a,addScalar:Ba,det:as,divideScalar:Wa,identity:es,matrix:Za,multiply:os,typed:Na,unaryMinus:Ua}),matrix:Za,multiply:os,number:Pa,typed:Na}),typed:Na}),diag:Ja,ones:rs,matrix:Za,random:ja};function cs(t,e,r={}){const n=t=>hs.flatten(hs.transpose(t));r=Object.assign({maxIter:500,maxHalves:20,tolFun:1e-9,init:null},r);const{maxIter:i,maxHalves:o,tolFun:u,init:a}=r;let s=ps(t,t);const f=t.length,h=.5/hs.sum(s);s=hs.add(s,ls(f));const c=hs.dotDivide(1,s);let l=[];a?l=a:t[0].length>t.length?(console.warn("More columns than rows, so initializing using random vectors rather than PCA"),t.forEach((()=>l.push(hs.random([e]))))):l=function(t,e){const r=ft.getEigenVectors(t,e),n=ft.computeAdjustedData(t,...r.slice(0,e)).adjustedData,i=[];for(let r=0;r<t.length;r++)i.push(Array.from({length:e},((t,e)=>n[e][r])));return i}(t,e);const p=hs.ones([t.length,e]);let m=hs.add(ps(l,l),ls(t.length)),d=hs.dotDivide(1,m),g=hs.subtract(s,m),w=hs.sum(hs.dotMultiply(hs.dotPow(g,2),c)),D=null,v=0;for(v=0;v<i;v++){g=hs.subtract(d,c);const r=hs.multiply(g,p),i=hs.subtract(hs.multiply(g,l),hs.dotMultiply(l,r)),a=hs.dotPow(d,3),f=hs.dotPow(l,2),h=hs.multiply(a,f),v=hs.multiply(2,l),y=hs.multiply(a,l),E=hs.dotMultiply(f,hs.multiply(a,p)),x=hs.dotMultiply(v,y),b=hs.add(hs.subtract(hs.subtract(h,r),x),E);let A=hs.subtract(0,hs.dotDivide(n(i.toArray()),hs.abs(n(b.toArray()))));D=l;let F=0,C=null;for(F=0;F<o;F++){const r=hs.transpose(hs.reshape(A,[e,t.length]));if(l=hs.add(D,r),m=hs.add(ps(l,l),ls(t.length)),d=hs.dotDivide(1,m),g=hs.subtract(s,m),C=hs.sum(hs.dotMultiply(hs.dotPow(g,2),c)),C<w)break;A=hs.multiply(A,.5)}if(F==o-1&&console.warn("Warning: maxHalves exceeded. Sammon mapping may not converge..."),Math.abs((w-C)/w)<u)break;w=C}return v==i-1&&console.warn("Warning: maxiter exceeded. Sammon mapping may not have converged..."),w*=h,{vectors:l,E:w}}function ls(t){return hs.diag(hs.ones(t))}function ps(t,e){const r=t.map((t=>[]));for(let n=0;n<t.length;n++)for(let i=0;i<e.length;i++)r[n][i]=hs.distance(t[n],e[i]);return r}function ms(t,e){const r=ft.getEigenVectors(t,e),n=ft.computeAdjustedData(t,...r.slice(0,e)).adjustedData,i=[];for(let r=0;r<t.length;r++)i.push(Array.from({length:e},((t,e)=>n[e][r])));return i}function ds(t,e){const r=new Ne({nNeighbors:Math.min(t.length-1,15)});return r.fit(t),r.getEmbedding()}function gs(t,e){return cs(t,e).vectors}async function ws(t,e,r){const n=new d([e,r]);n.fit(t);const i=n.predict(t);return{centroids:n.weights,embeddedCentroids:n.locations,labels:i}}async function Ds(t,e,r){const n=rt(t,e,{}),i=r(n.centroids,2);return{centroids:n.centroids,embeddedCentroids:i,labels:n.clusters}}async function vs(t,r,n,i=!0){let o=null;if("som"==n){const e=function(t){let e=1,r=t;for(let n=2;n<=Math.sqrt(t);n++)t%n==0&&Math.abs(n-t/n)<Math.abs(e-r)&&(e=n,r=t/n);return[e,r]}(r);o=await ws(t,e[0],e[1])}else if("kmc+pca"==n)o=await Ds(t,r,ms);else if("kmc+umap"==n)o=await Ds(t,r,ds);else{if("kmc+tsne"==n)throw new Error("t-SNE temporarily removed due to security vulnerability in npm package");if("kmc+sammon"!=n)throw new Error("Invalid method "+n);o=await Ds(t,r,gs)}if(i){const t=e(o.embeddedCentroids,(t=>t[0])),r=e(o.embeddedCentroids,(t=>t[1]));if(null!=t[0]){const e=(t[0]+t[1])/2;for(const r of o.embeddedCentroids)r[0]=(r[0]-e)/(t[1]-t[0])}if(null!=r[0]){const t=(r[0]+r[1])/2;for(const e of o.embeddedCentroids)e[1]=(e[1]-t)/(r[1]-r[0])}}return o}export{d as SOM,m as calculateCentroids,vs as clusterEmbed,Ds as embeddedKmeans,rt as kmeans,ms as pca,gs as sammon,ws as selfOrganizingMap,ds as umap};
