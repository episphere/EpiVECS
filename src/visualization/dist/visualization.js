function t(t,n){let r,e;if(void 0===n)for(const n of t)null!=n&&(void 0===r?n>=n&&(r=e=n):(r>n&&(r=n),e<n&&(e=n)));else{let o=-1;for(let l of t)null!=(l=n(l,++o,t))&&(void 0===r?l>=l&&(r=e=l):(r>l&&(r=l),e<l&&(e=l)))}return[r,e]}function n(t,n,l){if(1==l)return[255,255,255];if(0==l)return[0,0,0];let u,i,f,a,c,h=Math.cos(2*Math.PI*t),s=Math.sin(2*Math.PI*t),M=function(t){const n=.206,r=.03,e=(1+n)/(1+r);return(t*t+n*t)/(e*(t+r))}(l),d=function(t,n,r){let o,l,u=e(n,r),i=function(t,n,r,o,l,u=null){u||(u=e(t,n));let i;if((r-l)*u[1]-(u[0]-l)*o<=0)i=u[1]*l/(o*u[0]+u[1]*(l-r));else{i=u[1]*(l-1)/(o*(u[0]-1)+u[1]*(l-r));{let e=r-l,u=.3963377774*t+.2158037573*n,f=-.1055613458*t-.0638541728*n,a=-.0894841775*t-1.291485548*n,c=e+o*u,h=e+o*f,s=e+o*a;{let t=l*(1-i)+i*r,n=i*o,e=t+n*u,M=t+n*f,d=t+n*a,m=e*e*e,v=M*M*M,p=d*d*d,q=3*c*e*e,I=3*h*M*M,x=3*s*d*d,P=6*c*c*e,b=6*h*h*M,g=6*s*s*d,k=4.0767416621*m-3.3077115913*v+.2309699292*p-1,w=4.0767416621*q-3.3077115913*I+.2309699292*x,y=w/(w*w-.5*k*(4.0767416621*P-3.3077115913*b+.2309699292*g)),A=-k*y,j=-1.2684380046*m+2.6097574011*v-.3413193965*p-1,E=-1.2684380046*q+2.6097574011*I-.3413193965*x,$=E/(E*E-.5*j*(-1.2684380046*P+2.6097574011*b-.3413193965*g)),z=-j*$,B=-.0041960863*m-.7034186147*v+1.707614701*p-1,C=-.0041960863*q-.7034186147*I+1.707614701*x,D=C/(C*C-.5*B*(-.0041960863*P-.7034186147*b+1.707614701*g)),F=-B*D;A=y>=0?A:1e6,z=$>=0?z:1e6,F=D>=0?F:1e6,i+=Math.min(A,Math.min(z,F))}}}return i}(n,r,t,1,t,u),f=function(t,n,r=null){r||(r=e(t,n));let o=r[0],l=r[1];return[l/o,l/(1-o)]}(n,r,u),a=.11516993+1/(7.4477897+4.1590124*r+n*(1.75198401*r-2.19557347+n*(-2.13704948-10.02301043*r+n*(5.38770819*r-4.24894561+4.69891013*n)))),c=.11239642+1/(1.6132032-.68124379*r+n*(.40370612+.90148123*r+n*(.6122399*r-.27087943+n*(.00299215-.45399568*r-.14661872*n)))),h=i/Math.min(t*f[0],(1-t)*f[1]);{let n=t*a,r=(1-t)*c;o=.9*h*Math.sqrt(Math.sqrt(1/(1/(n*n*n*n)+1/(r*r*r*r))))}{let n=.4*t,r=.8*(1-t);l=Math.sqrt(1/(1/(n*n)+1/(r*r)))}return[l,o,i]}(M,h,s),m=d[0],v=d[1],p=d[2];n<.8?(i=1.25*n,f=0,a=.8*m,c=1-a/v):(i=5*(n-.8),f=v,a=.2*v*v*1.25*1.25/m,c=1-a/(p-v)),u=f+i*a/(1-c*i);let q=r(M,u*h,u*s);return[255*o(q[0]),255*o(q[1]),255*o(q[2])]}function r(t,n,r){let e=t+.3963377774*n+.2158037573*r,o=t-.1055613458*n-.0638541728*r,l=t-.0894841775*n-1.291485548*r,u=e*e*e,i=o*o*o,f=l*l*l;return[4.0767416621*u-3.3077115913*i+.2309699292*f,-1.2684380046*u+2.6097574011*i-.3413193965*f,-.0041960863*u-.7034186147*i+1.707614701*f]}function e(t,n){let e=function(t,n){let r,e,o,l,u,i,f,a;-1.88170328*t-.80936493*n>1?(r=1.19086277,e=1.76576728,o=.59662641,l=.75515197,u=.56771245,i=4.0767416621,f=-3.3077115913,a=.2309699292):1.81444104*t-1.19445276*n>1?(r=.73956515,e=-.45954404,o=.08285427,l=.1254107,u=.14503204,i=-1.2684380046,f=2.6097574011,a=-.3413193965):(r=1.35733652,e=-.00915799,o=-1.1513021,l=-.50559606,u=.00692167,i=-.0041960863,f=-.7034186147,a=1.707614701);let c=r+e*t+o*n+l*t*t+u*t*n,h=.3963377774*t+.2158037573*n,s=-.1055613458*t-.0638541728*n,M=-.0894841775*t-1.291485548*n;{let t=1+c*h,n=1+c*s,r=1+c*M,e=i*(t*t*t)+f*(n*n*n)+a*(r*r*r),o=i*(3*h*t*t)+f*(3*s*n*n)+a*(3*M*r*r);c-=e*o/(o*o-.5*e*(i*(6*h*h*t)+f*(6*s*s*n)+a*(6*M*M*r)))}return c}(t,n),o=r(1,e*t,e*n),l=Math.cbrt(1/Math.max(Math.max(o[0],o[1]),o[2]));return[l,l*e]}function o(t){return.0031308>=t?12.92*t:1.055*Math.pow(t,.4166666666666667)-.055}function l(r,e=.5,o="okhsl"){const l=t(r,(t=>t[0])),f=t(r,(t=>t[1])),a=[(l[0]+l[1])/2,(f[0]+f[1])/2],c=function(t,n){let r;if(void 0===n)for(const n of t)null!=n&&(r<n||void 0===r&&n>=n)&&(r=n);else{let e=-1;for(let o of t)null!=(o=n(o,++e,t))&&(r<o||void 0===r&&o>=o)&&(r=o)}return r}(r.map((t=>i(t,a)))),h=u([0,c]),s=u([0,2*Math.PI]),M=u([0,c],Array.isArray(e)?e:[e,e]);if("okhsl"==o){let t=n;return function(n){const r=Math.atan2(n[0]-a[0],n[1]-a[1]),e=i(n,a);return`rgb(${t(s(r),h(e),M(h(e))).map(Math.round).join(",")})`}}throw Error("Invalid color space ",o)}function u(t,n=[0,1]){const r=t[1]-t[0],e=n[1]-n[0];return function(o){return e*((o-t[0])/r)+n[0]}}function i(t,n){let r=0;for(let e=0;e<t.length;e++)r+=(t[e]-n[e])**2;return Math.sqrt(r)}export{l as positionColorer};
